/**Linuxethernetbridge**Authors:*LennertBuytenhek<buytenh@gnu.org>**Thisprogrami
sfreesoftware;youcanredistributeitand/or*modifyitunderthetermsoftheGNUGeneralPub
licLicense*aspublishedbytheFreeSoftwareFoundation;eitherversion*2oftheLicense,or
(atyouroption)anylaterversion.*/#ifndef_LINUX_IF_BRIDGE_H#define_LINUX_IF_BRIDGE
_H#include<linux/types.h>#include<linux/if_ether.h>#include<linux/in6.h>#defineS
YSFS_BRIDGE_ATTR"bridge"#defineSYSFS_BRIDGE_FDB"brforward"#defineSYSFS_BRIDGE_PO
RT_SUBDIR"brif"#defineSYSFS_BRIDGE_PORT_ATTR"brport"#defineSYSFS_BRIDGE_PORT_LIN
K"bridge"#defineBRCTL_VERSION1#defineBRCTL_GET_VERSION0#defineBRCTL_GET_BRIDGES1
#defineBRCTL_ADD_BRIDGE2#defineBRCTL_DEL_BRIDGE3#defineBRCTL_ADD_IF4#defineBRCTL
_DEL_IF5#defineBRCTL_GET_BRIDGE_INFO6#defineBRCTL_GET_PORT_LIST7#defineBRCTL_SET
_BRIDGE_FORWARD_DELAY8#defineBRCTL_SET_BRIDGE_HELLO_TIME9#defineBRCTL_SET_BRIDGE
_MAX_AGE10#defineBRCTL_SET_AGEING_TIME11#defineBRCTL_SET_GC_INTERVAL12#defineBRC
TL_GET_PORT_INFO13#defineBRCTL_SET_BRIDGE_STP_STATE14#defineBRCTL_SET_BRIDGE_PRI
ORITY15#defineBRCTL_SET_PORT_PRIORITY16#defineBRCTL_SET_PATH_COST17#defineBRCTL_
GET_FDB_ENTRIES18#defineBR_STATE_DISABLED0#defineBR_STATE_LISTENING1#defineBR_ST
ATE_LEARNING2#defineBR_STATE_FORWARDING3#defineBR_STATE_BLOCKING4struct__bridge_
info{__u64designated_root;__u64bridge_id;__u32root_path_cost;__u32max_age;__u32h
ello_time;__u32forward_delay;__u32bridge_max_age;__u32bridge_hello_time;__u32bri
dge_forward_delay;__u8topology_change;__u8topology_change_detected;__u8root_port
;__u8stp_enabled;__u32ageing_time;__u32gc_interval;__u32hello_timer_value;__u32t
cn_timer_value;__u32topology_change_timer_value;__u32gc_timer_value;};struct__po
rt_info{__u64designated_root;__u64designated_bridge;__u16port_id;__u16designated
_port;__u32path_cost;__u32designated_cost;__u8state;__u8top_change_ack;__u8confi
g_pending;__u8unused0;__u32message_age_timer_value;__u32forward_delay_timer_valu
e;__u32hold_timer_value;};struct__fdb_entry{__u8mac_addr[ETH_ALEN];__u8port_no;_
_u8is_local;__u32ageing_timer_value;__u8port_hi;__u8pad0;__u16unused;};/*BridgeF
lags*/#defineBRIDGE_FLAGS_MASTER1/*Bridgecommandto/frommaster*/#defineBRIDGE_FLA
GS_SELF2/*Bridgecommandto/fromlowerdev*/#defineBRIDGE_MODE_VEB0/*Defaultloopback
mode*/#defineBRIDGE_MODE_VEPA1/*802.1QbgdefinedVEPAmode*/#defineBRIDGE_MODE_UNDE
F0xFFFF/*modeundefined*//*Bridgemanagementnestedattributes*[IFLA_AF_SPEC]={*[IFL
A_BRIDGE_FLAGS]*[IFLA_BRIDGE_MODE]*[IFLA_BRIDGE_VLAN_INFO]*}*/enum{IFLA_BRIDGE_F
LAGS,IFLA_BRIDGE_MODE,IFLA_BRIDGE_VLAN_INFO,IFLA_BRIDGE_VLAN_TUNNEL_INFO,__IFLA_
BRIDGE_MAX,};#defineIFLA_BRIDGE_MAX(__IFLA_BRIDGE_MAX-1)#defineBRIDGE_VLAN_INFO_
MASTER(1<<0)/*OperateonBridgedeviceaswell*/#defineBRIDGE_VLAN_INFO_PVID(1<<1)/*V
LANisPVID,ingressuntagged*/#defineBRIDGE_VLAN_INFO_UNTAGGED(1<<2)/*VLANegressesu
ntagged*/#defineBRIDGE_VLAN_INFO_RANGE_BEGIN(1<<3)/*VLANisstartofvlanrange*/#def
ineBRIDGE_VLAN_INFO_RANGE_END(1<<4)/*VLANisendofvlanrange*/#defineBRIDGE_VLAN_IN
FO_BRENTRY(1<<5)/*GlobalbridgeVLANentry*/structbridge_vlan_info{__u16flags;__u16
vid;};enum{IFLA_BRIDGE_VLAN_TUNNEL_UNSPEC,IFLA_BRIDGE_VLAN_TUNNEL_ID,IFLA_BRIDGE
_VLAN_TUNNEL_VID,IFLA_BRIDGE_VLAN_TUNNEL_FLAGS,__IFLA_BRIDGE_VLAN_TUNNEL_MAX,};#
defineIFLA_BRIDGE_VLAN_TUNNEL_MAX(__IFLA_BRIDGE_VLAN_TUNNEL_MAX-1)structbridge_v
lan_xstats{__u64rx_bytes;__u64rx_packets;__u64tx_bytes;__u64tx_packets;__u16vid;
__u16flags;__u32pad2;};/*Bridgemulticastdatabaseattributes*[MDBA_MDB]={*[MDBA_MD
B_ENTRY]={*[MDBA_MDB_ENTRY_INFO]{*structbr_mdb_entry*[MDBA_MDB_EATTRattributes]*
}*}*}*[MDBA_ROUTER]={*[MDBA_ROUTER_PORT]={*u32ifindex*[MDBA_ROUTER_PATTRattribut
es]*}*}*/enum{MDBA_UNSPEC,MDBA_MDB,MDBA_ROUTER,__MDBA_MAX,};#defineMDBA_MAX(__MD
BA_MAX-1)enum{MDBA_MDB_UNSPEC,MDBA_MDB_ENTRY,__MDBA_MDB_MAX,};#defineMDBA_MDB_MA
X(__MDBA_MDB_MAX-1)enum{MDBA_MDB_ENTRY_UNSPEC,MDBA_MDB_ENTRY_INFO,__MDBA_MDB_ENT
RY_MAX,};#defineMDBA_MDB_ENTRY_MAX(__MDBA_MDB_ENTRY_MAX-1)/*permdbentryadditiona
lattributes*/enum{MDBA_MDB_EATTR_UNSPEC,MDBA_MDB_EATTR_TIMER,__MDBA_MDB_EATTR_MA
X};#defineMDBA_MDB_EATTR_MAX(__MDBA_MDB_EATTR_MAX-1)/*multicastroutertypes*/enum
{MDB_RTR_TYPE_DISABLED,MDB_RTR_TYPE_TEMP_QUERY,MDB_RTR_TYPE_PERM,MDB_RTR_TYPE_TE
MP};enum{MDBA_ROUTER_UNSPEC,MDBA_ROUTER_PORT,__MDBA_ROUTER_MAX,};#defineMDBA_ROU
TER_MAX(__MDBA_ROUTER_MAX-1)/*routerportattributes*/enum{MDBA_ROUTER_PATTR_UNSPE
C,MDBA_ROUTER_PATTR_TIMER,MDBA_ROUTER_PATTR_TYPE,__MDBA_ROUTER_PATTR_MAX};#defin
eMDBA_ROUTER_PATTR_MAX(__MDBA_ROUTER_PATTR_MAX-1)structbr_port_msg{__u8family;__
u32ifindex;};structbr_mdb_entry{__u32ifindex;#defineMDB_TEMPORARY0#defineMDB_PER
MANENT1__u8state;#defineMDB_FLAGS_OFFLOAD(1<<0)__u8flags;__u16vid;struct{union{_
_be32ip4;structin6_addrip6;}u;__be16proto;}addr;};enum{MDBA_SET_ENTRY_UNSPEC,MDB
A_SET_ENTRY,__MDBA_SET_ENTRY_MAX,};#defineMDBA_SET_ENTRY_MAX(__MDBA_SET_ENTRY_MA
X-1)/*EmbeddedinsideLINK_XSTATS_TYPE_BRIDGE*/enum{BRIDGE_XSTATS_UNSPEC,BRIDGE_XS
TATS_VLAN,BRIDGE_XSTATS_MCAST,BRIDGE_XSTATS_PAD,__BRIDGE_XSTATS_MAX};#defineBRID
GE_XSTATS_MAX(__BRIDGE_XSTATS_MAX-1)enum{BR_MCAST_DIR_RX,BR_MCAST_DIR_TX,BR_MCAS
T_DIR_SIZE};/*IGMP/MLDstatistics*/structbr_mcast_stats{__u64igmp_v1queries[BR_MC
AST_DIR_SIZE];__u64igmp_v2queries[BR_MCAST_DIR_SIZE];__u64igmp_v3queries[BR_MCAS
T_DIR_SIZE];__u64igmp_leaves[BR_MCAST_DIR_SIZE];__u64igmp_v1reports[BR_MCAST_DIR
_SIZE];__u64igmp_v2reports[BR_MCAST_DIR_SIZE];__u64igmp_v3reports[BR_MCAST_DIR_S
IZE];__u64igmp_parse_errors;__u64mld_v1queries[BR_MCAST_DIR_SIZE];__u64mld_v2que
ries[BR_MCAST_DIR_SIZE];__u64mld_leaves[BR_MCAST_DIR_SIZE];__u64mld_v1reports[BR
_MCAST_DIR_SIZE];__u64mld_v2reports[BR_MCAST_DIR_SIZE];__u64mld_parse_errors;__u
64mcast_bytes[BR_MCAST_DIR_SIZE];__u64mcast_packets[BR_MCAST_DIR_SIZE];};#endif/
*_LINUX_IF_BRIDGE_H*/