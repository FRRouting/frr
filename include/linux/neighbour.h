#ifndef__LINUX_NEIGHBOUR_H#define__LINUX_NEIGHBOUR_H#include<linux/types.h>#incl
ude<linux/netlink.h>structndmsg{__u8ndm_family;__u8ndm_pad1;__u16ndm_pad2;__s32n
dm_ifindex;__u16ndm_state;__u8ndm_flags;__u8ndm_type;};enum{NDA_UNSPEC,NDA_DST,N
DA_LLADDR,NDA_CACHEINFO,NDA_PROBES,NDA_VLAN,NDA_PORT,NDA_VNI,NDA_IFINDEX,NDA_MAS
TER,NDA_LINK_NETNSID,NDA_SRC_VNI,__NDA_MAX};#defineNDA_MAX(__NDA_MAX-1)/**Neighb
orCacheEntryFlags*/#defineNTF_USE0x01#defineNTF_SELF0x02#defineNTF_MASTER0x04#de
fineNTF_PROXY0x08/*==ATF_PUBL*/#defineNTF_EXT_LEARNED0x10#defineNTF_OFFLOADED0x2
0#defineNTF_ROUTER0x80/**NeighborCacheEntryStates.*/#defineNUD_INCOMPLETE0x01#de
fineNUD_REACHABLE0x02#defineNUD_STALE0x04#defineNUD_DELAY0x08#defineNUD_PROBE0x1
0#defineNUD_FAILED0x20/*Dummystates*/#defineNUD_NOARP0x40#defineNUD_PERMANENT0x8
0#defineNUD_NONE0x00/*NUD_NOARP&NUD_PERMANENTarepseudostates,theyneverchangeandm
akenoaddressresolutionorNUD.NUD_PERMANENTalsocannotbedeletedbygarbagecollectors.
*/structnda_cacheinfo{__u32ndm_confirmed;__u32ndm_used;__u32ndm_updated;__u32ndm
_refcnt;};/******************************************************************Nei
ghbourtablesspecificmessages.**ToretrievetheneighbourtablessendRTM_GETNEIGHTBLwi
ththe*NLM_F_DUMPflagset.Everyneighbourtableconfigurationis*spreadovermultiplemes
sagestoavoidrunningintomessage*sizelimitsonsystemswithmanyinterfaces.Thefirstmes
sage*inthesequencetransportsallnotdevicespecificdatasuchas*statistics,configurat
ion,andthedefaultparameterset.*Thismessageisfollowedby0..nmessagescarryingdevice
*specificparametersets.*Althoughtheorderingshouldbesufficient,NDTA_NAMEcanbe*use
dtoidentifysequences.Theinitialmessagecanbeidentified*bycheckingforNDTA_CONFIG.T
hedevicespecificmessagesdo*notcontainthisTLVbuthaveNDTPA_IFINDEXsettothe*corresp
ondinginterfaceindex.**Tochangeneighbourtableattributes,sendRTM_SETNEIGHTBL*with
NDTA_NAMEset.ChangeableattributeincludeNDTA_THRESH[1-3],*NDTA_GC_INTERVAL,andall
TLVsinNDTA_PARMSunlessmarked*otherwise.Devicespecificparametersetscanbechangedby
*settingNDTPA_IFINDEXtotheinterfaceindexofthecorresponding*device.****/structndt
_stats{__u64ndts_allocs;__u64ndts_destroys;__u64ndts_hash_grows;__u64ndts_res_fa
iled;__u64ndts_lookups;__u64ndts_hits;__u64ndts_rcv_probes_mcast;__u64ndts_rcv_p
robes_ucast;__u64ndts_periodic_gc_runs;__u64ndts_forced_gc_runs;__u64ndts_table_
fulls;};enum{NDTPA_UNSPEC,NDTPA_IFINDEX,/*u32,unchangeable*/NDTPA_REFCNT,/*u32,r
ead-only*/NDTPA_REACHABLE_TIME,/*u64,read-only,msecs*/NDTPA_BASE_REACHABLE_TIME,
/*u64,msecs*/NDTPA_RETRANS_TIME,/*u64,msecs*/NDTPA_GC_STALETIME,/*u64,msecs*/NDT
PA_DELAY_PROBE_TIME,/*u64,msecs*/NDTPA_QUEUE_LEN,/*u32*/NDTPA_APP_PROBES,/*u32*/
NDTPA_UCAST_PROBES,/*u32*/NDTPA_MCAST_PROBES,/*u32*/NDTPA_ANYCAST_DELAY,/*u64,ms
ecs*/NDTPA_PROXY_DELAY,/*u64,msecs*/NDTPA_PROXY_QLEN,/*u32*/NDTPA_LOCKTIME,/*u64
,msecs*/NDTPA_QUEUE_LENBYTES,/*u32*/NDTPA_MCAST_REPROBES,/*u32*/NDTPA_PAD,__NDTP
A_MAX};#defineNDTPA_MAX(__NDTPA_MAX-1)structndtmsg{__u8ndtm_family;__u8ndtm_pad1
;__u16ndtm_pad2;};structndt_config{__u16ndtc_key_len;__u16ndtc_entry_size;__u32n
dtc_entries;__u32ndtc_last_flush;/*deltatonowinmsecs*/__u32ndtc_last_rand;/*delt
atonowinmsecs*/__u32ndtc_hash_rnd;__u32ndtc_hash_mask;__u32ndtc_hash_chain_gc;__
u32ndtc_proxy_qlen;};enum{NDTA_UNSPEC,NDTA_NAME,/*char*,unchangeable*/NDTA_THRES
H1,/*u32*/NDTA_THRESH2,/*u32*/NDTA_THRESH3,/*u32*/NDTA_CONFIG,/*structndt_config
,read-only*/NDTA_PARMS,/*nestedTLVNDTPA_**/NDTA_STATS,/*structndt_stats,read-onl
y*/NDTA_GC_INTERVAL,/*u64,msecs*/NDTA_PAD,__NDTA_MAX};#defineNDTA_MAX(__NDTA_MAX
-1)#endif