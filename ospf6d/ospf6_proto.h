/**Commonprotocoldataanddatastructures.*Copyright(C)2003YasuhiroOhara**Thisfilei
spartofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*unde
rthetermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eit
herversion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopetha
titwillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTA
BILITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetail
s.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;
seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,Fift
hFloor,Boston,MA02110-1301USA*/#ifndefOSPF6_PROTO_H#defineOSPF6_PROTO_H/*OSPFpro
tocolversion*/#defineOSPFV3_VERSION3/*TOSfieldnormalynull*/#defineDEFAULT_TOS_VA
LUE0x0#defineALLSPFROUTERS6"ff02::5"#defineALLDROUTERS6"ff02::6"#defineOSPF6_ROU
TER_BIT_W(1<<3)#defineOSPF6_ROUTER_BIT_V(1<<2)#defineOSPF6_ROUTER_BIT_E(1<<1)#de
fineOSPF6_ROUTER_BIT_B(1<<0)/*OSPFoptions*//*presentinHELLO,DD,LSA*/#defineOSPF6
_OPT_SET(x,opt)((x)[2]|=(opt))#defineOSPF6_OPT_ISSET(x,opt)((x)[2]&(opt))#define
OSPF6_OPT_CLEAR(x,opt)((x)[2]&=~(opt))#defineOSPF6_OPT_CLEAR_ALL(x)((x)[0]=(x)[1
]=(x)[2]=0)#defineOSPF6_OPT_DC(1<<5)/*DemandCircuithandlingCapability*/#defineOS
PF6_OPT_R(1<<4)/*ForwardingCapability(AnyProtocol)*/#defineOSPF6_OPT_N(1<<3)/*Ha
ndlingType-7LSACapability*/#defineOSPF6_OPT_MC(1<<2)/*MulticastingCapability*/#d
efineOSPF6_OPT_E(1<<1)/*ASExternalCapability*/#defineOSPF6_OPT_V6(1<<0)/*IPv6for
wardingCapability*//*OSPF6Prefix*/#defineOSPF6_PREFIX_MIN_SIZE4U/*.length==0*/st
ructospf6_prefix{uint8_tprefix_length;uint8_tprefix_options;union{uint16_t_prefi
x_metric;uint16_t_prefix_referenced_lstype;}u;#defineprefix_metricu._prefix_metr
ic#defineprefix_refer_lstypeu._prefix_referenced_lstype/*followedbyoneaddress_pr
efix*/structin6_addraddr[];};#defineOSPF6_PREFIX_OPTION_NU(1<<0)/*NoUnicast*/#de
fineOSPF6_PREFIX_OPTION_LA(1<<1)/*LocalAddress*/#defineOSPF6_PREFIX_OPTION_MC(1<
<2)/*MultiCast*/#defineOSPF6_PREFIX_OPTION_P(1<<3)/*Propagate(NSSA)*//*caddr_tOS
PF6_PREFIX_BODY(structospf6_prefix*);*/#defineOSPF6_PREFIX_BODY(x)((caddr_t)(x)+
sizeof(structospf6_prefix))/*size_tOSPF6_PREFIX_SPACE(intprefixlength);*/#define
OSPF6_PREFIX_SPACE(x)((((x)+31)/32)*4)/*size_tOSPF6_PREFIX_SIZE(structospf6_pref
ix*);*/#defineOSPF6_PREFIX_SIZE(x)\(OSPF6_PREFIX_SPACE((x)->prefix_length)+sizeo
f(structospf6_prefix))/*structospf6_prefix*OSPF6_PREFIX_NEXT(structospf6_prefix*
);*/#defineOSPF6_PREFIX_NEXT(x)\((structospf6_prefix*)((caddr_t)(x)+OSPF6_PREFIX
_SIZE(x)))#defineospf6_prefix_in6_addr(in6,op)\do{\memset(in6,0,sizeof(structin6
_addr));\memcpy(in6,(caddr_t)(op)+sizeof(structospf6_prefix),\OSPF6_PREFIX_SPACE
((op)->prefix_length));\}while(0)externvoidospf6_prefix_apply_mask(structospf6_p
refix*op);externvoidospf6_prefix_options_printbuf(uint8_tprefix_options,char*buf
,intsize);externvoidospf6_capability_printbuf(charcapability,char*buf,intsize);e
xternvoidospf6_options_printbuf(uint8_t*options,char*buf,intsize);#endif/*OSPF6_
PROTO_H*/