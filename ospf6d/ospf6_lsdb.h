/**Copyright(C)2003YasuhiroOhara**ThisfileispartofGNUZebra.**GNUZebraisfreesoftw
are;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublicLicense
aspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyouroption)any*later
version.**GNUZebraisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRANT
Y;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.
SeetheGNU*GeneralPublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGN
UGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFre
eSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifnde
fOSPF6_LSDB_H#defineOSPF6_LSDB_H#include"prefix.h"#include"table.h"#include"ospf
6_route.h"structospf6_lsdb{void*data;/*datastructurethatholdsthislsdb*/structrou
te_table*table;uint32_tcount;void(*hook_add)(structospf6_lsa*);void(*hook_remove
)(structospf6_lsa*);};/*FunctionPrototypes*/externstructospf6_lsdb*ospf6_lsdb_cr
eate(void*data);externvoidospf6_lsdb_delete(structospf6_lsdb*lsdb);externstructo
spf6_lsa*ospf6_lsdb_lookup(uint16_ttype,uint32_tid,uint32_tadv_router,structospf
6_lsdb*lsdb);externstructospf6_lsa*ospf6_lsdb_lookup_next(uint16_ttype,uint32_ti
d,uint32_tadv_router,structospf6_lsdb*lsdb);externvoidospf6_lsdb_add(structospf6
_lsa*lsa,structospf6_lsdb*lsdb);externvoidospf6_lsdb_remove(structospf6_lsa*lsa,
structospf6_lsdb*lsdb);externconststructroute_node*ospf6_lsdb_head(structospf6_l
sdb*lsdb,intargmode,uint16_ttype,uint32_tadv_router,structospf6_lsa**lsa);extern
structospf6_lsa*ospf6_lsdb_next(conststructroute_node*iterend,structospf6_lsa*ls
a);#defineALL_LSDB_TYPED_ADVRTR(lsdb,type,adv_router,lsa)\conststructroute_node*
iterend=\ospf6_lsdb_head(lsdb,2,type,adv_router,&lsa);\lsa;\lsa=ospf6_lsdb_next(
iterend,lsa)#defineALL_LSDB_TYPED(lsdb,type,lsa)\conststructroute_node*iterend=\
ospf6_lsdb_head(lsdb,1,type,0,&lsa);\lsa;\lsa=ospf6_lsdb_next(iterend,lsa)#defin
eALL_LSDB(lsdb,lsa)\conststructroute_node*iterend=\ospf6_lsdb_head(lsdb,0,0,0,&l
sa);\lsa;\lsa=ospf6_lsdb_next(iterend,lsa)externvoidospf6_lsdb_remove_all(struct
ospf6_lsdb*lsdb);externvoidospf6_lsdb_lsa_unlock(structospf6_lsa*lsa);enumospf_l
sdb_show_level{OSPF6_LSDB_SHOW_LEVEL_NORMAL=0,OSPF6_LSDB_SHOW_LEVEL_DETAIL,OSPF6
_LSDB_SHOW_LEVEL_INTERNAL,OSPF6_LSDB_SHOW_LEVEL_DUMP,};externvoidospf6_lsdb_show
(structvty*vty,enumospf_lsdb_show_levellevel,uint16_t*type,uint32_t*id,uint32_t*
adv_router,structospf6_lsdb*lsdb);externuint32_tospf6_new_ls_id(uint16_ttype,uin
t32_tadv_router,structospf6_lsdb*lsdb);externuint32_tospf6_new_ls_seqnum(uint16_
ttype,uint32_tid,uint32_tadv_router,structospf6_lsdb*lsdb);externintospf6_lsdb_m
axage_remover(structospf6_lsdb*lsdb);#endif/*OSPF6_LSDB_H*/