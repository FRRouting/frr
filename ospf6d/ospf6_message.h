/**Copyright(C)1999-2003YasuhiroOhara**ThisfileispartofGNUZebra.**GNUZebraisfree
software;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublicLi
censeaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyouroption)any*
laterversion.**GNUZebraisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWA
RRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPUR
POSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceivedacopyof
theGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetot
heFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#
ifndefOSPF6_MESSAGE_H#defineOSPF6_MESSAGE_H#defineOSPF6_MESSAGE_BUFSIZ4096/*Debu
goption*/externunsignedcharconf_debug_ospf6_message[];#defineOSPF6_DEBUG_MESSAGE
_SEND0x01#defineOSPF6_DEBUG_MESSAGE_RECV0x02#defineOSPF6_DEBUG_MESSAGE_ON(type,l
evel)\(conf_debug_ospf6_message[type]|=(level))#defineOSPF6_DEBUG_MESSAGE_OFF(ty
pe,level)\(conf_debug_ospf6_message[type]&=~(level))#defineIS_OSPF6_DEBUG_MESSAG
E(t,e)\(conf_debug_ospf6_message[t]&OSPF6_DEBUG_MESSAGE_##e)/*Type*/#defineOSPF6
_MESSAGE_TYPE_UNKNOWN0x0#defineOSPF6_MESSAGE_TYPE_HELLO0x1/*Discover/maintainnei
ghbors*/#defineOSPF6_MESSAGE_TYPE_DBDESC0x2/*Summarizedatabasecontents*/#defineO
SPF6_MESSAGE_TYPE_LSREQ0x3/*Databasedownloadrequest*/#defineOSPF6_MESSAGE_TYPE_L
SUPDATE0x4/*Databaseupdate*/#defineOSPF6_MESSAGE_TYPE_LSACK0x5/*Floodingacknowle
dgment*/#defineOSPF6_MESSAGE_TYPE_ALL0x6/*Fordebugoption*//*OSPFv3packetheader*/
#defineOSPF6_HEADER_SIZE16Ustructospf6_header{uint8_tversion;uint8_ttype;uint16_
tlength;uint32_trouter_id;uint32_tarea_id;uint16_tchecksum;uint8_tinstance_id;ui
nt8_treserved;};#defineOSPF6_MESSAGE_END(H)((caddr_t)(H)+ntohs((H)->length))/*He
llo*/#defineOSPF6_HELLO_MIN_SIZE20Ustructospf6_hello{ifindex_tinterface_id;uint8
_tpriority;uint8_toptions[3];uint16_thello_interval;uint16_tdead_interval;uint32
_tdrouter;uint32_tbdrouter;/*FollowedbyRouter-IDs*/};/*DatabaseDescription*/#def
ineOSPF6_DB_DESC_MIN_SIZE12Ustructospf6_dbdesc{uint8_treserved1;uint8_toptions[3
];uint16_tifmtu;uint8_treserved2;uint8_tbits;uint32_tseqnum;/*FollowedbyLSAHeade
rs*/};#defineOSPF6_DBDESC_MSBIT(0x01)/*master/slavebit*/#defineOSPF6_DBDESC_MBIT
(0x02)/*morebit*/#defineOSPF6_DBDESC_IBIT(0x04)/*initialbit*//*LinkStateRequest*
/#defineOSPF6_LS_REQ_MIN_SIZE0U/*Itisjustasequenceofentriesbelow*/#defineOSPF6_L
SREQ_LSDESC_FIX_SIZE12Ustructospf6_lsreq_entry{uint16_treserved;/*MustBeZero*/ui
nt16_ttype;/*LStype*/uint32_tid;/*LinkStateID*/uint32_tadv_router;/*AdvertisingR
outer*/};/*LinkStateUpdate*/#defineOSPF6_LS_UPD_MIN_SIZE4Ustructospf6_lsupdate{u
int32_tlsa_number;/*FollowedbyLSAs*/};/*LinkStateAcknowledgement*/#defineOSPF6_L
S_ACK_MIN_SIZE0U/*ItisjustasequenceofLSAHeaders*//*Functiondefinition*/externvoi
dospf6_hello_print(structospf6_header*);externvoidospf6_dbdesc_print(structospf6
_header*);externvoidospf6_lsreq_print(structospf6_header*);externvoidospf6_lsupd
ate_print(structospf6_header*);externvoidospf6_lsack_print(structospf6_header*);
externintospf6_iobuf_size(unsignedintsize);externvoidospf6_message_terminate(voi
d);externintospf6_receive(structthread*thread);externintospf6_hello_send(structt
hread*thread);externintospf6_dbdesc_send(structthread*thread);externintospf6_dbd
esc_send_newone(structthread*thread);externintospf6_lsreq_send(structthread*thre
ad);externintospf6_lsupdate_send_interface(structthread*thread);externintospf6_l
supdate_send_neighbor(structthread*thread);externintospf6_lsack_send_interface(s
tructthread*thread);externintospf6_lsack_send_neighbor(structthread*thread);exte
rnintconfig_write_ospf6_debug_message(structvty*);externvoidinstall_element_ospf
6_debug_message(void);#endif/*OSPF6_MESSAGE_H*/