/**Copyright(C)2003YasuhiroOhara**ThisfileispartofGNUZebra.**GNUZebraisfreesoftw
are;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublicLicense
aspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyouroption)any*later
version.**GNUZebraisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRANT
Y;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.
SeetheGNU*GeneralPublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGN
UGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFre
eSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifnde
fOSPF6_INTRA_H#defineOSPF6_INTRA_H/*Debugoption*/externunsignedcharconf_debug_os
pf6_brouter;externuint32_tconf_debug_ospf6_brouter_specific_router_id;externuint
32_tconf_debug_ospf6_brouter_specific_area_id;#defineOSPF6_DEBUG_BROUTER_SUMMARY
0x01#defineOSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER0x02#defineOSPF6_DEBUG_BROUTER_SPE
CIFIC_AREA0x04#defineOSPF6_DEBUG_BROUTER_ON()\(conf_debug_ospf6_brouter|=OSPF6_D
EBUG_BROUTER_SUMMARY)#defineOSPF6_DEBUG_BROUTER_OFF()\(conf_debug_ospf6_brouter&
=~OSPF6_DEBUG_BROUTER_SUMMARY)#defineIS_OSPF6_DEBUG_BROUTER\(conf_debug_ospf6_br
outer&OSPF6_DEBUG_BROUTER_SUMMARY)#defineOSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER_ON(
router_id)\do{\conf_debug_ospf6_brouter_specific_router_id=(router_id);\conf_deb
ug_ospf6_brouter|=\OSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER;\}while(0)#defineOSPF6_DE
BUG_BROUTER_SPECIFIC_ROUTER_OFF()\do{\conf_debug_ospf6_brouter_specific_router_i
d=0;\conf_debug_ospf6_brouter&=\~OSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER;\}while(0)#
defineIS_OSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER\(conf_debug_ospf6_brouter&OSPF6_DEB
UG_BROUTER_SPECIFIC_ROUTER)#defineIS_OSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER_ID(rout
er_id)\(IS_OSPF6_DEBUG_BROUTER_SPECIFIC_ROUTER\&&conf_debug_ospf6_brouter_specif
ic_router_id==(router_id))#defineOSPF6_DEBUG_BROUTER_SPECIFIC_AREA_ON(area_id)\d
o{\conf_debug_ospf6_brouter_specific_area_id=(area_id);\conf_debug_ospf6_brouter
|=OSPF6_DEBUG_BROUTER_SPECIFIC_AREA;\}while(0)#defineOSPF6_DEBUG_BROUTER_SPECIFI
C_AREA_OFF()\do{\conf_debug_ospf6_brouter_specific_area_id=0;\conf_debug_ospf6_b
router&=\~OSPF6_DEBUG_BROUTER_SPECIFIC_AREA;\}while(0)#defineIS_OSPF6_DEBUG_BROU
TER_SPECIFIC_AREA\(conf_debug_ospf6_brouter&OSPF6_DEBUG_BROUTER_SPECIFIC_AREA)#d
efineIS_OSPF6_DEBUG_BROUTER_SPECIFIC_AREA_ID(area_id)\(IS_OSPF6_DEBUG_BROUTER_SP
ECIFIC_AREA\&&conf_debug_ospf6_brouter_specific_area_id==(area_id))/*Router-LSA*
/#defineOSPF6_ROUTER_LSA_MIN_SIZE4Ustructospf6_router_lsa{uint8_tbits;uint8_topt
ions[3];/*followedbyospf6_router_lsdesc(s)*/};/*LinkStateDescriptioninRouter-LSA
*/#defineOSPF6_ROUTER_LSDESC_FIX_SIZE16Ustructospf6_router_lsdesc{uint8_ttype;ui
nt8_treserved;uint16_tmetric;/*outputcost*/uint32_tinterface_id;uint32_tneighbor
_interface_id;uint32_tneighbor_router_id;};#defineOSPF6_ROUTER_LSDESC_POINTTOPOI
NT1#defineOSPF6_ROUTER_LSDESC_TRANSIT_NETWORK2#defineOSPF6_ROUTER_LSDESC_STUB_NE
TWORK3#defineOSPF6_ROUTER_LSDESC_VIRTUAL_LINK4enumstub_router_mode{OSPF6_NOT_STU
B_ROUTER,OSPF6_IS_STUB_ROUTER,OSPF6_IS_STUB_ROUTER_V6,};#defineROUTER_LSDESC_IS_
TYPE(t,x)\((((structospf6_router_lsdesc*)(x))->type\==OSPF6_ROUTER_LSDESC_##t)\?
1\:0)#defineROUTER_LSDESC_GET_METRIC(x)\(ntohs(((structospf6_router_lsdesc*)(x))
->metric))#defineROUTER_LSDESC_GET_IFID(x)\(ntohl(((structospf6_router_lsdesc*)(
x))->interface_id))#defineROUTER_LSDESC_GET_NBR_IFID(x)\(ntohl(((structospf6_rou
ter_lsdesc*)(x))->neighbor_interface_id))#defineROUTER_LSDESC_GET_NBR_ROUTERID(x
)\(((structospf6_router_lsdesc*)(x))->neighbor_router_id)/*Network-LSA*/#defineO
SPF6_NETWORK_LSA_MIN_SIZE4Ustructospf6_network_lsa{uint8_treserved;uint8_toption
s[3];/*followedbyospf6_netowrk_lsd(s)*/};/*LinkStateDescriptioninRouter-LSA*/#de
fineOSPF6_NETWORK_LSDESC_FIX_SIZE4Ustructospf6_network_lsdesc{uint32_trouter_id;
};#defineNETWORK_LSDESC_GET_NBR_ROUTERID(x)\(((structospf6_network_lsdesc*)(x))-
>router_id)/*Link-LSA*/#defineOSPF6_LINK_LSA_MIN_SIZE24U/*w/o1stIPv6prefix*/stru
ctospf6_link_lsa{uint8_tpriority;uint8_toptions[3];structin6_addrlinklocal_addr;
uint32_tprefix_num;/*followedbyospf6prefix(es)*/};/*Intra-Area-Prefix-LSA*/#defi
neOSPF6_INTRA_PREFIX_LSA_MIN_SIZE12U/*w/o1stIPv6prefix*/structospf6_intra_prefix
_lsa{uint16_tprefix_num;uint16_tref_type;uint32_tref_id;uint32_tref_adv_router;/
*followedbyospf6prefix(es)*/};#defineOSPF6_ROUTER_LSA_SCHEDULE(oa)\do{\if(CHECK_
FLAG((oa)->flag,OSPF6_AREA_ENABLE))\thread_add_event(master,ospf6_router_lsa_ori
ginate,\oa,0,&(oa)->thread_router_lsa);\}while(0)#defineOSPF6_NETWORK_LSA_SCHEDU
LE(oi)\do{\if(!CHECK_FLAG((oi)->flag,OSPF6_INTERFACE_DISABLE))\thread_add_event(
master,ospf6_network_lsa_originate,\oi,0,&(oi)->thread_network_lsa);\}while(0)#d
efineOSPF6_LINK_LSA_SCHEDULE(oi)\do{\if(!CHECK_FLAG((oi)->flag,OSPF6_INTERFACE_D
ISABLE))\thread_add_event(master,ospf6_link_lsa_originate,oi,\0,&(oi)->thread_li
nk_lsa);\}while(0)#defineOSPF6_INTRA_PREFIX_LSA_SCHEDULE_STUB(oa)\do{\if(CHECK_F
LAG((oa)->flag,OSPF6_AREA_ENABLE))\thread_add_event(\master,ospf6_intra_prefix_l
sa_originate_stub,\oa,0,&(oa)->thread_intra_prefix_lsa);\}while(0)#defineOSPF6_I
NTRA_PREFIX_LSA_SCHEDULE_TRANSIT(oi)\do{\if(!CHECK_FLAG((oi)->flag,OSPF6_INTERFA
CE_DISABLE))\thread_add_event(\master,\ospf6_intra_prefix_lsa_originate_transit,
oi,\0,&(oi)->thread_intra_prefix_lsa);\}while(0)#defineOSPF6_AS_EXTERN_LSA_SCHED
ULE(oi)\do{\if(!CHECK_FLAG((oi)->flag,OSPF6_INTERFACE_DISABLE))\thread_add_event
(master,ospf6_orig_as_external_lsa,\oi,0,&(oi)->thread_as_extern_lsa);\}while(0)
#defineOSPF6_NETWORK_LSA_EXECUTE(oi)\do{\THREAD_OFF((oi)->thread_network_lsa);\t
hread_execute(master,ospf6_network_lsa_originate,oi,0);\}while(0)#defineOSPF6_IN
TRA_PREFIX_LSA_EXECUTE_TRANSIT(oi)\do{\THREAD_OFF((oi)->thread_intra_prefix_lsa)
;\thread_execute(master,\ospf6_intra_prefix_lsa_originate_transit,oi,\0);\}while
(0)#defineOSPF6_AS_EXTERN_LSA_EXECUTE(oi)\do{\THREAD_OFF((oi)->thread_as_extern_
lsa);\thread_execute(master,ospf6_orig_as_external_lsa,oi,0);\}while(0)/*Functio
nPrototypes*/externchar*ospf6_router_lsdesc_lookup(uint8_ttype,uint32_tinterface
_id,uint32_tneighbor_interface_id,uint32_tneighbor_router_id,structospf6_lsa*lsa
);externchar*ospf6_network_lsdesc_lookup(uint32_trouter_id,structospf6_lsa*lsa);
externintospf6_router_is_stub_router(structospf6_lsa*lsa);externintospf6_router_
lsa_originate(structthread*);externintospf6_network_lsa_originate(structthread*)
;externintospf6_link_lsa_originate(structthread*);externintospf6_intra_prefix_ls
a_originate_transit(structthread*);externintospf6_intra_prefix_lsa_originate_stu
b(structthread*);externvoidospf6_intra_prefix_lsa_add(structospf6_lsa*lsa);exter
nvoidospf6_intra_prefix_lsa_remove(structospf6_lsa*lsa);externintospf6_orig_as_e
xternal_lsa(structthread*thread);externvoidospf6_intra_route_calculation(structo
spf6_area*oa);externvoidospf6_intra_brouter_calculation(structospf6_area*oa);ext
ernvoidospf6_intra_init(void);externintconfig_write_ospf6_debug_brouter(structvt
y*vty);externvoidinstall_element_ospf6_debug_brouter(void);#endif/*OSPF6_LSA_H*/
