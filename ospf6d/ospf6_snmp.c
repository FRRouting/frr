/*OSPFv3SNMPsupport*Copyright(C)2004YasuhiroOhara**ThisfileispartofGNUZebra.**GN
UZebraisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGen
eralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyou
roption)any*laterversion.**GNUZebraisdistributedinthehopethatitwillbeuseful,but*
WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAP
ARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhaverec
eivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;if
not,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA0211
0-1301USA*/#include<zebra.h>#include<net-snmp/net-snmp-config.h>#include<net-snm
p/net-snmp-includes.h>#include"log.h"#include"vty.h"#include"linklist.h"#include
"vector.h"#include"vrf.h"#include"smux.h"#include"libfrr.h"#include"version.h"#i
nclude"ospf6_proto.h"#include"ospf6_lsa.h"#include"ospf6_lsdb.h"#include"ospf6_r
oute.h"#include"ospf6_top.h"#include"ospf6_area.h"#include"ospf6_interface.h"#in
clude"ospf6_message.h"#include"ospf6_neighbor.h"#include"ospf6_abr.h"#include"os
pf6_asbr.h"#include"ospf6d.h"/*OSPFv3-MIB*/#defineOSPFv3MIB1,3,6,1,2,1,191/*OSPF
v3MIBGeneralGroupvalues.*/#defineOSPFv3ROUTERID1#defineOSPFv3ADMINSTAT2#defineOS
PFv3VERSIONNUMBER3#defineOSPFv3AREABDRRTRSTATUS4#defineOSPFv3ASBDRRTRSTATUS5#def
ineOSPFv3ASSCOPELSACOUNT6#defineOSPFv3ASSCOPELSACHECKSUMSUM7#defineOSPFv3ORIGINA
TENEWLSAS8#defineOSPFv3RXNEWLSAS9#defineOSPFv3EXTLSACOUNT10#defineOSPFv3EXTAREAL
SDBLIMIT11#defineOSPFv3EXITOVERFLOWINTERVAL12#defineOSPFv3DEMANDEXTENSIONS13#def
ineOSPFv3REFERENCEBANDWIDTH14#defineOSPFv3RESTARTSUPPORT15#defineOSPFv3RESTARTIN
TERVAL16#defineOSPFv3RESTARTSTRICTLSACHECKING17#defineOSPFv3RESTARTSTATUS18#defi
neOSPFv3RESTARTAGE19#defineOSPFv3RESTARTEXITREASON20#defineOSPFv3NOTIFICATIONENA
BLE21#defineOSPFv3STUBROUTERSUPPORT22#defineOSPFv3STUBROUTERADVERTISEMENT23#defi
neOSPFv3DISCONTINUITYTIME24#defineOSPFv3RESTARTTIME25/*OSPFv3MIBAreaTablevalues:
ospfv3AreaTable*/#defineOSPFv3IMPORTASEXTERN2#defineOSPFv3AREASPFRUNS3#defineOSP
Fv3AREABDRRTRCOUNT4#defineOSPFv3AREAASBDRRTRCOUNT5#defineOSPFv3AREASCOPELSACOUNT
6#defineOSPFv3AREASCOPELSACKSUMSUM7#defineOSPFv3AREASUMMARY8#defineOSPFv3AREAROW
STATUS9#defineOSPFv3AREASTUBMETRIC10#defineOSPFv3AREANSSATRANSLATORROLE11#define
OSPFv3AREANSSATRANSLATORSTATE12#defineOSPFv3AREANSSATRANSLATORSTABINTERVAL13#def
ineOSPFv3AREANSSATRANSLATOREVENTS14#defineOSPFv3AREASTUBMETRICTYPE15#defineOSPFv
3AREATEENABLED16/*OSPFv3MIB*LsdbTablevalues:ospfv3*LsdbTable*/#defineOSPFv3WWLSD
BSEQUENCE1#defineOSPFv3WWLSDBAGE2#defineOSPFv3WWLSDBCHECKSUM3#defineOSPFv3WWLSDB
ADVERTISEMENT4#defineOSPFv3WWLSDBTYPEKNOWN5/*Threefirstbitsaretoidentifycolumn*/
#defineOSPFv3WWCOLUMN0x7/*Thenweuseotherbitstoidentifytable*/#defineOSPFv3WWASTA
BLE(1<<3)#defineOSPFv3WWAREATABLE(1<<4)#defineOSPFv3WWLINKTABLE(1<<5)#defineOSPF
v3WWVIRTLINKTABLE(1<<6)/*OSPFv3MIBHostTablevalues:ospfv3HostTable*/#defineOSPFv3
HOSTMETRIC3#defineOSPFv3HOSTROWSTATUS4#defineOSPFv3HOSTAREAID5/*OSPFv3MIBInterfa
ceTablevalues:ospfv3IfTable*/#defineOSPFv3IFAREAID3#defineOSPFv3IFTYPE4#defineOS
PFv3IFADMINSTATUS5#defineOSPFv3IFRTRPRIORITY6#defineOSPFv3IFTRANSITDELAY7#define
OSPFv3IFRETRANSINTERVAL8#defineOSPFv3IFHELLOINTERVAL9#defineOSPFv3IFRTRDEADINTER
VAL10#defineOSPFv3IFPOLLINTERVAL11#defineOSPFv3IFSTATE12#defineOSPFv3IFDESIGNATE
DROUTER13#defineOSPFv3IFBACKUPDESIGNATEDROUTER14#defineOSPFv3IFEVENTS15#defineOS
PFv3IFROWSTATUS16#defineOSPFv3IFDEMAND17#defineOSPFv3IFMETRICVALUE18#defineOSPFv
3IFLINKSCOPELSACOUNT19#defineOSPFv3IFLINKLSACKSUMSUM20#defineOSPFv3IFDEMANDNBRPR
OBE21#defineOSPFv3IFDEMANDNBRPROBERETRANSLIMIT22#defineOSPFv3IFDEMANDNBRPROBEINT
ERVAL23#defineOSPFv3IFTEDISABLED24#defineOSPFv3IFLINKLSASUPPRESSION25/*OSPFv3MIB
VirtualInterfaceTablevalues:ospfv3VirtIfTable*/#defineOSPFv3VIRTIFINDEX3#defineO
SPFv3VIRTIFINSTID4#defineOSPFv3VIRTIFTRANSITDELAY5#defineOSPFv3VIRTIFRETRANSINTE
RVAL6#defineOSPFv3VIRTIFHELLOINTERVAL7#defineOSPFv3VIRTIFRTRDEADINTERVAL8#define
OSPFv3VIRTIFSTATE9#defineOSPFv3VIRTIFEVENTS10#defineOSPFv3VIRTIFROWSTATUS11#defi
neOSPFv3VIRTIFLINKSCOPELSACOUNT12#defineOSPFv3VIRTIFLINKLSACKSUMSUM13/*OSPFv3MIB
NeighborsTablevalues:ospfv3NbrTable*/#defineOSPFv3NBRADDRESSTYPE4#defineOSPFv3NB
RADDRESS5#defineOSPFv3NBROPTIONS6#defineOSPFv3NBRPRIORITY7#defineOSPFv3NBRSTATE8
#defineOSPFv3NBREVENTS9#defineOSPFv3NBRLSRETRANSQLEN10#defineOSPFv3NBRHELLOSUPPR
ESSED11#defineOSPFv3NBRIFID12#defineOSPFv3NBRRESTARTHELPERSTATUS13#defineOSPFv3N
BRRESTARTHELPERAGE14#defineOSPFv3NBRRESTARTHELPEREXITREASON15/*OSPFv3MIBConfigur
edNeighborsTablevalues:ospfv3CfgNbrTable*/#defineOSPFv3CFGNBRPRIORITY5#defineOSP
Fv3CFGNBRROWSTATUS6/*OSPFv3MIBVirtualNeighborsTablevalues:ospfv3VirtNbrTable*/#d
efineOSPFv3VIRTNBRIFINDEX3#defineOSPFv3VIRTNBRIFINSTID4#defineOSPFv3VIRTNBRADDRE
SSTYPE5#defineOSPFv3VIRTNBRADDRESS6#defineOSPFv3VIRTNBROPTIONS7#defineOSPFv3VIRT
NBRSTATE8#defineOSPFv3VIRTNBREVENTS9#defineOSPFv3VIRTNBRLSRETRANSQLEN10#defineOS
PFv3VIRTNBRHELLOSUPPRESSED11#defineOSPFv3VIRTNBRIFID12#defineOSPFv3VIRTNBRRESTAR
THELPERSTATUS13#defineOSPFv3VIRTNBRRESTARTHELPERAGE14#defineOSPFv3VIRTNBRRESTART
HELPEREXITREASON15/*OSPFv3MIBAreaAggregateTablevalues:ospfv3AreaAggregateTable*/
#defineOSPFv3AREAAGGREGATEROWSTATUS6#defineOSPFv3AREAAGGREGATEEFFECT7#defineOSPF
v3AREAAGGREGATEROUTETAG8/*SYNTAXStatusfromOSPF-MIB.*/#defineOSPF_STATUS_ENABLED1
#defineOSPF_STATUS_DISABLED2/*SNMPvaluehack.*/#defineCOUNTERASN_COUNTER#defineIN
TEGERASN_INTEGER#defineGAUGEASN_GAUGE#defineUNSIGNEDASN_UNSIGNED#defineTIMETICKS
ASN_TIMETICKS#defineIPADDRESSASN_IPADDRESS#defineSTRINGASN_OCTET_STR/*Forreturnv
aluese.g.SNMP_INTEGERmacro*/SNMP_LOCAL_VARIABLES/*OSPFv3-MIBinstances.*/staticoi
dospfv3_oid[]={OSPFv3MIB};staticoidospfv3_trap_oid[]={OSPFv3MIB,0};/*Hookfunctio
ns.*/staticuint8_t*ospfv3GeneralGroup(structvariable*,oid*,size_t*,int,size_t*,W
riteMethod**);staticuint8_t*ospfv3AreaEntry(structvariable*,oid*,size_t*,int,siz
e_t*,WriteMethod**);staticuint8_t*ospfv3WwLsdbEntry(structvariable*,oid*,size_t*
,int,size_t*,WriteMethod**);staticuint8_t*ospfv3NbrEntry(structvariable*,oid*,si
ze_t*,int,size_t*,WriteMethod**);staticuint8_t*ospfv3IfEntry(structvariable*,oid
*,size_t*,int,size_t*,WriteMethod**);staticstructvariableospfv3_variables[]={/*O
SPFgeneralvariables*/{OSPFv3ROUTERID,UNSIGNED,RWRITE,ospfv3GeneralGroup,3,{1,1,1
}},{OSPFv3ADMINSTAT,INTEGER,RWRITE,ospfv3GeneralGroup,3,{1,1,2}},{OSPFv3VERSIONN
UMBER,INTEGER,RONLY,ospfv3GeneralGroup,3,{1,1,3}},{OSPFv3AREABDRRTRSTATUS,INTEGE
R,RONLY,ospfv3GeneralGroup,3,{1,1,4}},{OSPFv3ASBDRRTRSTATUS,INTEGER,RWRITE,ospfv
3GeneralGroup,3,{1,1,5}},{OSPFv3ASSCOPELSACOUNT,GAUGE,RONLY,ospfv3GeneralGroup,3
,{1,1,6}},{OSPFv3ASSCOPELSACHECKSUMSUM,UNSIGNED,RONLY,ospfv3GeneralGroup,3,{1,1,
7}},{OSPFv3ORIGINATENEWLSAS,COUNTER,RONLY,ospfv3GeneralGroup,3,{1,1,8}},{OSPFv3R
XNEWLSAS,COUNTER,RONLY,ospfv3GeneralGroup,3,{1,1,9}},{OSPFv3EXTLSACOUNT,GAUGE,RO
NLY,ospfv3GeneralGroup,3,{1,1,10}},{OSPFv3EXTAREALSDBLIMIT,INTEGER,RWRITE,ospfv3
GeneralGroup,3,{1,1,11}},{OSPFv3EXITOVERFLOWINTERVAL,UNSIGNED,RWRITE,ospfv3Gener
alGroup,3,{1,1,12}},{OSPFv3DEMANDEXTENSIONS,INTEGER,RWRITE,ospfv3GeneralGroup,3,
{1,1,13}},{OSPFv3REFERENCEBANDWIDTH,UNSIGNED,RWRITE,ospfv3GeneralGroup,3,{1,1,14
}},{OSPFv3RESTARTSUPPORT,INTEGER,RWRITE,ospfv3GeneralGroup,3,{1,1,15}},{OSPFv3RE
STARTINTERVAL,UNSIGNED,RWRITE,ospfv3GeneralGroup,3,{1,1,16}},{OSPFv3RESTARTSTRIC
TLSACHECKING,INTEGER,RWRITE,ospfv3GeneralGroup,3,{1,1,17}},{OSPFv3RESTARTSTATUS,
INTEGER,RONLY,ospfv3GeneralGroup,3,{1,1,18}},{OSPFv3RESTARTAGE,UNSIGNED,RONLY,os
pfv3GeneralGroup,3,{1,1,19}},{OSPFv3RESTARTEXITREASON,INTEGER,RONLY,ospfv3Genera
lGroup,3,{1,1,20}},{OSPFv3NOTIFICATIONENABLE,INTEGER,RWRITE,ospfv3GeneralGroup,3
,{1,1,21}},{OSPFv3STUBROUTERSUPPORT,INTEGER,RONLY,ospfv3GeneralGroup,3,{1,1,22}}
,{OSPFv3STUBROUTERADVERTISEMENT,INTEGER,RWRITE,ospfv3GeneralGroup,3,{1,1,23}},{O
SPFv3DISCONTINUITYTIME,TIMETICKS,RONLY,ospfv3GeneralGroup,3,{1,1,24}},{OSPFv3RES
TARTTIME,TIMETICKS,RONLY,ospfv3GeneralGroup,3,{1,1,25}},/*OSPFv3AreaDataStructur
e*/{OSPFv3IMPORTASEXTERN,INTEGER,RWRITE,ospfv3AreaEntry,4,{1,2,1,2}},{OSPFv3AREA
SPFRUNS,COUNTER,RONLY,ospfv3AreaEntry,4,{1,2,1,3}},{OSPFv3AREABDRRTRCOUNT,GAUGE,
RONLY,ospfv3AreaEntry,4,{1,2,1,4}},{OSPFv3AREAASBDRRTRCOUNT,GAUGE,RONLY,ospfv3Ar
eaEntry,4,{1,2,1,5}},{OSPFv3AREASCOPELSACOUNT,GAUGE,RONLY,ospfv3AreaEntry,4,{1,2
,1,6}},{OSPFv3AREASCOPELSACKSUMSUM,UNSIGNED,RONLY,ospfv3AreaEntry,4,{1,2,1,7}},{
OSPFv3AREASUMMARY,INTEGER,RWRITE,ospfv3AreaEntry,4,{1,2,1,8}},{OSPFv3AREAROWSTAT
US,INTEGER,RWRITE,ospfv3AreaEntry,4,{1,2,1,9}},{OSPFv3AREASTUBMETRIC,INTEGER,RWR
ITE,ospfv3AreaEntry,4,{1,2,1,10}},{OSPFv3AREANSSATRANSLATORROLE,INTEGER,RWRITE,o
spfv3AreaEntry,4,{1,2,1,11}},{OSPFv3AREANSSATRANSLATORSTATE,INTEGER,RONLY,ospfv3
AreaEntry,4,{1,2,1,12}},{OSPFv3AREANSSATRANSLATORSTABINTERVAL,UNSIGNED,RWRITE,os
pfv3AreaEntry,4,{1,2,1,13}},{OSPFv3AREANSSATRANSLATOREVENTS,COUNTER,RONLY,ospfv3
AreaEntry,4,{1,2,1,14}},{OSPFv3AREASTUBMETRICTYPE,INTEGER,RWRITE,ospfv3AreaEntry
,4,{1,2,1,15}},{OSPFv3AREATEENABLED,INTEGER,RWRITE,ospfv3AreaEntry,4,{1,2,1,16}}
,/*OSPFv3ASLSDB*/{OSPFv3WWLSDBSEQUENCE|OSPFv3WWASTABLE,INTEGER,RONLY,ospfv3WwLsd
bEntry,4,{1,3,1,4}},{OSPFv3WWLSDBAGE|OSPFv3WWASTABLE,UNSIGNED,RONLY,ospfv3WwLsdb
Entry,4,{1,3,1,5}},{OSPFv3WWLSDBCHECKSUM|OSPFv3WWASTABLE,INTEGER,RONLY,ospfv3WwL
sdbEntry,4,{1,3,1,6}},{OSPFv3WWLSDBADVERTISEMENT|OSPFv3WWASTABLE,STRING,RONLY,os
pfv3WwLsdbEntry,4,{1,3,1,7}},{OSPFv3WWLSDBTYPEKNOWN|OSPFv3WWASTABLE,INTEGER,RONL
Y,ospfv3WwLsdbEntry,4,{1,3,1,8}},/*OSPFv3AreaLSDB*/{OSPFv3WWLSDBSEQUENCE|OSPFv3W
WAREATABLE,INTEGER,RONLY,ospfv3WwLsdbEntry,4,{1,4,1,5}},{OSPFv3WWLSDBAGE|OSPFv3W
WAREATABLE,UNSIGNED,RONLY,ospfv3WwLsdbEntry,4,{1,4,1,6}},{OSPFv3WWLSDBCHECKSUM|O
SPFv3WWAREATABLE,INTEGER,RONLY,ospfv3WwLsdbEntry,4,{1,4,1,7}},{OSPFv3WWLSDBADVER
TISEMENT|OSPFv3WWAREATABLE,STRING,RONLY,ospfv3WwLsdbEntry,4,{1,4,1,8}},{OSPFv3WW
LSDBTYPEKNOWN|OSPFv3WWAREATABLE,INTEGER,RONLY,ospfv3WwLsdbEntry,4,{1,4,1,9}},/*O
SPFv3LinkLSDB*/{OSPFv3WWLSDBSEQUENCE|OSPFv3WWLINKTABLE,INTEGER,RONLY,ospfv3WwLsd
bEntry,4,{1,5,1,6}},{OSPFv3WWLSDBAGE|OSPFv3WWLINKTABLE,UNSIGNED,RONLY,ospfv3WwLs
dbEntry,4,{1,5,1,7}},{OSPFv3WWLSDBCHECKSUM|OSPFv3WWLINKTABLE,INTEGER,RONLY,ospfv
3WwLsdbEntry,4,{1,5,1,8}},{OSPFv3WWLSDBADVERTISEMENT|OSPFv3WWLINKTABLE,STRING,RO
NLY,ospfv3WwLsdbEntry,4,{1,5,1,9}},{OSPFv3WWLSDBTYPEKNOWN|OSPFv3WWLINKTABLE,INTE
GER,RONLY,ospfv3WwLsdbEntry,4,{1,5,1,10}},/*OSPFv3interfaces*/{OSPFv3IFAREAID,UN
SIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,3}},{OSPFv3IFTYPE,INTEGER,RONLY,ospfv3IfEntr
y,4,{1,7,1,4}},{OSPFv3IFADMINSTATUS,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,5}},{OS
PFv3IFRTRPRIORITY,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,6}},{OSPFv3IFTRANSITDELAY
,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,7}},{OSPFv3IFRETRANSINTERVAL,UNSIGNED,RON
LY,ospfv3IfEntry,4,{1,7,1,8}},{OSPFv3IFHELLOINTERVAL,INTEGER,RONLY,ospfv3IfEntry
,4,{1,7,1,9}},{OSPFv3IFRTRDEADINTERVAL,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,10}
},{OSPFv3IFPOLLINTERVAL,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,11}},{OSPFv3IFSTAT
E,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,12}},{OSPFv3IFDESIGNATEDROUTER,UNSIGNED,R
ONLY,ospfv3IfEntry,4,{1,7,1,13}},{OSPFv3IFBACKUPDESIGNATEDROUTER,UNSIGNED,RONLY,
ospfv3IfEntry,4,{1,7,1,14}},{OSPFv3IFEVENTS,COUNTER,RONLY,ospfv3IfEntry,4,{1,7,1
,15}},{OSPFv3IFROWSTATUS,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,16}},{OSPFv3IFDEMA
ND,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,17}},{OSPFv3IFMETRICVALUE,INTEGER,RONLY,
ospfv3IfEntry,4,{1,7,1,18}},{OSPFv3IFLINKSCOPELSACOUNT,GAUGE,RONLY,ospfv3IfEntry
,4,{1,7,1,19}},{OSPFv3IFLINKLSACKSUMSUM,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,20
}},{OSPFv3IFDEMANDNBRPROBE,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,21}},{OSPFv3IFDE
MANDNBRPROBERETRANSLIMIT,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,22}},{OSPFv3IFDEM
ANDNBRPROBEINTERVAL,UNSIGNED,RONLY,ospfv3IfEntry,4,{1,7,1,23}},{OSPFv3IFTEDISABL
ED,INTEGER,RONLY,ospfv3IfEntry,4,{1,7,1,24}},{OSPFv3IFLINKLSASUPPRESSION,INTEGER
,RONLY,ospfv3IfEntry,4,{1,7,1,25}},/*OSPFv3neighbors*/{OSPFv3NBRADDRESSTYPE,INTE
GER,RONLY,ospfv3NbrEntry,4,{1,9,1,4}},{OSPFv3NBRADDRESS,STRING,RONLY,ospfv3NbrEn
try,4,{1,9,1,5}},{OSPFv3NBROPTIONS,INTEGER,RONLY,ospfv3NbrEntry,4,{1,9,1,6}},{OS
PFv3NBRPRIORITY,INTEGER,RONLY,ospfv3NbrEntry,4,{1,9,1,7}},{OSPFv3NBRSTATE,INTEGE
R,RONLY,ospfv3NbrEntry,4,{1,9,1,8}},{OSPFv3NBREVENTS,COUNTER,RONLY,ospfv3NbrEntr
y,4,{1,9,1,9}},{OSPFv3NBRLSRETRANSQLEN,GAUGE,RONLY,ospfv3NbrEntry,4,{1,9,1,10}},
{OSPFv3NBRHELLOSUPPRESSED,INTEGER,RONLY,ospfv3NbrEntry,4,{1,9,1,11}},{OSPFv3NBRI
FID,INTEGER,RONLY,ospfv3NbrEntry,4,{1,9,1,12}},{OSPFv3NBRRESTARTHELPERSTATUS,INT
EGER,RONLY,ospfv3NbrEntry,4,{1,9,1,13}},{OSPFv3NBRRESTARTHELPERAGE,UNSIGNED,RONL
Y,ospfv3NbrEntry,4,{1,9,1,14}},{OSPFv3NBRRESTARTHELPEREXITREASON,INTEGER,RONLY,o
spfv3NbrEntry,4,{1,9,1,15}},};staticuint8_t*ospfv3GeneralGroup(structvariable*v,
oid*name,size_t*length,intexact,size_t*var_len,WriteMethod**write_method){uint16
_tsum;uint32_tcount;structospf6_lsa*lsa=NULL;/*Checkwhethertheinstanceidentifier
isvalid*/if(smux_header_generic(v,name,length,exact,var_len,write_method)==MATCH
_FAILED)returnNULL;/*Returnthecurrentvalueofthevariable*/switch(v->magic){caseOS
PFv3ROUTERID:/*Router-IDofthisOSPFinstance.*/if(ospf6)returnSNMP_INTEGER(ntohl(o
spf6->router_id));returnSNMP_INTEGER(0);caseOSPFv3ADMINSTAT:if(ospf6)returnSNMP_
INTEGER(CHECK_FLAG(ospf6->flag,OSPF6_DISABLED)?OSPF_STATUS_DISABLED:OSPF_STATUS_
ENABLED);returnSNMP_INTEGER(OSPF_STATUS_DISABLED);caseOSPFv3VERSIONNUMBER:return
SNMP_INTEGER(3);caseOSPFv3AREABDRRTRSTATUS:if(ospf6)returnSNMP_INTEGER(ospf6_is_
router_abr(ospf6)?SNMP_TRUE:SNMP_FALSE);returnSNMP_INTEGER(SNMP_FALSE);caseOSPFv
3ASBDRRTRSTATUS:if(ospf6)returnSNMP_INTEGER(ospf6_asbr_is_asbr(ospf6)?SNMP_TRUE:
SNMP_FALSE);returnSNMP_INTEGER(SNMP_FALSE);caseOSPFv3ASSCOPELSACOUNT:if(ospf6)re
turnSNMP_INTEGER(ospf6->lsdb->count);returnSNMP_INTEGER(0);caseOSPFv3ASSCOPELSAC
HECKSUMSUM:if(ospf6){sum=0;for(ALL_LSDB(ospf6->lsdb,lsa))sum+=ntohs(lsa->header-
>checksum);returnSNMP_INTEGER(sum);}returnSNMP_INTEGER(0);caseOSPFv3ORIGINATENEW
LSAS:returnSNMP_INTEGER(0);/*Don'tknowwheretogetthisvalue...*/caseOSPFv3RXNEWLSA
S:returnSNMP_INTEGER(0);/*Don'tknowwheretogetthisvalue...*/caseOSPFv3EXTLSACOUNT
:if(ospf6){count=0;for(ALL_LSDB_TYPED(ospf6->lsdb,htons(OSPF6_LSTYPE_AS_EXTERNAL
),lsa))count+=1;returnSNMP_INTEGER(count);}returnSNMP_INTEGER(0);caseOSPFv3EXTAR
EALSDBLIMIT:returnSNMP_INTEGER(-1);caseOSPFv3EXITOVERFLOWINTERVAL:returnSNMP_INT
EGER(0);/*Notsupported*/caseOSPFv3DEMANDEXTENSIONS:returnSNMP_INTEGER(0);/*Notsu
pported*/caseOSPFv3REFERENCEBANDWIDTH:if(ospf6)returnSNMP_INTEGER(ospf6->ref_ban
dwidth);/*Otherwise,likefor"notimplemented".*//*fallthru*/caseOSPFv3RESTARTSUPPO
RT:caseOSPFv3RESTARTINTERVAL:caseOSPFv3RESTARTSTRICTLSACHECKING:caseOSPFv3RESTAR
TSTATUS:caseOSPFv3RESTARTAGE:caseOSPFv3RESTARTEXITREASON:caseOSPFv3NOTIFICATIONE
NABLE:caseOSPFv3STUBROUTERSUPPORT:caseOSPFv3STUBROUTERADVERTISEMENT:caseOSPFv3DI
SCONTINUITYTIME:caseOSPFv3RESTARTTIME:/*TODO:Notimplemented*/returnNULL;}returnN
ULL;}staticuint8_t*ospfv3AreaEntry(structvariable*v,oid*name,size_t*length,intex
act,size_t*var_len,WriteMethod**write_method){structospf6_area*oa,*area=NULL;str
uctospf6_lsa*lsa=NULL;uint32_tarea_id=0;uint32_tcount;uint16_tsum;structlistnode
*node;unsignedintlen;chara[16];structospf6_route*ro;if(ospf6==NULL)returnNULL;if
(smux_header_table(v,name,length,exact,var_len,write_method)==MATCH_FAILED)retur
nNULL;len=*length-v->namelen;len=(len>=1?1:0);if(exact&&len!=1)returnNULL;if(len
)area_id=htonl(name[v->namelen]);inet_ntop(AF_INET,&area_id,a,sizeof(a));zlog_de
bug("SNMPaccessbyarea:%s,exact=%dlen=%dlength=%lu",a,exact,len,(unsignedlong)*le
ngth);for(ALL_LIST_ELEMENTS_RO(ospf6->area_list,node,oa)){if(area==NULL){if(len=
=0)/*returnfirstareaentry*/area=oa;elseif(exact&&ntohl(oa->area_id)==ntohl(area_
id))area=oa;elseif(ntohl(oa->area_id)>ntohl(area_id))area=oa;}}if(area==NULL)ret
urnNULL;*length=v->namelen+1;name[v->namelen]=ntohl(area->area_id);inet_ntop(AF_
INET,&area->area_id,a,sizeof(a));zlog_debug("SNMPfoundarea:%s,exact=%dlen=%dleng
th=%lu",a,exact,len,(unsignedlong)*length);switch(v->magic){caseOSPFv3IMPORTASEX
TERN:/*NoNSSAsupport*/returnSNMP_INTEGER(IS_AREA_STUB(area)?2:1);caseOSPFv3AREAS
PFRUNS:returnSNMP_INTEGER(area->spf_calculation);caseOSPFv3AREABDRRTRCOUNT:caseO
SPFv3AREAASBDRRTRCOUNT:count=0;for(ro=ospf6_route_head(ospf6->brouter_table);ro;
ro=ospf6_route_next(ro)){if(ntohl(ro->path.area_id)!=ntohl(area->area_id))contin
ue;if(v->magic==OSPFv3AREABDRRTRCOUNT&&CHECK_FLAG(ro->path.router_bits,OSPF6_ROU
TER_BIT_B))count++;if(v->magic==OSPFv3AREAASBDRRTRCOUNT&&CHECK_FLAG(ro->path.rou
ter_bits,OSPF6_ROUTER_BIT_E))count++;}returnSNMP_INTEGER(count);caseOSPFv3AREASC
OPELSACOUNT:returnSNMP_INTEGER(area->lsdb->count);caseOSPFv3AREASCOPELSACKSUMSUM
:sum=0;for(ALL_LSDB(area->lsdb,lsa))sum+=ntohs(lsa->header->checksum);returnSNMP
_INTEGER(sum);caseOSPFv3AREASUMMARY:returnSNMP_INTEGER(2);/*sendAreaSummary*/cas
eOSPFv3AREAROWSTATUS:returnSNMP_INTEGER(1);/*Active*/caseOSPFv3AREASTUBMETRIC:ca
seOSPFv3AREANSSATRANSLATORROLE:caseOSPFv3AREANSSATRANSLATORSTATE:caseOSPFv3AREAN
SSATRANSLATORSTABINTERVAL:caseOSPFv3AREANSSATRANSLATOREVENTS:caseOSPFv3AREASTUBM
ETRICTYPE:caseOSPFv3AREATEENABLED:/*Notimplemented.*/returnNULL;}returnNULL;}sta
ticintif_icmp_func(structinterface*ifp1,structinterface*ifp2){return(ifp1->ifind
ex-ifp2->ifindex);}staticuint8_t*ospfv3WwLsdbEntry(structvariable*v,oid*name,siz
e_t*length,intexact,size_t*var_len,WriteMethod**write_method){structvrf*vrf=vrf_
lookup_by_id(VRF_DEFAULT);structospf6_lsa*lsa=NULL;ifindex_tifindex;uint32_tarea
_id,id,instid,adv_router;uint16_ttype;intlen;oid*offset;intoffsetlen;structospf6
_area*oa=NULL;structlistnode*node;structinterface*iif;structospf6_interface*oi=N
ULL;structlist*ifslist;if(smux_header_table(v,name,length,exact,var_len,write_me
thod)==MATCH_FAILED)returnNULL;instid=ifindex=area_id=type=id=adv_router=0;/*Che
ckOSPFv3instance.*/if(ospf6==NULL)returnNULL;/*Getvariablelength.*/offset=name+v
->namelen;offsetlen=*length-v->namelen;if(exact&&(v->magic&OSPFv3WWASTABLE)&&off
setlen!=3)returnNULL;if(exact&&(v->magic&OSPFv3WWAREATABLE)&&offsetlen!=4)return
NULL;if(exact&&(v->magic&OSPFv3WWLINKTABLE)&&offsetlen!=5)returnNULL;if(v->magic
&OSPFv3WWLINKTABLE){/*Parseifindex*/len=(offsetlen<1?0:1);if(len)ifindex=*offset
;offset+=len;offsetlen-=len;/*ParseinstanceID*/len=(offsetlen<1?0:1);if(len)inst
id=*offset;offset+=len;offsetlen-=len;}elseif(v->magic&OSPFv3WWAREATABLE){/*Pars
earea-id*/len=(offsetlen<1?0:1);if(len)area_id=htonl(*offset);offset+=len;offset
len-=len;}/*Parsetype*/len=(offsetlen<1?0:1);if(len)type=htons(*offset);offset+=
len;offsetlen-=len;/*ParseRouter-ID*/len=(offsetlen<1?0:1);if(len)adv_router=hto
nl(*offset);offset+=len;offsetlen-=len;/*ParseLS-ID*/len=(offsetlen<1?0:1);if(le
n)id=htonl(*offset);offset+=len;//offsetlen-=len;//Addbackinifweneeditagainif(ex
act){if(v->magic&OSPFv3WWASTABLE){lsa=ospf6_lsdb_lookup(type,id,adv_router,ospf6
->lsdb);}elseif(v->magic&OSPFv3WWAREATABLE){oa=ospf6_area_lookup(area_id,ospf6);
if(!oa)returnNULL;lsa=ospf6_lsdb_lookup(type,id,adv_router,oa->lsdb);}elseif(v->
magic&OSPFv3WWLINKTABLE){oi=ospf6_interface_lookup_by_ifindex(ifindex);if(!oi||o
i->instance_id!=instid)returnNULL;lsa=ospf6_lsdb_lookup(type,id,adv_router,oi->l
sdb);}}else{if(v->magic&OSPFv3WWASTABLE){if(ospf6->lsdb->count)lsa=ospf6_lsdb_lo
okup_next(type,id,adv_router,ospf6->lsdb);}elseif(v->magic&OSPFv3WWAREATABLE)for
(ALL_LIST_ELEMENTS_RO(ospf6->area_list,node,oa)){if(oa->area_id<area_id)continue
;if(oa->lsdb->count)lsa=ospf6_lsdb_lookup_next(type,id,adv_router,oa->lsdb);if(l
sa)break;type=0;id=0;adv_router=0;}elseif(v->magic&OSPFv3WWLINKTABLE){/*Webuilda
sortedlistofinterfaces*/ifslist=list_new();if(!ifslist)returnNULL;ifslist->cmp=(
int(*)(void*,void*))if_icmp_func;FOR_ALL_INTERFACES(vrf,iif)listnode_add_sort(if
slist,iif);for(ALL_LIST_ELEMENTS_RO(ifslist,node,iif)){if(!iif->ifindex)continue
;oi=ospf6_interface_lookup_by_ifindex(iif->ifindex);if(!oi)continue;if(iif->ifin
dex<ifindex)continue;if(oi->instance_id<instid)continue;if(oi->lsdb->count)lsa=o
spf6_lsdb_lookup_next(type,id,adv_router,oi->lsdb);if(lsa)break;type=0;id=0;adv_
router=0;oi=NULL;}list_delete_all_node(ifslist);}}if(!lsa)returnNULL;/*Addindexe
s*/if(v->magic&OSPFv3WWASTABLE){*length=v->namelen+3;offset=name+v->namelen;}els
eif(v->magic&OSPFv3WWAREATABLE){*length=v->namelen+4;offset=name+v->namelen;*off
set=ntohl(oa->area_id);offset++;}elseif(v->magic&OSPFv3WWLINKTABLE){*length=v->n
amelen+5;offset=name+v->namelen;*offset=oi->interface->ifindex;offset++;*offset=
oi->instance_id;offset++;}*offset=ntohs(lsa->header->type);offset++;*offset=ntoh
l(lsa->header->adv_router);offset++;*offset=ntohl(lsa->header->id);offset++;/*Re
turnthecurrentvalueofthevariable*/switch(v->magic&OSPFv3WWCOLUMN){caseOSPFv3WWLS
DBSEQUENCE:returnSNMP_INTEGER(ntohl(lsa->header->seqnum));break;caseOSPFv3WWLSDB
AGE:ospf6_lsa_age_current(lsa);returnSNMP_INTEGER(ntohs(lsa->header->age));break
;caseOSPFv3WWLSDBCHECKSUM:returnSNMP_INTEGER(ntohs(lsa->header->checksum));break
;caseOSPFv3WWLSDBADVERTISEMENT:*var_len=ntohs(lsa->header->length);return(uint8_
t*)lsa->header;break;caseOSPFv3WWLSDBTYPEKNOWN:returnSNMP_INTEGER(OSPF6_LSA_IS_K
NOWN(lsa->header->type)?SNMP_TRUE:SNMP_FALSE);break;}returnNULL;}staticuint8_t*o
spfv3IfEntry(structvariable*v,oid*name,size_t*length,intexact,size_t*var_len,Wri
teMethod**write_method){structvrf*vrf=vrf_lookup_by_id(VRF_DEFAULT);ifindex_tifi
ndex=0;unsignedintinstid=0;structospf6_interface*oi=NULL;structospf6_lsa*lsa=NUL
L;structinterface*iif;structlistnode*i;structlist*ifslist;oid*offset;intoffsetle
n,len;uint32_tsum;if(smux_header_table(v,name,length,exact,var_len,write_method)
==MATCH_FAILED)returnNULL;/*CheckOSPFv3instance.*/if(ospf6==NULL)returnNULL;/*Ge
tvariablelength.*/offset=name+v->namelen;offsetlen=*length-v->namelen;if(exact&&
offsetlen!=2)returnNULL;/*Parseifindex*/len=(offsetlen<1?0:1);if(len)ifindex=*of
fset;offset+=len;offsetlen-=len;/*ParseinstanceID*/len=(offsetlen<1?0:1);if(len)
instid=*offset;//offset+=len;//Addbackinifweeverstartusingagain//offsetlen-=len;
if(exact){oi=ospf6_interface_lookup_by_ifindex(ifindex);if(!oi||oi->instance_id!
=instid)returnNULL;}else{/*Webuildasortedlistofinterfaces*/ifslist=list_new();if
(!ifslist)returnNULL;ifslist->cmp=(int(*)(void*,void*))if_icmp_func;FOR_ALL_INTE
RFACES(vrf,iif)listnode_add_sort(ifslist,iif);for(ALL_LIST_ELEMENTS_RO(ifslist,i
,iif)){if(!iif->ifindex)continue;oi=ospf6_interface_lookup_by_ifindex(iif->ifind
ex);if(!oi)continue;if(iif->ifindex>ifindex||(iif->ifindex==ifindex&&(oi->instan
ce_id>instid)))break;oi=NULL;}list_delete_all_node(ifslist);}if(!oi)returnNULL;/
*AddIndex(IfIndex,IfInstId)*/*length=v->namelen+2;offset=name+v->namelen;*offset
=oi->interface->ifindex;offset++;*offset=oi->instance_id;offset++;/*Returnthecur
rentvalueofthevariable*/switch(v->magic){caseOSPFv3IFAREAID:if(oi->area)returnSN
MP_INTEGER(ntohl(oi->area->area_id));break;caseOSPFv3IFTYPE:if(if_is_broadcast(o
i->interface))returnSNMP_INTEGER(1);elseif(if_is_pointopoint(oi->interface))retu
rnSNMP_INTEGER(3);elsebreak;/*Unknown,don'tputanything*/caseOSPFv3IFADMINSTATUS:
if(oi->area)returnSNMP_INTEGER(OSPF_STATUS_ENABLED);returnSNMP_INTEGER(OSPF_STAT
US_DISABLED);caseOSPFv3IFRTRPRIORITY:returnSNMP_INTEGER(oi->priority);caseOSPFv3
IFTRANSITDELAY:returnSNMP_INTEGER(oi->transdelay);caseOSPFv3IFRETRANSINTERVAL:re
turnSNMP_INTEGER(oi->rxmt_interval);caseOSPFv3IFHELLOINTERVAL:returnSNMP_INTEGER
(oi->hello_interval);caseOSPFv3IFRTRDEADINTERVAL:returnSNMP_INTEGER(oi->dead_int
erval);caseOSPFv3IFPOLLINTERVAL:/*NosupportforNBMA*/break;caseOSPFv3IFSTATE:retu
rnSNMP_INTEGER(oi->state);caseOSPFv3IFDESIGNATEDROUTER:returnSNMP_INTEGER(ntohl(
oi->drouter));caseOSPFv3IFBACKUPDESIGNATEDROUTER:returnSNMP_INTEGER(ntohl(oi->bd
router));caseOSPFv3IFEVENTS:returnSNMP_INTEGER(oi->state_change);caseOSPFv3IFROW
STATUS:returnSNMP_INTEGER(1);caseOSPFv3IFDEMAND:returnSNMP_INTEGER(SNMP_FALSE);c
aseOSPFv3IFMETRICVALUE:returnSNMP_INTEGER(oi->cost);caseOSPFv3IFLINKSCOPELSACOUN
T:returnSNMP_INTEGER(oi->lsdb->count);caseOSPFv3IFLINKLSACKSUMSUM:sum=0;for(ALL_
LSDB(oi->lsdb,lsa))sum+=ntohs(lsa->header->checksum);returnSNMP_INTEGER(sum);cas
eOSPFv3IFDEMANDNBRPROBE:caseOSPFv3IFDEMANDNBRPROBERETRANSLIMIT:caseOSPFv3IFDEMAN
DNBRPROBEINTERVAL:caseOSPFv3IFTEDISABLED:caseOSPFv3IFLINKLSASUPPRESSION:/*Notimp
lemented.Onlyworksifallthelastonesarenotimplemented!*/returnNULL;}/*Tryaninterna
lgetnext.Somecolumnsaremissinginthistable.*/if(!exact&&(name[*length-1]<MAX_SUBI
D))returnospfv3IfEntry(v,name,length,exact,var_len,write_method);returnNULL;}sta
ticuint8_t*ospfv3NbrEntry(structvariable*v,oid*name,size_t*length,intexact,size_
t*var_len,WriteMethod**write_method){structvrf*vrf=vrf_lookup_by_id(VRF_DEFAULT)
;ifindex_tifindex=0;unsignedintinstid,rtrid;structospf6_interface*oi=NULL;struct
ospf6_neighbor*on=NULL;structinterface*iif;structlistnode*i,*j;structlist*ifslis
t;oid*offset;intoffsetlen,len;if(smux_header_table(v,name,length,exact,var_len,w
rite_method)==MATCH_FAILED)returnNULL;instid=rtrid=0;/*CheckOSPFv3instance.*/if(
ospf6==NULL)returnNULL;/*Getvariablelength.*/offset=name+v->namelen;offsetlen=*l
ength-v->namelen;if(exact&&offsetlen!=3)returnNULL;/*Parseifindex*/len=(offsetle
n<1?0:1);if(len)ifindex=*offset;offset+=len;offsetlen-=len;/*ParseinstanceID*/le
n=(offsetlen<1?0:1);if(len)instid=*offset;offset+=len;offsetlen-=len;/*Parserout
erID*/len=(offsetlen<1?0:1);if(len)rtrid=htonl(*offset);//offset+=len;//Addbacki
nifweeverstartlookingatdata//offsetlen-=len;if(exact){oi=ospf6_interface_lookup_
by_ifindex(ifindex);if(!oi||oi->instance_id!=instid)returnNULL;on=ospf6_neighbor
_lookup(rtrid,oi);}else{/*Webuildasortedlistofinterfaces*/ifslist=list_new();if(
!ifslist)returnNULL;ifslist->cmp=(int(*)(void*,void*))if_icmp_func;FOR_ALL_INTER
FACES(vrf,iif)listnode_add_sort(ifslist,iif);for(ALL_LIST_ELEMENTS_RO(ifslist,i,
iif)){if(!iif->ifindex)continue;oi=ospf6_interface_lookup_by_ifindex(iif->ifinde
x);if(!oi)continue;for(ALL_LIST_ELEMENTS_RO(oi->neighbor_list,j,on)){if(iif->ifi
ndex>ifindex||(iif->ifindex==ifindex&&(oi->instance_id>instid||(oi->instance_id=
=instid&&ntohl(on->router_id)>ntohl(rtrid)))))break;}if(on)break;oi=NULL;on=NULL
;}list_delete_all_node(ifslist);}if(!oi||!on)returnNULL;/*AddIndex(IfIndex,IfIns
tId,RtrId)*/*length=v->namelen+3;offset=name+v->namelen;*offset=oi->interface->i
findex;offset++;*offset=oi->instance_id;offset++;*offset=ntohl(on->router_id);of
fset++;/*Returnthecurrentvalueofthevariable*/switch(v->magic){caseOSPFv3NBRADDRE
SSTYPE:returnSNMP_INTEGER(2);/*IPv6only*/caseOSPFv3NBRADDRESS:*var_len=sizeof(st
ructin6_addr);return(uint8_t*)&on->linklocal_addr;caseOSPFv3NBROPTIONS:returnSNM
P_INTEGER(on->options[2]);caseOSPFv3NBRPRIORITY:returnSNMP_INTEGER(on->priority)
;caseOSPFv3NBRSTATE:returnSNMP_INTEGER(on->state);caseOSPFv3NBREVENTS:returnSNMP
_INTEGER(on->state_change);caseOSPFv3NBRLSRETRANSQLEN:returnSNMP_INTEGER(on->ret
rans_list->count);caseOSPFv3NBRHELLOSUPPRESSED:returnSNMP_INTEGER(SNMP_FALSE);ca
seOSPFv3NBRIFID:returnSNMP_INTEGER(on->ifindex);caseOSPFv3NBRRESTARTHELPERSTATUS
:caseOSPFv3NBRRESTARTHELPERAGE:caseOSPFv3NBRRESTARTHELPEREXITREASON:/*Notimpleme
nted.Onlyworksifallthelastonesarenotimplemented!*/returnNULL;}returnNULL;}/*OSPF
Traps.*/#defineNBRSTATECHANGE2#defineIFSTATECHANGE10staticstructtrap_objectospf6
NbrTrapList[]={{-3,{1,1,OSPFv3ROUTERID}},{4,{1,9,1,OSPFv3NBRADDRESSTYPE}},{4,{1,
9,1,OSPFv3NBRADDRESS}},{4,{1,9,1,OSPFv3NBRSTATE}}};staticstructtrap_objectospf6I
fTrapList[]={{-3,{1,1,OSPFv3ROUTERID}},{4,{1,7,1,OSPFv3IFSTATE}},{4,{1,7,1,OSPFv
3IFADMINSTATUS}},{4,{1,7,1,OSPFv3IFAREAID}}};staticintospf6TrapNbrStateChange(st
ructospf6_neighbor*on,intnext_state,intprev_state){oidindex[3];/*Terminalstateor
regression*/if((next_state!=OSPF6_NEIGHBOR_FULL)&&(next_state!=OSPF6_NEIGHBOR_TW
OWAY)&&(next_state>=prev_state))return0;index[0]=on->ospf6_if->interface->ifinde
x;index[1]=on->ospf6_if->instance_id;index[2]=ntohl(on->router_id);smux_trap(osp
fv3_variables,sizeofospfv3_variables/sizeof(structvariable),ospfv3_trap_oid,size
ofospfv3_trap_oid/sizeof(oid),ospfv3_oid,sizeofospfv3_oid/sizeof(oid),index,3,os
pf6NbrTrapList,sizeofospf6NbrTrapList/sizeof(structtrap_object),NBRSTATECHANGE);
return0;}staticintospf6TrapIfStateChange(structospf6_interface*oi,intnext_state,
intprev_state){oidindex[2];/*Terminalstateorregression*/if((next_state!=OSPF6_IN
TERFACE_POINTTOPOINT)&&(next_state!=OSPF6_INTERFACE_DROTHER)&&(next_state!=OSPF6
_INTERFACE_BDR)&&(next_state!=OSPF6_INTERFACE_DR)&&(next_state>=prev_state))retu
rn0;index[0]=oi->interface->ifindex;index[1]=oi->instance_id;smux_trap(ospfv3_va
riables,sizeofospfv3_variables/sizeof(structvariable),ospfv3_trap_oid,sizeofospf
v3_trap_oid/sizeof(oid),ospfv3_oid,sizeofospfv3_oid/sizeof(oid),index,2,ospf6IfT
rapList,sizeofospf6IfTrapList/sizeof(structtrap_object),IFSTATECHANGE);return0;}
/*RegisterOSPFv3-MIB.*/staticintospf6_snmp_init(structthread_master*master){smux
_init(master);REGISTER_MIB("OSPFv3MIB",ospfv3_variables,variable,ospfv3_oid);ret
urn0;}staticintospf6_snmp_module_init(void){hook_register(ospf6_interface_change
,ospf6TrapIfStateChange);hook_register(ospf6_neighbor_change,ospf6TrapNbrStateCh
ange);hook_register(frr_late_init,ospf6_snmp_init);return0;}FRR_MODULE_SETUP(.na
me="ospf6d_snmp",.version=FRR_VERSION,.description="ospf6dAgentXSNMPmodule",.ini
t=ospf6_snmp_module_init,)