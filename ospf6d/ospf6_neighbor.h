/**Copyright(C)2003YasuhiroOhara**ThisfileispartofGNUZebra.**GNUZebraisfreesoftw
are;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublicLicense
aspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyouroption)any*later
version.**GNUZebraisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRANT
Y;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.
SeetheGNU*GeneralPublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGN
UGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFre
eSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifnde
fOSPF6_NEIGHBOR_H#defineOSPF6_NEIGHBOR_H#include"hook.h"/*Debugoption*/externuns
ignedcharconf_debug_ospf6_neighbor;#defineOSPF6_DEBUG_NEIGHBOR_STATE0x01#defineO
SPF6_DEBUG_NEIGHBOR_EVENT0x02#defineOSPF6_DEBUG_NEIGHBOR_ON(level)(conf_debug_os
pf6_neighbor|=(level))#defineOSPF6_DEBUG_NEIGHBOR_OFF(level)(conf_debug_ospf6_ne
ighbor&=~(level))#defineIS_OSPF6_DEBUG_NEIGHBOR(level)\(conf_debug_ospf6_neighbo
r&OSPF6_DEBUG_NEIGHBOR_##level)/*Neighborstructure*/structospf6_neighbor{/*Neigh
borRouterIDString*/charname[32];/*OSPFv3Interfacethisneighborbelongsto*/structos
pf6_interface*ospf6_if;/*Neighborstate*/uint8_tstate;/*timestampoflastchangingst
ate*/uint32_tstate_change;structtimevallast_changed;/*NeighborRouterID*/uint32_t
router_id;/*NeighborInterfaceID*/ifindex_tifindex;/*RouterPriorityofthisneighbor
*/uint8_tpriority;uint32_tdrouter;uint32_tbdrouter;uint32_tprev_drouter;uint32_t
prev_bdrouter;/*Optionsfield(Capability)*/charoptions[3];/*IPaddrofI/Fonoursidel
ink*/structin6_addrlinklocal_addr;/*ForDatabaseExchange*/uint8_tdbdesc_bits;uint
32_tdbdesc_seqnum;/*LastreceivedDatabaseDescriptionpacket*/structospf6_dbdescdbd
esc_last;/*LS-list*/structospf6_lsdb*summary_list;structospf6_lsdb*request_list;
structospf6_lsdb*retrans_list;/*LSAlistformessagetransmission*/structospf6_lsdb*
dbdesc_list;structospf6_lsdb*lsreq_list;structospf6_lsdb*lsupdate_list;structosp
f6_lsdb*lsack_list;structospf6_lsa*last_ls_req;/*Inactivitytimer*/structthread*i
nactivity_timer;/*Threadforsendingmessage*/structthread*thread_send_dbdesc;struc
tthread*thread_send_lsreq;structthread*thread_send_lsupdate;structthread*thread_
send_lsack;/*BFDinformation*/void*bfd_info;};/*Neighborstate*/#defineOSPF6_NEIGH
BOR_DOWN1#defineOSPF6_NEIGHBOR_ATTEMPT2#defineOSPF6_NEIGHBOR_INIT3#defineOSPF6_N
EIGHBOR_TWOWAY4#defineOSPF6_NEIGHBOR_EXSTART5#defineOSPF6_NEIGHBOR_EXCHANGE6#def
ineOSPF6_NEIGHBOR_LOADING7#defineOSPF6_NEIGHBOR_FULL8/*NeighborEvents*/#defineOS
PF6_NEIGHBOR_EVENT_NO_EVENT0#defineOSPF6_NEIGHBOR_EVENT_HELLO_RCVD1#defineOSPF6_
NEIGHBOR_EVENT_TWOWAY_RCVD2#defineOSPF6_NEIGHBOR_EVENT_NEGOTIATION_DONE3#defineO
SPF6_NEIGHBOR_EVENT_EXCHANGE_DONE4#defineOSPF6_NEIGHBOR_EVENT_LOADING_DONE5#defi
neOSPF6_NEIGHBOR_EVENT_ADJ_OK6#defineOSPF6_NEIGHBOR_EVENT_SEQNUMBER_MISMATCH7#de
fineOSPF6_NEIGHBOR_EVENT_BAD_LSREQ8#defineOSPF6_NEIGHBOR_EVENT_ONEWAY_RCVD9#defi
neOSPF6_NEIGHBOR_EVENT_INACTIVITY_TIMER10#defineOSPF6_NEIGHBOR_EVENT_MAX_EVENT11
staticconstchar*ospf6_neighbor_event_str[]={"NoEvent","HelloReceived","2-WayRece
ived","NegotiationDone","ExchangeDone","LoadingDone","AdjOK?","SeqNumberMismatch
","BadLSReq","1-WayReceived","InactivityTimer",};staticinlineconstchar*ospf6_nei
ghbor_event_string(intevent){#defineOSPF6_NEIGHBOR_UNKNOWN_EVENT_STRING"UnknownE
vent"if(event<OSPF6_NEIGHBOR_EVENT_MAX_EVENT)returnospf6_neighbor_event_str[even
t];returnOSPF6_NEIGHBOR_UNKNOWN_EVENT_STRING;}externconstchar*ospf6_neighbor_sta
te_str[];/*FunctionPrototypes*/intospf6_neighbor_cmp(void*va,void*vb);voidospf6_
neighbor_dbex_init(structospf6_neighbor*on);structospf6_neighbor*ospf6_neighbor_
lookup(uint32_t,structospf6_interface*);structospf6_neighbor*ospf6_neighbor_crea
te(uint32_t,structospf6_interface*);voidospf6_neighbor_delete(structospf6_neighb
or*);/*Neighborevent*/externinthello_received(structthread*);externinttwoway_rec
eived(structthread*);externintnegotiation_done(structthread*);externintexchange_
done(structthread*);externintloading_done(structthread*);externintadj_ok(structt
hread*);externintseqnumber_mismatch(structthread*);externintbad_lsreq(structthre
ad*);externintoneway_received(structthread*);externintinactivity_timer(structthr
ead*);externvoidospf6_check_nbr_loading(structospf6_neighbor*);externvoidospf6_n
eighbor_init(void);externintconfig_write_ospf6_debug_neighbor(structvty*vty);ext
ernvoidinstall_element_ospf6_debug_neighbor(void);DECLARE_HOOK(ospf6_neighbor_ch
ange,(structospf6_neighbor*on,intstate,intnext_state),(on,state,next_state))#end
if/*OSPF6_NEIGHBOR_H*/