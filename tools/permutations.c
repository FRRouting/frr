/**Generatesallpossiblematchinginputsforacommandstring.*--*Copyright(C)2016Cumul
usNetworks,Inc.**ThisfileispartofGNUZebra.**GNUZebraisfreesoftware;youcanredistr
ibuteitand/ormodifyit*underthetermsoftheGNUGeneralPublicLicenseaspublishedbythe*
FreeSoftwareFoundation;eitherversion2,or(atyouroption)any*laterversion.**GNUZebr
aisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRANTY;withouteventhei
mpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*General
PublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLic
ensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundat
ion,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#include"command.h"#inc
lude"graph.h"#include"vector.h"#defineUSAGE"usage:permutations<cmdstr>"voidpermu
te(structgraph_node*);voidpretty_print_graph(structgraph_node*start,intlevel);in
tmain(intargc,char*argv[]){if(argc<2){fprintf(stdout,USAGE"\n");exit(EXIT_SUCCES
S);}structcmd_element*cmd=calloc(1,sizeof(structcmd_element));cmd->string=strdup
(argv[1]);structgraph*graph=graph_new();structcmd_token*token=cmd_token_new(STAR
T_TKN,cmd->attr,NULL,NULL);graph_new_node(graph,token,NULL);cmd_graph_parse(grap
h,cmd);permute(vector_slot(graph->nodes,0));}voidpermute(structgraph_node*start)
{staticstructlist*position=NULL;if(!position)position=list_new();structcmd_token
*stok=start->data;structgraph_node*gnn;structlistnode*ln;//recursivedfslistnode_
add(position,start);for(unsignedinti=0;i<vector_active(start->to);i++){structgra
ph_node*gn=vector_slot(start->to,i);structcmd_token*tok=gn->data;if(tok->attr==C
MD_ATTR_HIDDEN||tok->attr==CMD_ATTR_DEPRECATED)continue;elseif(tok->type==END_TK
N||gn==start){fprintf(stdout,"");for(ALL_LIST_ELEMENTS_RO(position,ln,gnn)){stru
ctcmd_token*tt=gnn->data;if(tt->type<SPECIAL_TKN)fprintf(stdout,"%s",tt->text);}
if(gn==start)fprintf(stdout,"...");fprintf(stdout,"\n");}else{boolskip=false;if(
stok->type==FORK_TKN&&tok->type!=FORK_TKN)for(ALL_LIST_ELEMENTS_RO(position,ln,g
nn))if(gnn==gn){skip=true;break;}if(!skip)permute(gn);}}list_delete_node(positio
n,listtail(position));}