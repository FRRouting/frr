/*RIPdebugroutines*Copyright(C)1999KunihiroIshiguro<kunihiro@zebra.org>**Thisfil
eispartofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*un
derthetermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;e
itherversion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopet
hatitwillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHAN
TABILITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredeta
ils.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogra
m;seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,Fi
fthFloor,Boston,MA02110-1301USA*/#include<zebra.h>#include"command.h"#include"ri
pd/rip_debug.h"/*Fordebugstatement.*/unsignedlongrip_debug_event=0;unsignedlongr
ip_debug_packet=0;unsignedlongrip_debug_zebra=0;DEFUN_NOSH(show_debugging_rip,sh
ow_debugging_rip_cmd,"showdebugging[rip]",SHOW_STRDEBUG_STRRIP_STR){vty_out(vty,
"RIPdebuggingstatus:\n");if(IS_RIP_DEBUG_EVENT)vty_out(vty,"RIPeventdebuggingiso
n\n");if(IS_RIP_DEBUG_PACKET){if(IS_RIP_DEBUG_SEND&&IS_RIP_DEBUG_RECV){vty_out(v
ty,"RIPpacketdebuggingison\n");}else{if(IS_RIP_DEBUG_SEND)vty_out(vty,"RIPpacket
senddebuggingison\n");elsevty_out(vty,"RIPpacketreceivedebuggingison\n");}}if(IS
_RIP_DEBUG_ZEBRA)vty_out(vty,"RIPzebradebuggingison\n");returnCMD_SUCCESS;}DEFUN
(debug_rip_events,debug_rip_events_cmd,"debugripevents",DEBUG_STRRIP_STR"RIPeven
ts\n"){rip_debug_event=RIP_DEBUG_EVENT;returnCMD_SUCCESS;}DEFUN(debug_rip_packet
,debug_rip_packet_cmd,"debugrippacket",DEBUG_STRRIP_STR"RIPpacket\n"){rip_debug_
packet=RIP_DEBUG_PACKET;rip_debug_packet|=RIP_DEBUG_SEND;rip_debug_packet|=RIP_D
EBUG_RECV;returnCMD_SUCCESS;}DEFUN(debug_rip_packet_direct,debug_rip_packet_dire
ct_cmd,"debugrippacket<recv|send>",DEBUG_STRRIP_STR"RIPpacket\n""RIPreceivepacke
t\n""RIPsendpacket\n"){intidx_recv_send=3;rip_debug_packet|=RIP_DEBUG_PACKET;if(
strcmp("send",argv[idx_recv_send]->text)==0)rip_debug_packet|=RIP_DEBUG_SEND;if(
strcmp("recv",argv[idx_recv_send]->text)==0)rip_debug_packet|=RIP_DEBUG_RECV;ret
urnCMD_SUCCESS;}DEFUN(debug_rip_zebra,debug_rip_zebra_cmd,"debugripzebra",DEBUG_
STRRIP_STR"RIPandZEBRAcommunication\n"){rip_debug_zebra=RIP_DEBUG_ZEBRA;returnCM
D_SUCCESS;}DEFUN(no_debug_rip_events,no_debug_rip_events_cmd,"nodebugripevents",
NO_STRDEBUG_STRRIP_STR"RIPevents\n"){rip_debug_event=0;returnCMD_SUCCESS;}DEFUN(
no_debug_rip_packet,no_debug_rip_packet_cmd,"nodebugrippacket",NO_STRDEBUG_STRRI
P_STR"RIPpacket\n"){rip_debug_packet=0;returnCMD_SUCCESS;}DEFUN(no_debug_rip_pac
ket_direct,no_debug_rip_packet_direct_cmd,"nodebugrippacket<recv|send>",NO_STRDE
BUG_STRRIP_STR"RIPpacket\n""RIPoptionsetforreceivepacket\n""RIPoptionsetforsendp
acket\n"){intidx_recv_send=4;if(strcmp("send",argv[idx_recv_send]->text)==0){if(
IS_RIP_DEBUG_RECV)rip_debug_packet&=~RIP_DEBUG_SEND;elserip_debug_packet=0;}else
if(strcmp("recv",argv[idx_recv_send]->text)==0){if(IS_RIP_DEBUG_SEND)rip_debug_p
acket&=~RIP_DEBUG_RECV;elserip_debug_packet=0;}returnCMD_SUCCESS;}DEFUN(no_debug
_rip_zebra,no_debug_rip_zebra_cmd,"nodebugripzebra",NO_STRDEBUG_STRRIP_STR"RIPan
dZEBRAcommunication\n"){rip_debug_zebra=0;returnCMD_SUCCESS;}/*Debugnode.*/stati
cstructcmd_nodedebug_node={DEBUG_NODE,"",/*Debugnodehasnointerface.*/1};staticin
tconfig_write_debug(structvty*vty){intwrite=0;if(IS_RIP_DEBUG_EVENT){vty_out(vty
,"debugripevents\n");write++;}if(IS_RIP_DEBUG_PACKET){if(IS_RIP_DEBUG_SEND&&IS_R
IP_DEBUG_RECV){vty_out(vty,"debugrippacket\n");write++;}else{if(IS_RIP_DEBUG_SEN
D)vty_out(vty,"debugrippacketsend\n");elsevty_out(vty,"debugrippacketrecv\n");wr
ite++;}}if(IS_RIP_DEBUG_ZEBRA){vty_out(vty,"debugripzebra\n");write++;}returnwri
te;}voidrip_debug_reset(void){rip_debug_event=0;rip_debug_packet=0;rip_debug_zeb
ra=0;}voidrip_debug_init(void){rip_debug_event=0;rip_debug_packet=0;rip_debug_ze
bra=0;install_node(&debug_node,config_write_debug);install_element(ENABLE_NODE,&
show_debugging_rip_cmd);install_element(ENABLE_NODE,&debug_rip_events_cmd);insta
ll_element(ENABLE_NODE,&debug_rip_packet_cmd);install_element(ENABLE_NODE,&debug
_rip_packet_direct_cmd);install_element(ENABLE_NODE,&debug_rip_zebra_cmd);instal
l_element(ENABLE_NODE,&no_debug_rip_events_cmd);install_element(ENABLE_NODE,&no_
debug_rip_packet_cmd);install_element(ENABLE_NODE,&no_debug_rip_packet_direct_cm
d);install_element(ENABLE_NODE,&no_debug_rip_zebra_cmd);install_element(CONFIG_N
ODE,&debug_rip_events_cmd);install_element(CONFIG_NODE,&debug_rip_packet_cmd);in
stall_element(CONFIG_NODE,&debug_rip_packet_direct_cmd);install_element(CONFIG_N
ODE,&debug_rip_zebra_cmd);install_element(CONFIG_NODE,&no_debug_rip_events_cmd);
install_element(CONFIG_NODE,&no_debug_rip_packet_cmd);install_element(CONFIG_NOD
E,&no_debug_rip_packet_direct_cmd);install_element(CONFIG_NODE,&no_debug_rip_zeb
ra_cmd);}