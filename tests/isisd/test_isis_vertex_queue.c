#include<zebra.h>#include"isisd/isis_spf.c"structthread_master*master;intisis_so
ck_init(structisis_circuit*circuit);intisis_sock_init(structisis_circuit*circuit
){return0;}structzebra_privs_tisisd_privs;staticstructisis_vertex**vertices;stat
icsize_tvertex_count;staticvoidsetup_test_vertices(void){structprefixp={.family=
AF_UNSPEC};uint8_tnode_id[7];vertices=XMALLOC(MTYPE_TMP,sizeof(*vertices)*16);p.
family=AF_INET;p.prefixlen=24;inet_pton(AF_INET,"192.168.1.0",&p.u.prefix4);vert
ices[vertex_count]=isis_vertex_new(&p,VTYPE_IPREACH_TE);vertices[vertex_count]->
d_N=20;vertex_count++;p.family=AF_INET;p.prefixlen=24;inet_pton(AF_INET,"192.168
.2.0",&p.u.prefix4);vertices[vertex_count]=isis_vertex_new(&p,VTYPE_IPREACH_TE);
vertices[vertex_count]->d_N=20;vertex_count++;memset(node_id,0,sizeof(node_id));
node_id[6]=1;vertices[vertex_count]=isis_vertex_new(node_id,VTYPE_PSEUDO_TE_IS);
vertices[vertex_count]->d_N=15;vertex_count++;memset(node_id,0,sizeof(node_id));
node_id[5]=2;vertices[vertex_count]=isis_vertex_new(node_id,VTYPE_NONPSEUDO_TE_I
S);vertices[vertex_count]->d_N=15;vertex_count++;p.family=AF_INET;p.prefixlen=24
;inet_pton(AF_INET,"192.168.3.0",&p.u.prefix4);vertices[vertex_count]=isis_verte
x_new(&p,VTYPE_IPREACH_TE);vertices[vertex_count]->d_N=20;vertex_count++;};stati
cvoidcleanup_test_vertices(void){for(size_ti=0;i<vertex_count;i++)isis_vertex_de
l(vertices[i]);XFREE(MTYPE_TMP,vertices);vertex_count=0;}staticvoidtest_ordered(
void){structisis_vertex_queueq;isis_vertex_queue_init(&q,NULL,true);for(size_ti=
0;i<vertex_count;i++)isis_vertex_queue_insert(&q,vertices[i]);assert(isis_vertex
_queue_count(&q)==vertex_count);for(size_ti=0;i<vertex_count;i++){assert(isis_fi
nd_vertex(&q,vertices[i]->N.id,vertices[i]->type)==vertices[i]);}assert(isis_ver
tex_queue_pop(&q)==vertices[2]);assert(isis_find_vertex(&q,vertices[2]->N.id,ver
tices[2]->type)==NULL);assert(isis_vertex_queue_pop(&q)==vertices[3]);assert(isi
s_find_vertex(&q,vertices[3]->N.id,vertices[3]->type)==NULL);assert(isis_vertex_
queue_pop(&q)==vertices[0]);assert(isis_find_vertex(&q,vertices[0]->N.id,vertice
s[0]->type)==NULL);assert(isis_vertex_queue_pop(&q)==vertices[1]);assert(isis_fi
nd_vertex(&q,vertices[1]->N.id,vertices[1]->type)==NULL);isis_vertex_queue_delet
e(&q,vertices[4]);assert(isis_find_vertex(&q,vertices[4]->N.id,vertices[4]->type
)==NULL);assert(isis_vertex_queue_count(&q)==0);assert(isis_vertex_queue_pop(&q)
==NULL);isis_vertex_queue_free(&q);}intmain(intargc,char**argv){setup_test_verti
ces();test_ordered();cleanup_test_vertices();return0;}