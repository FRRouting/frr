interface lo
 ip address 192.168.0.3/32
 ipv6 address 3fff::192:168:0:3/128
!
interface eth-p1
 ip address 10.3.0.3/24
!
interface eth-pe1
 ip address 10.0.2.3/24
!
interface eth-pe4
 ip address 10.0.3.3/24
!
interface eth-ce5
 ip address 172.16.5.1/24
 ipv6 address 3fff:5::1/64
!
interface eth-ce6
 ip address 172.16.6.1/24
 ipv6 address 3fff:6::1/64
!
bfd
 profile BGP
  transmit-interval 2000
  receive-interval 2000
 exit
 !
exit
!
router bgp 65000
  bgp router-id 192.168.0.3
  no bgp ebgp-requires-policy
  bgp bestpath compare-routerid
  no bgp default ipv4-unicast
  neighbor IBGP4 peer-group
  neighbor IBGP4 remote-as 65000
  neighbor IBGP4 bfd profile BGP
  neighbor IBGP4 update-source 192.168.0.3
  neighbor 192.168.0.1 peer-group IBGP4
  neighbor 192.168.0.2 peer-group IBGP4
  neighbor 192.168.0.4 peer-group IBGP4
  neighbor 192.168.0.101 peer-group IBGP4
  neighbor 192.168.0.201 peer-group IBGP4
  neighbor IBGP6 peer-group
  neighbor IBGP6 remote-as 65000
  neighbor IBGP6 bfd profile BGP
  neighbor IBGP6 update-source  3fff::192:168:0:3
  neighbor 3fff::192:168:0:1 peer-group IBGP6
  neighbor 3fff::192:168:0:2 peer-group IBGP6
  neighbor 3fff::192:168:0:4 peer-group IBGP6
  neighbor 3fff::192:168:0:101 peer-group IBGP6
  neighbor 3fff::192:168:0:201 peer-group IBGP6
!
 address-family ipv4 unicast
   no neighbor IBGP4 activate
   no neighbor IBGP6 activate
  exit-address-family
!
  address-family ipv4 rt-constraint
   neighbor IBGP4 activate
   neighbor IBGP4 soft-reconfiguration inbound
  exit-address-family
!
  address-family ipv4 vpn
   neighbor IBGP4 activate
   neighbor IBGP4 soft-reconfiguration inbound
  exit-address-family
!
  address-family ipv6 vpn
   neighbor IBGP6 activate
   neighbor IBGP6 soft-reconfiguration inbound
  exit-address-family
!
router bgp 65000 vrf RED
 bgp router-id 192.168.0.3
 no bgp ebgp-requires-policy
 bgp bestpath compare-routerid
 neighbor 172.16.5.254 remote-as external
 neighbor 172.16.5.254 bfd profile BGP
 neighbor 3fff:5::ff remote-as external
 neighbor 3fff:5::ff bfd profile BGP
 !
 address-family ipv4 unicast
  label vpn export 100
  rd vpn export 65000:100
  rt vpn both 65000:100
  export vpn
  import vpn
  neighbor 172.16.5.254 next-hop-self
  no neighbor 3fff:5::ff activate
 exit-address-family
!
 address-family ipv6 unicast
  label vpn export 200
  rd vpn export 65000:100
  rt vpn both 65000:100
  export vpn
  import vpn
  neighbor 3fff:5::ff activate
  neighbor 3fff:5::ff next-hop-self
 exit-address-family
exit
!
router bgp 65000 vrf BLUE
 bgp router-id 192.168.0.3
 no bgp ebgp-requires-policy
 bgp bestpath compare-routerid
 neighbor 172.16.6.254 remote-as external
 neighbor 172.16.6.254 bfd profile BGP
 neighbor 3fff:6::ff remote-as external
 neighbor 3fff:6::ff bfd profile BGP
 !
 address-family ipv4 unicast
  label vpn export 101
  rd vpn export 65000:101
  rt vpn both 65000:101
  export vpn
  import vpn
  neighbor 172.16.6.254 next-hop-self
  no neighbor 3fff:6::ff activate
 exit-address-family
!
 address-family ipv6 unicast
  label vpn export 201
  rd vpn export 65000:101
  rt vpn both 65000:101
  export vpn
  import vpn
  neighbor 3fff:6::ff activate
  neighbor 3fff:6::ff next-hop-self
 exit-address-family
exit
!
interface lo
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
interface eth-p1
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
interface eth-pe1
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
interface eth-pe4
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
router isis 1
 lsp-gen-interval 2
 net 10.0000.0000.0000.0000.0000.0000.0000.0000.0003.00
 metric-style wide
 exit
!
mpls ldp
 router-id 192.168.0.3
 !
 address-family ipv4
  discovery transport-address 192.168.0.3
  !
  interface eth-p1
  interface eth-pe1
  interface eth-pe4
  !
 address-family ipv6
  discovery transport-address 3fff::192:168:0:3
  !
  interface eth-p1
  interface eth-pe1
  interface eth-pe4
  !
 !
!
