neighbor 192.168.0.162 {
router-id 192.168.0.160;
local-address 192.168.0.160;
local-as 100;
peer-as 100;
flow {
route {
match {
source 1.1.1.2/32;
destination 2.2.2.2.2/32;
dscp 36;
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
route {
match {
source 1.1.1.2/32;
destination 3.3.3.4/32;
fragment [ first-fragment ];
}
then {
redirect 50.0.0.2;
rate-limit 55;
#discard;
}
}
# TCP FIN
route {
match {
source 1.1.1.2/32;
destination 6.1.1.232/32;
tcp-flags [ syn ];
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
# TCP FIN
route {
match {
source 1.1.1.2/32;
destination 5.1.1.2/32;
icmp-type [ unreachable ];
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
# ICMP echo traffic unreachable
route {
match {
source 1.1.1.2/32;
destination 3.3.3.3/32;
icmp-type [ echo-reply];
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
# ICMP echo icmp type only
route {
match {
source 1.1.1.2/32;
destination 3.3.3.3/32;
destination-port =80;
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
# HTTP traffic to 3.3.3.3 is redirected
route {
match {
source 1.1.1.2/32;
destination 2.2.2.2/32;
destination-port >21&<24;
}
then {
redirect 11:22;
rate-limit 55;
}
}
#telnet and ssh traffic to 2.2.2.2 is redirected
route {
match {
source 1.1.1.2/32;
destination 2.2.2.2/32;
}
then {
discard;
}
}
#end route 3
route {
match {
destination 3.3.3.3/32;
destination-port >=179&<=200;
protocol tcp;
}
then {
redirect 50.0.0.2;
rate-limit 55;
}
}
# BGP traffic to 3.3.3.3 is redirected
route {
match {
source 1.1.1.2/32;
destination 3.3.3.3/32;
}
then {
discard;
}
}
#end route 4
}
}
