!
! r1 configuration - Top of the diamond
!
int lo
 ip address 11.11.11.11/32
!
int r1-eth0
 ip address 192.168.12.1/24
!
int r1-eth1
 ip address 192.168.13.1/24
!
router bgp 65001
 use-underlays-nexthop-weight
 no bgp ebgp-requires-policy
 bgp router-id 1.1.1.1
 bgp bestpath as-path multipath-relax
 neighbor 192.168.12.2 remote-as 65002
 neighbor 192.168.12.2 timers 1 3
 neighbor 192.168.12.2 timers connect 1
 neighbor 192.168.13.3 remote-as 65003
 neighbor 192.168.13.3 timers 1 3
 neighbor 192.168.13.3 timers connect 1
 neighbor 10.10.10.10 remote-as 65004
 neighbor 10.10.10.10 update-source lo
 neighbor 10.10.10.10 ebgp-multihop
 neighbor 10.10.10.10 timers 1 3
 neighbor 10.10.10.10 timers connect 1
 !
 address-family ipv4 unicast
  redistribute connected
  neighbor 192.168.12.2 activate
  neighbor 192.168.12.2 route-map FILTER-OUT out
  neighbor 192.168.13.3 activate
  neighbor 192.168.13.3 route-map FILTER-OUT out
  neighbor 10.10.10.10 activate
  neighbor 10.10.10.10 route-map ONLY-10-1-1-1 in
 exit-address-family
!
ip prefix-list BLOCK-10-1-1-1 deny 10.1.1.1/32
ip prefix-list BLOCK-10-1-1-1 permit any
!
ip prefix-list ONLY-10-1-1-1-PREFIX permit 10.1.1.1/32
!
route-map FILTER-OUT permit 10
 match ip address prefix-list BLOCK-10-1-1-1
exit
!
route-map ONLY-10-1-1-1 permit 10
 match ip address prefix-list ONLY-10-1-1-1-PREFIX
exit
!

