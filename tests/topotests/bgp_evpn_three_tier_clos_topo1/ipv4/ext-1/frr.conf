frr defaults datacenter
service integrated-vtysh-config
hostname ext-1
log syslog informational
!
interface lo
 description Loopback
 ip address 6.0.0.3/32
!
interface swp1
 description swp1 -> bordertor-11's swp3
 ip address 10.254.0.10/30
!
interface swp1.4001
 description VLAN 4001 - VRF1 L3VNI
 ip address 144.1.1.1/30
 ipv6 address 2144:1:1:1::1/64
!
interface swp1.4002
 description VLAN 4002 - VRF2 L3VNI
 ip address 144.1.1.5/30
 ipv6 address 2144:1:1:2::5/64
!
interface swp2
 description swp2 -> bordertor-12's swp3
 ip address 10.254.0.38/30
!
interface swp2.4001
 description VLAN 4001 - VRF1 L3VNI to bordertor-12
 ip address 144.2.1.1/30
 ipv6 address 2144:2:1:1::1/64
!
interface swp2.4002
 description VLAN 4002 - VRF2 L3VNI to bordertor-12
 ip address 144.2.1.5/30
 ipv6 address 2144:2:1:2::5/64
!
interface swp3
 description External Host Interface 1
 ip address 81.1.1.1/24
 ipv6 address 2081:1:1:1::1/64
!
interface swp4
 description External Host Interface 2
 ip address 81.1.2.1/24
 ipv6 address 2081:1:1:2::1/64
!
interface swp5
 description External Host Interface 3
 ip address 81.1.3.1/24
 ipv6 address 2081:1:1:3::1/64
!
interface swp6
 description External Host Interface 4
 ip address 81.1.4.1/24
 ipv6 address 2081:1:1:4::1/64
!
ip prefix-list EXT_HOSTS seq 1 permit 81.1.1.0/24
ip prefix-list EXT_HOSTS seq 2 permit 81.1.2.0/24
ip prefix-list EXT_HOSTS seq 3 permit 81.1.3.0/24
ip prefix-list EXT_HOSTS seq 4 permit 81.1.4.0/24
ip prefix-list EXT_HOSTS seq 5 deny any
!
ipv6 prefix-list EXT_HOSTS_v6 seq 1 permit 2081:1:1:1::/64
ipv6 prefix-list EXT_HOSTS_v6 seq 2 permit 2081:1:1:2::/64
ipv6 prefix-list EXT_HOSTS_v6 seq 3 permit 2081:1:1:3::/64
ipv6 prefix-list EXT_HOSTS_v6 seq 4 permit 2081:1:1:4::/64
ipv6 prefix-list EXT_HOSTS_v6 seq 5 deny any
!
route-map ALLOW_LOBR permit 10
 match interface lo
exit
!
route-map ALLOW_LOBR permit 20
 match interface br1
exit
!
route-map ALLOW_LO permit 10
 match interface lo
exit
!
route-map HOST_ALLOW permit 1
 match ip address prefix-list EXT_HOSTS
exit
!
route-map HOST_ALLOW_v6 permit 1
 match ipv6 address prefix-list EXT_HOSTS_v6
exit
!
router bgp 655000
 bgp router-id 6.0.0.3
 bgp bestpath as-path multipath-relax
 bgp bestpath compare-routerid
 neighbor 144.1.1.2 remote-as external
 neighbor 144.1.1.6 remote-as external
 neighbor 144.2.1.2 remote-as external
 neighbor 144.2.1.6 remote-as external
 !
 address-family ipv4 unicast
  neighbor 144.1.1.2 activate
  neighbor 144.1.1.6 activate
  neighbor 144.2.1.2 activate
  neighbor 144.2.1.6 activate
  redistribute connected route-map HOST_ALLOW
  redistribute static
  maximum-paths 16
 exit-address-family
 !
 address-family ipv6 unicast
  neighbor 144.1.1.2 activate
  neighbor 144.1.1.6 activate
  neighbor 144.2.1.2 activate
  neighbor 144.2.1.6 activate
  redistribute connected route-map HOST_ALLOW_v6
  redistribute static
  maximum-paths 16
 exit-address-family
exit
!
end
