frr version 8.5
frr defaults datacenter
service integrated-vtysh-config
hostname tor-22
log syslog informational
!
interface lo
 description Loopback
 ip address 6.0.0.31/32
!
interface swp1
 description swp1 -> leaf-21's swp4
 ip address 10.254.0.126/30
!
interface swp2
 description swp2 -> leaf-22's swp4
 ip address 10.254.0.142/30
!
interface vlan111
 description VLAN 111 SVI (L2VNI 1000111)
 ip address 60.1.1.22/24
 ipv6 address 2060:1:1:1::22/64
 vrf vrf2
!
interface vlan112
 description VLAN 112 SVI (L2VNI 1000112)
 ip address 50.1.1.22/24
 ipv6 address 2050:1:1:1::22/64
 vrf vrf1
!
vrf vrf1
 vni 104001
 ip route 72.22.1.0/24 blackhole
 ipv6 route 2001:22:1:1::/64 blackhole
!
vrf vrf2
 vni 104002
 ip route 73.22.1.0/24 blackhole
 ipv6 route 2003:22:1:1::/64 blackhole
!
route-map ALLOW_LOBR permit 10
 match interface lo
exit
!
route-map ALLOW_LOBR permit 20
 match interface br1
exit
!
route-map ALLOW_LO permit 10
 match interface lo
exit
!
router bgp 650031
 bgp router-id 6.0.0.31
 no bgp default ipv4-unicast
 neighbor 10.254.0.125 remote-as 651004
 neighbor 10.254.0.141 remote-as 651004
 !
 address-family ipv4 unicast
  neighbor 10.254.0.125 activate
  neighbor 10.254.0.141 activate
  redistribute connected route-map ALLOW_LOBR
 exit-address-family
 !
 address-family l2vpn evpn
  neighbor 10.254.0.125 activate
  neighbor 10.254.0.141 activate
  advertise-all-vni
 exit-address-family
!
router bgp 650031 vrf vrf1
 bgp router-id 6.0.0.31
 !
 address-family ipv4 unicast
  redistribute connected
  redistribute static
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
 exit-address-family
!
router bgp 650031 vrf vrf2
 bgp router-id 6.0.0.31
 !
 address-family ipv4 unicast
  redistribute connected
  redistribute static
 exit-address-family
 !
 address-family l2vpn evpn
  advertise ipv4 unicast
 exit-address-family
!
end
