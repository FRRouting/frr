mpls label dynamic-block 1000 1048575
!
interface lo
 ip address 192.168.0.5/32
 ipv6 address 3fff::192:168:0:5/128
!
interface eth-rr3
 ip address 10.0.15.5/24
!
interface eth-ce9
 ip address 172.16.9.1/24
 ipv6 address 3fff:9::1/64
!
interface eth-ce10
 ip address 172.16.10.1/24
 ipv6 address 3fff:10::1/64
!
interface eth-ce11
 ip address 172.16.11.1/24
 ipv6 address 3fff:11::1/64
!
router bgp 65001
  bgp router-id 192.168.0.5
  no bgp ebgp-requires-policy
  bgp bestpath compare-routerid
  no bgp default ipv4-unicast
  neighbor 192.168.0.103 remote-as 65001
  neighbor 192.168.0.103 bfd profile BGP
  neighbor 192.168.0.103 update-source 192.168.0.5
  neighbor 3fff::192:168:0:103 remote-as 65001
  neighbor 3fff::192:168:0:103 bfd profile BGP
  neighbor 3fff::192:168:0:103 update-source 3fff::192:168:0:5
!
 address-family ipv4 unicast
   no neighbor 192.168.0.103 activate
  exit-address-family
!
  address-family ipv4 rt-constraint
   neighbor 192.168.0.103 activate
   neighbor 192.168.0.103 soft-reconfiguration inbound
  exit-address-family
!
  address-family ipv4 vpn
   neighbor 192.168.0.103 activate
   neighbor 192.168.0.103 soft-reconfiguration inbound
  exit-address-family
!
  address-family ipv6 vpn
   neighbor 3fff::192:168:0:103 activate
   neighbor 3fff::192:168:0:103 soft-reconfiguration inbound
  exit-address-family
!
router bgp 65001 vrf RED
 bgp router-id 192.168.0.5
 no bgp ebgp-requires-policy
 bgp bestpath compare-routerid
 neighbor 172.16.9.254 remote-as external
 neighbor 172.16.9.254 bfd profile BGP
 neighbor 3fff:9::ff remote-as external
 neighbor 3fff:9::ff bfd profile BGP
 !
 address-family ipv4 unicast
  label vpn export 100
  rd vpn export 65000:100
  rt vpn both 65000:100
  export vpn
  import vpn
  neighbor 172.16.9.254 next-hop-self
  no neighbor 3fff:9::ff activate
 exit-address-family
!
 address-family ipv6 unicast
  label vpn export 200
  rd vpn export 65000:100
  rt vpn both 65000:100
  export vpn
  import vpn
  neighbor 3fff:9::ff activate
  neighbor 3fff:9::ff next-hop-self
 exit-address-family
exit
!
router bgp 65001 vrf BLUE
 bgp router-id 192.168.0.5
 no bgp ebgp-requires-policy
 bgp bestpath compare-routerid
 neighbor 172.16.10.254 remote-as external
 neighbor 172.16.10.254 bfd profile BGP
 neighbor 3fff:10::ff remote-as external
 neighbor 3fff:10::ff bfd profile BGP
 !
 address-family ipv4 unicast
  label vpn export 101
  rd vpn export 65000:101
  rt vpn both 65000:101
  export vpn
  import vpn
  neighbor 172.16.10.254 next-hop-self
  no neighbor 3fff:10::ff activate
 exit-address-family
!
 address-family ipv6 unicast
  label vpn export 201
  rd vpn export 65000:101
  rt vpn both 65000:101
  export vpn
  import vpn
  neighbor 3fff:10::ff activate
  neighbor 3fff:10::ff next-hop-self
 exit-address-family
exit
!
router bgp 65001 vrf ORANGE
 bgp router-id 192.168.0.5
 no bgp ebgp-requires-policy
 bgp bestpath compare-routerid
 neighbor 172.16.11.254 remote-as external
 neighbor 172.16.11.254 bfd profile BGP
 neighbor 3fff:11::ff remote-as external
 neighbor 3fff:11::ff bfd profile BGP
 !
 address-family ipv4 unicast
  label vpn export 103
  rd vpn export 65000:103
  rt vpn both 65000:103
  export vpn
  import vpn
  neighbor 172.16.11.254 next-hop-self
  no neighbor 3fff:11::ff activate
 exit-address-family
!
 address-family ipv6 unicast
  label vpn export 203
  rd vpn export 65000:103
  rt vpn both 65000:103
  export vpn
  import vpn
  neighbor 3fff:11::ff activate
  neighbor 3fff:11::ff next-hop-self
 exit-address-family
exit
!
mpls label dynamic-block 1000 1048575
!
interface lo
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
interface eth-rr3
 ip router isis 1
 isis hello-interval 2
 ipv6 router isis 1
!
router isis 1
 lsp-gen-interval 2
 net 10.0000.0000.0000.0000.0000.0000.0000.0000.0005.00
 metric-style wide
 exit
!
mpls ldp
 router-id 192.168.0.5
 !
 address-family ipv4
  discovery transport-address 192.168.0.5
  !
  interface eth-rr3
  !
 address-family ipv6
  discovery transport-address 3fff::192:168:0:5
  !
  interface eth-rr3
  !
 !
!
bfd
 profile BGP
  transmit-interval 2000
  receive-interval 2000
 exit
 !
exit
