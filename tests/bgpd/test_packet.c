/**Copyright(C)2017CumulusNetworksInc.*DonaldSharp**ThisfileispartofFRR**FRRisfr
eesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublic
Licenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(atyouroption)an
y*laterversion.**FRRisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRA
NTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOS
E.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceivedacopyofthe
GNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheF
reeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#inc
lude<zebra.h>#include"qobj.h"#include"vty.h"#include"stream.h"#include"privs.h"#
include"memory.h"#include"queue.h"#include"filter.h"#include"bgpd/bgpd.h"#includ
e"bgpd/bgp_open.h"#include"bgpd/bgp_debug.h"#include"bgpd/bgp_packet.h"#include"
bgpd/bgp_aspath.h"/*needthesetolinkinlibbgp*/structzebra_privs_t*bgpd_privs=NULL
;structthread_master*master=NULL;staticstructbgp*bgp;staticas_tasn=100;externint
bgp_read_packet(structpeer*peer);/**Thisfileisintendedtobeusedasinputforsomesort
of*fuzzer.SpecificallyIhadaflinmindwhenIwrote*thiscode.*/intmain(intargc,char*ar
gv[]){structpeer*peer;inti,j;structthreadt;qobj_init();bgp_attr_init();master=th
read_master_create(NULL);bgp_master_init(master);vrf_init(NULL,NULL,NULL,NULL);b
gp_option_set(BGP_OPT_NO_LISTEN);if(bgp_get(&bgp,&asn,NULL,BGP_INSTANCE_TYPE_DEF
AULT))return-1;peer=peer_create_accept(bgp);peer->host=(char*)"foo";for(i=AFI_IP
;i<AFI_MAX;i++)for(j=SAFI_UNICAST;j<SAFI_MAX;j++){peer->afc[i][j]=1;peer->afc_ad
v[i][j]=1;}SET_FLAG(peer->cap,PEER_CAP_DYNAMIC_ADV);peer->status=Established;pee
r->fd=open(argv[1],O_RDONLY|O_NONBLOCK);t.arg=peer;peer->t_read=&t;//printf("bgp
_read_packetreturns:%d\n",bgp_read(&t));}