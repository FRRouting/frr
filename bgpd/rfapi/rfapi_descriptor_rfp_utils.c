/***Copyright2009-2016,LabNConsulting,L.L.C.***Thisprogramisfreesoftware;youcanr
edistributeitand/or*modifyitunderthetermsoftheGNUGeneralPublicLicense*aspublishe
dbytheFreeSoftwareFoundation;eitherversion2*oftheLicense,or(atyouroption)anylate
rversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,*butWITHOUTANYWAR
RANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURP
OSE.Seethe*GNUGeneralPublicLicenseformoredetails.**Youshouldhavereceivedacopyoft
heGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetoth
eFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#i
nclude<errno.h>#include"lib/zebra.h"#include"lib/prefix.h"#include"lib/table.h"#
include"lib/vty.h"#include"lib/memory.h"#include"lib/log.h"#include"bgpd/bgpd.h"
#include"bgpd/rfapi/rfapi.h"#include"bgpd/rfapi/rfapi_private.h"#include"bgpd/rf
api/rfapi_descriptor_rfp_utils.h"#include"bgpd/rfapi/vnc_debug.h"void*rfapi_crea
te_generic(structrfapi_ip_addr*vn,structrfapi_ip_addr*un){structrfapi_descriptor
*rfd;rfd=XCALLOC(MTYPE_RFAPI_DESC,sizeof(structrfapi_descriptor));vnc_zlog_debug
_verbose("%s:rfd=%p",__func__,rfd);rfd->vn_addr=*vn;rfd->un_addr=*un;return(void
*)rfd;}/*------------------------------------------*rfapi_free_generic**Comparet
wogenericrfapidescriptors.**input:*grfd:rfapidescriptorreturnedbyrfapi_openorrfa
pi_create_generic**output:**returnvalue:**--------------------------------------
----*/voidrfapi_free_generic(void*grfd){structrfapi_descriptor*rfd;rfd=(structrf
api_descriptor*)grfd;XFREE(MTYPE_RFAPI_DESC,rfd);}/*----------------------------
--------------*rfapi_compare_rfds**Comparetwogenericrfapidescriptors.**input:*rf
d1:rfapidescriptorreturnedbyrfapi_openorrfapi_create_generic*rfd2:rfapidescripto
rreturnedbyrfapi_openorrfapi_create_generic**output:**returnvalue:*0Mismatch*1Ma
tch*------------------------------------------*/intrfapi_compare_rfds(void*rfd1,
void*rfd2){structrfapi_descriptor*rrfd1,*rrfd2;intmatch=0;rrfd1=(structrfapi_des
criptor*)rfd1;rrfd2=(structrfapi_descriptor*)rfd2;if(rrfd1->vn_addr.addr_family=
=rrfd2->vn_addr.addr_family){if(rrfd1->vn_addr.addr_family==AF_INET)match=IPV4_A
DDR_SAME(&(rrfd1->vn_addr.addr.v4),&(rrfd2->vn_addr.addr.v4));elsematch=IPV6_ADD
R_SAME(&(rrfd1->vn_addr.addr.v6),&(rrfd2->vn_addr.addr.v6));}/**IftheVNaddresses
don'tmatchinallforms,*giveup.*/if(!match)return0;/**dotheprocessagainfortheUNadd
resses.*/match=0;if(rrfd1->un_addr.addr_family==rrfd2->un_addr.addr_family){/*VN
addressesmatch*UNaddressfamiliesmatch*nowchecktheactualUNaddresses*/if(rrfd1->un
_addr.addr_family==AF_INET)match=IPV4_ADDR_SAME(&(rrfd1->un_addr.addr.v4),&(rrfd
2->un_addr.addr.v4));elsematch=IPV6_ADDR_SAME(&(rrfd1->un_addr.addr.v6),&(rrfd2-
>un_addr.addr.v6));}returnmatch;}