/***Copyright2009-2016,LabNConsulting,L.L.C.***Thisprogramisfreesoftware;youcanr
edistributeitand/or*modifyitunderthetermsoftheGNUGeneralPublicLicense*aspublishe
dbytheFreeSoftwareFoundation;eitherversion2*oftheLicense,or(atyouroption)anylate
rversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,*butWITHOUTANYWAR
RANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURP
OSE.Seethe*GNUGeneralPublicLicenseformoredetails.**Youshouldhavereceivedacopyoft
heGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetoth
eFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*//*
*File:rfapi_rib.h*Purpose:per-nverib*/#ifndefQUAGGA_HGP_RFAPI_RIB_H#defineQUAGGA
_HGP_RFAPI_RIB_H/**KeyforindexingRIBandPendingRIBskiplists.ForL3RIBs,*theVNaddre
ssissufficientbecauseitrepresentstheactualnexthop.**ForL2RIBs,itispossibletohave
multipleroutestoagivenL2*prefixviaagivenVNaddress,buteachroutehavingauniqueaux_p
refix.*/structrfapi_rib_key{structprefixvn;structprefix_rdrd;/**forL2routes:opti
onalIPaddr*.family==0means"none"*/structprefixaux_prefix;};#include"rfapi.h"/**R
FAPIAdvertisementDataBlock**HoldsNVEprefixadvertisementinformation*/structrfapi_
adb{union{struct{structprefixprefix_ip;structprefix_rdprd;structprefixprefix_eth
;}s;/*mainlyforlegacyuse*/structrfapi_rib_keykey;}u;uint32_tlifetime;uint8_tcost
;structrfapi_l2address_optionl2o;};structrfapi_info{structrfapi_rib_keyrk;/*NVEV
Naddr+auxaddr*/structprefixun;uint8_tcost;uint32_tlifetime;time_tlast_sent_time;
uint32_trsp_counter;/*dedupinitialresponses*/structbgp_tea_options*tea_options;s
tructrfapi_un_option*un_options;structrfapi_vn_option*vn_options;structthread*ti
mer;};/**Workitemforupdatedresponsesqueue*/structrfapi_updated_responses_queue{s
tructrfapi_descriptor*rfd;afi_tafi;};externvoidrfapiRibClear(structrfapi_descrip
tor*rfd);externvoidrfapiRibFree(structrfapi_descriptor*rfd);externvoidrfapiRibUp
datePendingNode(structbgp*bgp,structrfapi_descriptor*rfd,structrfapi_import_tabl
e*it,structroute_node*it_node,uint32_tlifetime);externvoidrfapiRibUpdatePendingN
odeSubtree(structbgp*bgp,structrfapi_descriptor*rfd,structrfapi_import_table*it,
structroute_node*it_node,structroute_node*omit_subtree,uint32_tlifetime);externi
ntrfapiRibPreloadBi(structroute_node*rfd_rib_node,structprefix*pfx_vn,structpref
ix*pfx_un,uint32_tlifetime,structbgp_info*bi);externstructrfapi_next_hop_entry*r
fapiRibPreload(structbgp*bgp,structrfapi_descriptor*rfd,structrfapi_next_hop_ent
ry*response,intuse_eth_resolution);externvoidrfapiRibPendingDeleteRoute(structbg
p*bgp,structrfapi_import_table*it,afi_tafi,structroute_node*it_node);externvoidr
fapiRibShowResponsesSummary(void*stream);externvoidrfapiRibShowResponsesSummaryC
lear(void);externvoidrfapiRibShowResponses(void*stream,structprefix*pfx_match,in
tshow_removed);externintrfapiRibFTDFilterRecentPrefix(structrfapi_descriptor*rfd
,structroute_node*it_rn,/*importtablenode*/structprefix*pfx_target_original);/*q
uerytarget*/externvoidrfapiFreeRfapiUnOptionChain(structrfapi_un_option*p);exter
nvoidrfapiFreeRfapiVnOptionChain(structrfapi_vn_option*p);externvoidrfapiRibChec
kCounts(intcheckstats,/*validaterfd&globalcounts*/unsignedintoffset);/*numberofr
i'sheldseparately*//*enablefordebugging;disableforperformance*/#if0#defineRFAPI_
RIB_CHECK_COUNTS(checkstats,offset)rfapiRibCheckCounts(checkstats,offset)#else#d
efineRFAPI_RIB_CHECK_COUNTS(checkstats,offset)#endifexternvoidrfapi_rib_key_init
(structprefix*prefix,/*maybeNULL*/structprefix_rd*rd,/*maybeNULL*/structprefix*a
ux,/*maybeNULL*/structrfapi_rib_key*rk);externintrfapi_rib_key_cmp(void*k1,void*
k2);externvoidrfapiAdbFree(structrfapi_adb*adb);#endif/*QUAGGA_HGP_RFAPI_RIB_H*/
