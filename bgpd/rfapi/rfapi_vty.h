/***Copyright2009-2016,LabNConsulting,L.L.C.***Thisprogramisfreesoftware;youcanr
edistributeitand/or*modifyitunderthetermsoftheGNUGeneralPublicLicense*aspublishe
dbytheFreeSoftwareFoundation;eitherversion2*oftheLicense,or(atyouroption)anylate
rversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,*butWITHOUTANYWAR
RANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURP
OSE.Seethe*GNUGeneralPublicLicenseformoredetails.**Youshouldhavereceivedacopyoft
heGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetoth
eFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#i
fndefRFAPI_VTY_H#defineRFAPI_VTY_H#include"lib/vty.h"typedefenum{SHOW_NVE_SUMMAR
Y_ACTIVE_NVES,SHOW_NVE_SUMMARY_UNKNOWN_NVES,/*legacy*/SHOW_NVE_SUMMARY_REGISTERE
D,SHOW_NVE_SUMMARY_QUERIES,SHOW_NVE_SUMMARY_RESPONSES,SHOW_NVE_SUMMARY_MAX}show_
nve_summary_t;#defineVNC_SHOW_STR"VNCinformation\n"externchar*rfapiFormatSeconds
(uint32_tseconds,char*buf,size_tlen);externchar*rfapiFormatAge(time_tage,char*bu
f,size_tlen);externvoidrfapiRprefixApplyMask(structrfapi_ip_prefix*rprefix);exte
rnintrfapiQprefix2Raddr(structprefix*qprefix,structrfapi_ip_addr*raddr);externvo
idrfapiQprefix2Rprefix(structprefix*qprefix,structrfapi_ip_prefix*rprefix);exter
nintrfapiRprefix2Qprefix(structrfapi_ip_prefix*rprefix,structprefix*qprefix);ext
ernintrfapiRaddr2Qprefix(structrfapi_ip_addr*hia,structprefix*pfx);externintrfap
iRprefixSame(structrfapi_ip_prefix*hp1,structrfapi_ip_prefix*hp2);externvoidrfap
iL2o2Qprefix(structrfapi_l2address_option*l2o,structprefix*pfx);externintrfapiSt
r2EthAddr(constchar*str,structethaddr*ea);externconstchar*rfapi_ntop(intaf,const
void*src,char*buf,socklen_tsize);externintrfapiDebugPrintf(void*dummy,constchar*
format,...);externintrfapiStream2Vty(void*stream,/*input*/int(**fp)(void*,constc
har*,...),/*output*/structvty**vty,/*output*/void**outstream,/*output*/constchar
**vty_newline);/*output*//*------------------------------------------*rfapiRfapi
IpAddr2Str**UIhelper:generatestringfromrfapi_ip_addr**input:*aIPv4/v6address**ou
tput*bufputstringhere*bufsizemaxspacetowrite**returnvalue:*NULLconversionfailed*
non-NULLpointertobuf--------------------------------------------*/externconstcha
r*rfapiRfapiIpAddr2Str(structrfapi_ip_addr*a,char*buf,intbufsize);externvoidrfap
iPrintRfapiIpAddr(void*stream,structrfapi_ip_addr*a);externvoidrfapiPrintRfapiIp
Prefix(void*stream,structrfapi_ip_prefix*p);voidrfapiPrintRd(structvty*vty,struc
tprefix_rd*prd);externvoidrfapiPrintAdvertisedInfo(structvty*vty,structrfapi_des
criptor*rfd,safi_tsafi,structprefix*p);externvoidrfapiPrintDescriptor(structvty*
vty,structrfapi_descriptor*rfd);externvoidrfapiPrintMatchingDescriptors(structvt
y*vty,structprefix*vn_prefix,structprefix*un_prefix);externvoidrfapiPrintAttrPtr
s(void*stream,structattr*attr);/**Parseanaddressandputintoastructprefix*/externi
ntrfapiCliGetPrefixAddr(structvty*vty,constchar*str,structprefix*p);externintrfa
piCliGetRfapiIpAddr(structvty*vty,constchar*str,structrfapi_ip_addr*hai);externv
oidrfapiPrintNhl(void*stream,structrfapi_next_hop_entry*next_hops);externchar*rf
apiMonitorVpn2Str(structrfapi_monitor_vpn*m,char*buf,intsize);externconstchar*rf
apiRfapiIpPrefix2Str(structrfapi_ip_prefix*p,char*buf,intbufsize);externvoidrfap
iShowItNode(void*stream,structroute_node*rn);externchar*rfapiEthAddr2Str(constst
ructethaddr*ea,char*buf,intbufsize);/*installvtycommands*/externvoidrfapi_vty_in
it(void);/*------------------------------------------*rfapiShowRemoteRegistratio
ns**UIhelper:producesthe"remote"portionoftheoutput*of"showvncregistrations".**in
put:*streampointertooutputstream*prefix_onlypointertoprefix.Ifnon-NULL,printonly
registrations*matchingthespecifiedprefix*show_expiringifnon-zero,showexpiringreg
istrations*show_localifnon-zero,showlocalregistrations*show_importedifnon-zero,s
howimportedregistrations**returnvalue:*0nothingprinted*>0somethingprinted-------
-------------------------------------*/externintrfapiShowRemoteRegistrations(voi
d*stream,structprefix*prefix_only,intshow_expiring,intshow_local,intshow_remote,
intshow_imported);/*------------------------------------------*rfapi_monitor_cou
nt**UIhelper:countnumberofactivemonitors**input:*handlerfapihandle(NULLtocountac
ross*allopenhandles)**output**returnvalue:*countofmonitors----------------------
----------------------*/externuint32_trfapi_monitor_count(rfapi_handle);externin
trfapiShowVncQueries(void*stream,structprefix*pfx_match);#endif