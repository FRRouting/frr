/**Copyright2015,LabNConsulting,L.L.C.**Thisprogramisfreesoftware;youcanredistri
buteitand/or*modifyitunderthetermsoftheGNUGeneralPublicLicense*aspublishedbytheF
reeSoftwareFoundation;eitherversion2*oftheLicense,or(atyouroption)anylaterversio
n.**Thisprogramisdistributedinthehopethatitwillbeuseful,*butWITHOUTANYWARRANTY;w
ithouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.See
the*GNUGeneralPublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGNUGe
neralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFreeSo
ftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifndef_Q
UAGGA_BGP_ENCAP_TYPES_H#define_QUAGGA_BGP_ENCAP_TYPES_H#include"bgpd/bgp_ecommun
ity.h"/*from*http://www.iana.org/assignments/bgp-parameters/bgp-parameters.xhtml
#tunnel-types*/typedefenum{BGP_ENCAP_TYPE_RESERVED=0,BGP_ENCAP_TYPE_L2TPV3_OVER_
IP=1,BGP_ENCAP_TYPE_GRE=2,BGP_ENCAP_TYPE_TRANSMIT_TUNNEL_ENDPOINT=3,BGP_ENCAP_TY
PE_IPSEC_IN_TUNNEL_MODE=4,BGP_ENCAP_TYPE_IP_IN_IP_TUNNEL_WITH_IPSEC_TRANSPORT_MO
DE=5,BGP_ENCAP_TYPE_MPLS_IN_IP_TUNNEL_WITH_IPSEC_TRANSPORT_MODE=6,BGP_ENCAP_TYPE
_IP_IN_IP=7,BGP_ENCAP_TYPE_VXLAN=8,BGP_ENCAP_TYPE_NVGRE=9,BGP_ENCAP_TYPE_MPLS=10
,/*NOTE:EncapSAFI&Attributenotused*/BGP_ENCAP_TYPE_MPLS_IN_GRE=11,BGP_ENCAP_TYPE
_VXLAN_GPE=12,BGP_ENCAP_TYPE_MPLS_IN_UDP=13,BGP_ENCAP_TYPE_PBB}bgp_encap_types;t
ypedefenum{BGP_ENCAP_SUBTLV_TYPE_ENCAPSULATION=1,BGP_ENCAP_SUBTLV_TYPE_PROTO_TYP
E=2,BGP_ENCAP_SUBTLV_TYPE_IPSEC_TA=3,BGP_ENCAP_SUBTLV_TYPE_COLOR=4,BGP_ENCAP_SUB
TLV_TYPE_REMOTE_ENDPOINT=6/*speculative,IANAassignmentTBD*/}bgp_encap_subtlv_typ
es;/**TunnelEncapsulationAttributesubtlvs*/structbgp_tea_subtlv_encap_l2tpv3_ove
r_ip{uint32_tsessionid;uint8_tcookie_length;uint8_tcookie[8];};structbgp_tea_sub
tlv_encap_gre_key{uint32_tgre_key;};structbgp_tea_subtlv_encap_pbb{uint32_tflag_
isid:1;uint32_tflag_vid:1;uint32_tisid:24;uint16_tvid:12;uint8_tmacaddr[6];};str
uctbgp_tea_subtlv_proto_type{uint16_tproto;/*ether-type*/};structbgp_tea_subtlv_
color{uint32_tcolor;};/*perdraft-rosen-idr-tunnel-encaps*/structbgp_tea_subtlv_r
emote_endpoint{uint8_tfamily;/*IPv4orIPv6*/union{structin_addrv4;structin6_addrv
6;}ip_address;as_tas4;/*always4bytes*/};/**Thisisthelengthofthevaluepartoftheips
ectunnelauthenticator*subtlv.Currentlyweonlysupportthelengthforauthenticatortype
1.*/#defineBGP_ENCAP_SUBTLV_IPSEC_TA_SIZE20structbgp_tea_subtlv_ipsec_ta{uint16_
tauthenticator_type;/*onlytype1issupportedsofar*/uint8_tauthenticator_length;/*o
ctetsinvaluefield*/uint8_tvalue[BGP_ENCAP_SUBTLV_IPSEC_TA_SIZE];};/**Subtlvvalid
flags*TBDchangenamestoadd"VALID"*/#defineBGP_TEA_SUBTLV_ENCAP0x00000001#defineBG
P_TEA_SUBTLV_PROTO_TYPE0x00000002#defineBGP_TEA_SUBTLV_COLOR0x00000004#defineBGP
_TEA_SUBTLV_IPSEC_TA0x00000008#defineBGP_TEA_SUBTLV_REMOTE_ENDPOINT0x00000010#de
fineCHECK_SUBTLV_FLAG(ptr,flag)CHECK_FLAG((ptr)->valid_subtlvs,(flag))#defineSET
_SUBTLV_FLAG(ptr,flag)SET_FLAG((ptr)->valid_subtlvs,(flag))#defineUNSET_SUBTLV_F
LAG(ptr,flag)UNSET_FLAG((ptr)->valid_subtlvs,(flag))/**TunnelType-specificAPIs*/
structbgp_encap_type_reserved{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote_
endpointst_endpoint;/*optional*/};structbgp_encap_type_l2tpv3_over_ip{uint32_tva
lid_subtlvs;structbgp_tea_subtlv_encap_l2tpv3_over_ipst_encap;structbgp_tea_subt
lv_proto_typest_proto;/*optional*/structbgp_tea_subtlv_colorst_color;/*optional*
/structbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*/};structbgp_encap_t
ype_gre{uint32_tvalid_subtlvs;structbgp_tea_subtlv_encap_gre_keyst_encap;/*optio
nal*/structbgp_tea_subtlv_proto_typest_proto;/*optional*/structbgp_tea_subtlv_co
lorst_color;/*optional*/structbgp_tea_subtlv_remote_endpointst_endpoint;/*option
al*/};structbgp_encap_type_ip_in_ip{uint32_tvalid_subtlvs;structbgp_tea_subtlv_p
roto_typest_proto;/*optional*/structbgp_tea_subtlv_colorst_color;/*optional*/str
uctbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*/};structbgp_encap_type_
transmit_tunnel_endpoint{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote_endpo
intst_endpoint;/*optional*//*Nosubtlvsdefinedinspec?*/};structbgp_encap_type_ips
ec_in_tunnel_mode{uint32_tvalid_subtlvs;structbgp_tea_subtlv_ipsec_tast_ipsec_ta
;/*optional*/structbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*/};struc
tbgp_encap_type_ip_in_ip_tunnel_with_ipsec_transport_mode{uint32_tvalid_subtlvs;
structbgp_tea_subtlv_ipsec_tast_ipsec_ta;/*optional*/structbgp_tea_subtlv_remote
_endpointst_endpoint;/*optional*/};structbgp_encap_type_mpls_in_ip_tunnel_with_i
psec_transport_mode{uint32_tvalid_subtlvs;structbgp_tea_subtlv_ipsec_tast_ipsec_
ta;/*optional*/structbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*/};#de
fineVXLAN_ENCAP_MASK_VNID_VALID0x80000000#defineVXLAN_ENCAP_MASK_MAC_VALID0x4000
0000structbgp_encap_type_vxlan{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote
_endpointst_endpoint;/*optional*//*draft-ietf-idr-tunnel-encaps-02*/uint32_tvnid
;/*doesnotincludeVandMbit*/uint8_t*mac_address;/*optional*/};structbgp_encap_typ
e_nvgre{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote_endpointst_endpoint;/*
optional*//*Nosubtlvsdefinedinspec?*/};structbgp_encap_type_mpls{uint32_tvalid_s
ubtlvs;structbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*//*Nosubtlvsde
finedinspec?*/};structbgp_encap_type_mpls_in_gre{uint32_tvalid_subtlvs;structbgp
_tea_subtlv_remote_endpointst_endpoint;/*optional*//*Nosubtlvsdefinedinspec?*/};
structbgp_encap_type_vxlan_gpe{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote
_endpointst_endpoint;/*optional*//*Nosubtlvsdefinedinspec?*/};structbgp_encap_ty
pe_mpls_in_udp{uint32_tvalid_subtlvs;structbgp_tea_subtlv_remote_endpointst_endp
oint;/*optional*//*Nosubtlvsdefinedinspec?*/};structbgp_encap_type_pbb{uint32_tv
alid_subtlvs;structbgp_tea_subtlv_remote_endpointst_endpoint;/*optional*/structb
gp_tea_subtlv_encap_pbbst_encap;};staticinlinevoidencode_encap_extcomm(bgp_encap
_typestnl_type,structecommunity_val*eval){memset(eval,0,sizeof(*eval));eval->val
[0]=ECOMMUNITY_ENCODE_OPAQUE;eval->val[1]=ECOMMUNITY_OPAQUE_SUBTYPE_ENCAP;eval->
val[6]=((tnl_type)>>8)&0xff;eval->val[7]=(tnl_type)&0xff;}#endif/*_QUAGGA_BGP_EN
CAP_TYPES_H*/