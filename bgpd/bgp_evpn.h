/*E-VPNheaderforpackethandling*Copyright(C)20166WIND**ThisfileispartofFRRouting.
**FRRoutingisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheG
NUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(
atyouroption)any*laterversion.**FRRoutingisdistributedinthehopethatitwillbeusefu
l,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNES
SFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldh
avereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPY
ING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,
MA02110-1301USA*/#ifndef_QUAGGA_BGP_EVPN_H#define_QUAGGA_BGP_EVPN_H#include"vxla
n.h"#include"bgpd.h"#defineEVPN_ROUTE_STRLEN200/*Mustbe>>MAC+IPv6strings.*/stati
cinlineintis_evpn_enabled(void){structbgp*bgp=NULL;bgp=bgp_get_default();returnb
gp?bgp->advertise_all_vni:0;}staticinlinevoidvni2label(vni_tvni,mpls_label_t*lab
el){uint8_t*tag=(uint8_t*)label;tag[0]=(vni>>16)&0xFF;tag[1]=(vni>>8)&0xFF;tag[2
]=vni&0xFF;}staticinlinevni_tlabel2vni(mpls_label_t*label){uint8_t*tag=(uint8_t*
)label;vni_tvni;vni=((uint32_t)*tag++<<16);vni|=(uint32_t)*tag++<<8;vni|=(uint32
_t)(*tag&0xFF);returnvni;}staticinlineintadvertise_type5_routes(structbgp*bgp_vr
f,afi_tafi){if(!bgp_vrf->l3vni)return0;if(afi==AFI_IP&&CHECK_FLAG(bgp_vrf->af_fl
ags[AFI_L2VPN][SAFI_EVPN],BGP_L2VPN_EVPN_ADVERTISE_IPV4_UNICAST))return1;if(afi=
=AFI_IP6&&CHECK_FLAG(bgp_vrf->af_flags[AFI_L2VPN][SAFI_EVPN],BGP_L2VPN_EVPN_ADVE
RTISE_IPV6_UNICAST))return1;return0;}externvoidbgp_evpn_advertise_type5_route(st
ructbgp*bgp_vrf,structprefix*p,structattr*src_attr,afi_tafi,safi_tsafi);externvo
idbgp_evpn_withdraw_type5_route(structbgp*bgp_vrf,structprefix*p,afi_tafi,safi_t
safi);externvoidbgp_evpn_withdraw_type5_routes(structbgp*bgp_vrf,afi_tafi,safi_t
safi);externvoidbgp_evpn_advertise_type5_routes(structbgp*bgp_vrf,afi_tafi,safi_
tsafi);externvoidbgp_evpn_vrf_delete(structbgp*bgp_vrf);externvoidbgp_evpn_handl
e_router_id_update(structbgp*bgp,intwithdraw);externchar*bgp_evpn_label2str(mpls
_label_t*label,uint32_tnum_labels,char*buf,intlen);externchar*bgp_evpn_route2str
(structprefix_evpn*p,char*buf,intlen);externvoidbgp_evpn_route2json(structprefix
_evpn*p,json_object*json);externvoidbgp_evpn_encode_prefix(structstream*s,struct
prefix*p,structprefix_rd*prd,mpls_label_t*label,uint32_tnum_labels,structattr*at
tr,intaddpath_encode,uint32_taddpath_tx_id);externintbgp_nlri_parse_evpn(structp
eer*peer,structattr*attr,structbgp_nlri*packet,intwithdraw);externintbgp_evpn_im
port_route(structbgp*bgp,afi_tafi,safi_tsafi,structprefix*p,structbgp_info*ri);e
xternintbgp_evpn_unimport_route(structbgp*bgp,afi_tafi,safi_tsafi,structprefix*p
,structbgp_info*ri);externintbgp_filter_evpn_routes_upon_martian_nh_change(struc
tbgp*bgp);externintbgp_evpn_local_macip_del(structbgp*bgp,vni_tvni,structethaddr
*mac,structipaddr*ip);externintbgp_evpn_local_macip_add(structbgp*bgp,vni_tvni,s
tructethaddr*mac,structipaddr*ip,uint8_tflags);externintbgp_evpn_local_l3vni_add
(vni_tvni,vrf_id_tvrf_id,structethaddr*rmac,structin_addroriginator_ip,intfilter
);externintbgp_evpn_local_l3vni_del(vni_tvni,vrf_id_tvrf_id);externintbgp_evpn_l
ocal_vni_del(structbgp*bgp,vni_tvni);externintbgp_evpn_local_vni_add(structbgp*b
gp,vni_tvni,structin_addroriginator_ip,vrf_id_ttenant_vrf_id);externvoidbgp_evpn
_cleanup_on_disable(structbgp*bgp);externvoidbgp_evpn_cleanup(structbgp*bgp);ext
ernvoidbgp_evpn_init(structbgp*bgp);#endif/*_QUAGGA_BGP_EVPN_H*/