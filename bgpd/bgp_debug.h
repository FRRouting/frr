/*BGPmessagedebugheader.*Copyright(C)1996,97,98KunihiroIshiguro**Thisfileisparto
fGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*underthete
rmsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherver
sion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopethatitwil
lbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITY
orFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Yo
ushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethe
fileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor
,Boston,MA02110-1301USA*/#ifndef_QUAGGA_BGP_DEBUG_H#define_QUAGGA_BGP_DEBUG_H#in
clude"bgp_attr.h"#include"bgp_updgrp.h"/*sortofpacketdirection*/#defineDUMP_ON1#
defineDUMP_SEND2#defineDUMP_RECV4/*fordump_update*/#defineDUMP_WITHDRAW8#defineD
UMP_NLRI16/*dumpdetail*/#defineDUMP_DETAIL32/*RD+Prefix+Path-Id*/#defineBGP_PRD_
PATH_STRLEN(PREFIX_STRLEN+RD_ADDRSTRLEN+20)externintdump_open;externintdump_upda
te;externintdump_keepalive;externintdump_notify;externintDebug_Event;externintDe
bug_Keepalive;externintDebug_Update;externintDebug_Radix;#defineNLRI1#defineWITH
DRAW2#defineNO_OPT3#defineSEND4#defineRECV5#defineDETAIL6/*Prototypes.*/externvo
idbgp_debug_init(void);externvoidbgp_packet_dump(structstream*);externintdebug(u
nsignedintoption);externunsignedlongconf_bgp_debug_as4;externunsignedlongconf_bg
p_debug_neighbor_events;externunsignedlongconf_bgp_debug_packet;externunsignedlo
ngconf_bgp_debug_keepalive;externunsignedlongconf_bgp_debug_update;externunsigne
dlongconf_bgp_debug_bestpath;externunsignedlongconf_bgp_debug_zebra;externunsign
edlongconf_bgp_debug_allow_martians;externunsignedlongconf_bgp_debug_nht;externu
nsignedlongconf_bgp_debug_update_groups;externunsignedlongconf_bgp_debug_vpn;ext
ernunsignedlongconf_bgp_debug_flowspec;externunsignedlongterm_bgp_debug_as4;exte
rnunsignedlongterm_bgp_debug_neighbor_events;externunsignedlongterm_bgp_debug_pa
cket;externunsignedlongterm_bgp_debug_keepalive;externunsignedlongterm_bgp_debug
_update;externunsignedlongterm_bgp_debug_bestpath;externunsignedlongterm_bgp_deb
ug_zebra;externunsignedlongterm_bgp_debug_allow_martians;externunsignedlongterm_
bgp_debug_nht;externunsignedlongterm_bgp_debug_update_groups;externunsignedlongt
erm_bgp_debug_vpn;externunsignedlongterm_bgp_debug_flowspec;externstructlist*bgp
_debug_neighbor_events_peers;externstructlist*bgp_debug_keepalive_peers;externst
ructlist*bgp_debug_update_in_peers;externstructlist*bgp_debug_update_out_peers;e
xternstructlist*bgp_debug_update_prefixes;externstructlist*bgp_debug_bestpath_pr
efixes;externstructlist*bgp_debug_zebra_prefixes;structbgp_debug_filter{char*hos
t;structprefix*p;};#defineBGP_DEBUG_AS40x01#defineBGP_DEBUG_AS4_SEGMENT0x02#defi
neBGP_DEBUG_BESTPATH0x01#defineBGP_DEBUG_NEIGHBOR_EVENTS0x01#defineBGP_DEBUG_PAC
KET0x01#defineBGP_DEBUG_KEEPALIVE0x01#defineBGP_DEBUG_UPDATE_IN0x01#defineBGP_DE
BUG_UPDATE_OUT0x02#defineBGP_DEBUG_UPDATE_PREFIX0x04#defineBGP_DEBUG_ZEBRA0x01#d
efineBGP_DEBUG_ALLOW_MARTIANS0x01#defineBGP_DEBUG_NHT0x01#defineBGP_DEBUG_UPDATE
_GROUPS0x01#defineBGP_DEBUG_VPN_LEAK_FROM_VRF0x01#defineBGP_DEBUG_VPN_LEAK_TO_VR
F0x02#defineBGP_DEBUG_VPN_LEAK_RMAP_EVENT0x04#defineBGP_DEBUG_VPN_LEAK_LABEL0x08
#defineBGP_DEBUG_FLOWSPEC0x01#defineBGP_DEBUG_PACKET_SEND0x01#defineBGP_DEBUG_PA
CKET_SEND_DETAIL0x02#defineCONF_DEBUG_ON(a,b)(conf_bgp_debug_##a|=(BGP_DEBUG_##b
))#defineCONF_DEBUG_OFF(a,b)(conf_bgp_debug_##a&=~(BGP_DEBUG_##b))#defineTERM_DE
BUG_ON(a,b)(term_bgp_debug_##a|=(BGP_DEBUG_##b))#defineTERM_DEBUG_OFF(a,b)(term_
bgp_debug_##a&=~(BGP_DEBUG_##b))#defineDEBUG_ON(a,b)\do{\CONF_DEBUG_ON(a,b);\TER
M_DEBUG_ON(a,b);\}while(0)#defineDEBUG_OFF(a,b)\do{\CONF_DEBUG_OFF(a,b);\TERM_DE
BUG_OFF(a,b);\}while(0)#defineBGP_DEBUG(a,b)(term_bgp_debug_##a&BGP_DEBUG_##b)#d
efineCONF_BGP_DEBUG(a,b)(conf_bgp_debug_##a&BGP_DEBUG_##b)externconstchar*bgp_ty
pe_str[];externconstchar*pmsi_tnltype_str[];externintbgp_dump_attr(structattr*,c
har*,size_t);externintbgp_debug_peer_updout_enabled(char*host);externconstchar*b
gp_notify_code_str(char);externconstchar*bgp_notify_subcode_str(char,char);exter
nvoidbgp_notify_print(structpeer*,structbgp_notify*,constchar*);externconststruc
tmessagebgp_status_msg[];externintbgp_debug_neighbor_events(structpeer*peer);ext
ernintbgp_debug_keepalive(structpeer*peer);externintbgp_debug_update(structpeer*
peer,structprefix*p,structupdate_group*updgrp,unsignedintinbound);externintbgp_d
ebug_bestpath(structprefix*p);externintbgp_debug_zebra(structprefix*p);externint
bgp_debug_count(void);externconstchar*bgp_debug_rdpfxpath2str(afi_t,safi_t,struc
tprefix_rd*,unionprefixconstptr,mpls_label_t*,uint32_t,int,uint32_t,char*,int);c
onstchar*bgp_notify_admin_message(char*buf,size_tbufsz,uint8_t*data,size_tdatale
n);#endif/*_QUAGGA_BGP_DEBUG_H*/