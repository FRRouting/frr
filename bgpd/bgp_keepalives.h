/*BGPKeepalives.*ImplementsaproducerthreadtogenerateBGPkeepalivesforpeers.*Copyr
ight(C)2017CumulusNetworks,Inc.*QuentinYoung**ThisfileispartofFRRouting.**FRRout
ingisfreesoftware;youcanredistributeitand/ormodifyitunder*thetermsoftheGNUGenera
lPublicLicenseaspublishedbytheFree*SoftwareFoundation;eitherversion2,or(atyourop
tion)anylater*version.**FRRoutingisdistributedinthehopethatitwillbeuseful,butWIT
HOUTANY*WARRANTY;withouteventheimpliedwarrantyofMERCHANTABILITYorFITNESS*FORAPAR
TICULARPURPOSE.SeetheGNUGeneralPublicLicenseformore*details.**Youshouldhaverecei
vedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifno
t,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-
1301USA*/#ifndef_FRR_BGP_KEEPALIVES_H#define_FRR_BGP_KEEPALIVES_H#include"frr_pt
hread.h"#include"bgpd.h"/***Turnsonkeepalivesforapeer.**Thisfunctionaddsthepeert
oaninternallistofpeerstogenerate*keepalivesfor.**Atsetintervals,aBGPKEEPALIVEpac
ketisgeneratedandplacedon*peer->obuf.Thisoperationisthread-safewithrespecttopeer
->obuf.**peer->v_keepalivedeterminestheinterval.Changingthisvaluebefore*unregist
eringthispeerwithbgp_keepalives_off()resultsinundefined*behavior.**Ifthepeerisal
readyregisteredforkeepalivesviathisfunction,nothing*happens.*/externvoidbgp_keep
alives_on(structpeer*);/***Turnsoffkeepalivesforapeer.**Removesthepeerfromtheint
ernallistofpeerstogeneratekeepalivesfor.**Ifthepeerisalreadyunregisteredforkeepa
lives,nothinghappens.*/externvoidbgp_keepalives_off(structpeer*);/***Pre-runinit
ializationfunctionforkeepalivespthread.**Initializessynchronizationprimitives.Th
isshouldbecalledbefore*anythingelsetoavoidraceconditions.*/externvoidbgp_keepali
ves_init(void);/***Entryfunctionforkeepalivespthread.**Thisfunctionloopsoveranin
ternallistofpeers,generatingkeepalivesat*regularintervalsasdeterminedbyeachpeer'
skeepalivetimer.**Seebgp_keepalives_on()foradditionaldetails.**@paramargpthreada
rg,notused*/externvoid*bgp_keepalives_start(void*arg);/***Pokingfunctionforkeepa
livespthread.**Undernormalcircumstancesthepthreadwillautomaticallywakeitself*whe
neveritisnecessarytodowork.Thisfunctionmaybeusedtoforcethe*threadtowakeupandseei
fthereisanyworktodo,orifitistimeto*die.**Itisnotnecessarytocallthisafterbgp_keep
alives_on().*/externvoidbgp_keepalives_wake(void);/***Stopsthethreadandblocksunt
ilitterminates.*/intbgp_keepalives_stop(structfrr_pthread*fpt,void**result);#end
if/*_FRR_BGP_KEEPALIVES_H*/