/*BGPI/O.*ImplementspacketI/Oinapthread.*Copyright(C)2017CumulusNetworks*Quentin
Young**Thisprogramisfreesoftware;youcanredistributeitand/ormodify*itundertheterm
softheGNUGeneralPublicLicenseaspublishedby*theFreeSoftwareFoundation;eitherversi
on2oftheLicense,or*(atyouroption)anylaterversion.**Thisprogramisdistributedinthe
hopethatitwillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*ME
RCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformor
edetails.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicense*alongwiththisp
rogram;seethefileCOPYING;ifnot,writetothe*FreeSoftwareFoundation,Inc.,51Franklin
St,FifthFloor,Boston,*MA02110-1301USA*/#ifndef_FRR_BGP_IO_H#define_FRR_BGP_IO_H#
defineBGP_WRITE_PACKET_MAX10U#defineBGP_READ_PACKET_MAX10U#include"bgpd/bgpd.h"#
include"frr_pthread.h"/***Startfunctionforwritethread.**@paramarg-unused*/extern
void*bgp_io_start(void*arg);/***Startfunctionforwritethread.**Uninitializesallre
sourcesandstopsthethread.**@paramresult-wheretostoredataresult,unused*/externint
bgp_io_stop(void**result,structfrr_pthread*fpt);/***Turnsonpacketwritingforapeer
.**Afterthisfunctioniscalled,anypacketsplacedonpeer->obufwillbe*writtentopeer->f
duntilnomorepacketsremain.**Additionally,itbecomesunsafetoperformsocketactionson
peer->fd.**@parampeer-peertoregister*/externvoidbgp_writes_on(structpeer*peer);/
***Turnsoffpacketwritingforapeer.**Afterthisfunctionreturns,packetsplacedonpeer-
>obufwillnotbe*writtentopeer->fdbytheI/Othread.**Afterthisfunctionreturnsitbecom
essafetoperformsocketactionson*peer->fd.**@parampeer-peertoderegister*@paramflus
h-asdescribed*/externvoidbgp_writes_off(structpeer*peer);/***Turnsonpacketreadin
gforapeer.**Afterthisfunctioniscalled,anypacketsreceivedonpeer->fdwillberead*and
copiedintotheFIFOqueuepeer->ibuf.**Additionally,itbecomesunsafetoperformsocketac
tionsonpeer->fd.**Wheneveroneormorepacketsareplacedontopeer->ibuf,ataskoftype*TH
READ_EVENTwillbeplacedonthemainthreadwhosehandleris**bgp_packet.c:bgp_process_pa
cket()**@parampeer-peertoregister*/externvoidbgp_reads_on(structpeer*peer);/***T
urnsoffpacketreadingforapeer.**Afterthisfunctioniscalled,anypacketsreceivedonpee
r->fdwillnotbe*readbytheI/Othread.**Afterthisfunctionreturnsitbecomessafetoperfo
rmsocketactionson*peer->fd.**@parampeer-peertoderegister*/externvoidbgp_reads_of
f(structpeer*peer);#endif/*_FRR_BGP_IO_H*/