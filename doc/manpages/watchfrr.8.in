.\" This file was originally generated by help2man 1.36.
.TH WATCHFRR 8 "July 2010"
.SH NAME
watchfrr \- a program to monitor the status of frr daemons
.SH SYNOPSIS
.B watchfrr
.RI [ option ...]
.IR daemon ...
.br
.B watchfrr
.BR \-h " | " \-v
.SH DESCRIPTION
.B watchfrr
is a watchdog program that monitors the status of supplied frr
.IR daemon s
and tries to restart them in case they become unresponsive or shut down.
.PP
To determine whether a daemon is running, it tries to connect to the
daemon's VTY UNIX stream socket, and send echo commands to ensure the
daemon responds. When the daemon crashes, EOF is received from the socket,
so that watchfrr can react immediately.
.PP
In order to avoid restarting the daemons in quick succession, you can
supply the
.B \-m
and
.B \-M
options to set the minimum and maximum delay between the restart commands.
The minimum restart delay is recalculated each time a restart is attempted.
If the time since the last restart attempt exceeds twice the value of
.BR  \-M ,
the restart delay is set to the value of
.BR \-m ,
otherwise the interval is doubled (but capped at the value of
.BR \-M ).
.SH OPTIONS
The following 3 options specify scripts that
.B watchfrr
uses to perform start/stop/restart actions.  These options are mandatory
unless the
.B --dry
option is used:
.TP
.BI \-s " command" "\fR, \fB\-\-start\-command " command
Supply a Bourne shell
.I command
to start a single daemon. The command string should contain the '%s'
placeholder to be substituted with the daemon name.
.TP
.BI \-k " command" "\fR, \fB\-\-kill\-command " command
Supply a Bourne shell
.I command
to stop a single daemon. The command string should contain the '%s'
placeholder to be substituted with the daemon name.
.TP
.BI \-r " command" "\fR, \fB\-\-restart " command
Supply a Bourne shell
.I command
to restart a single daemon. The command string should contain the '%s'
placeholder to be substituted with the daemon name.
.PP
Other options:
.TP
.BI \-\-dry
Run watchfrr in "dry-run" mode, only monitoring the specified daemons but not
performing any start/stop/restart actions.
.TP
.BR \-d ", " \-\-daemon
Run in daemon mode. When supplied, error messages are sent to Syslog
instead of standard output (stdout).
.TP
.BI \-S " directory" "\fR, \fB\-\-statedir " directory
Set the VTY socket
.I directory
(the default value is "/var/run/frr").
.TP
.BI \-l " level" "\fR, \fB\-\-loglevel " level
Set the logging
.I level
(the default value is "6"). The value should range from 0 (LOG_EMERG) to 7
(LOG_DEBUG), but higher number can be supplied if extra debugging messages
are required.
.TP
.BI \-\-min\-restart\-interval " number
Set the minimum
.I number
of seconds to wait between invocations of the daemon restart commands (the
default value is "60").
.TP
.BI \-\-max\-restart\-interval " number
Set the maximum
.I number
of seconds to wait between invocations of the daemon restart commands (the
default value is "600").
.TP
.BI \-i " number" "\fR, \fB\-\-interval " number
Set the status polling interval in seconds (the default value is "5").
.TP
.BI \-t " number" "\fR, \fB\-\-timeout " number
Set the unresponsiveness timeout in seconds (the default value is "10").
.TP
.BI \-T " number" "\fR, \fB\-\-restart\-timeout " number
Set the restart (kill) timeout in seconds (the default value is "20"). If
any background jobs are still running after this period has elapsed, they
will be killed.
.TP
.BI \-p " filename" "\fR, \fB\-\-pid\-file " filename
Set the process identifier
.I filename
(the default value is "/var/run/frr/watchfrr.pid").
.TP
.BI \-b " string" "\fR, \fB\-\-blank\-string " string
When the supplied
.I string
is found in any of the command line option arguments (i.e.,
.BR \-r ,
.BR \-s ,
or
.BR \-k ),
replace it with a space.
.IP
This is an ugly hack to circumvent problems with passing the command line
arguments containing embedded spaces.
.TP
.BR \-v ", " \-\-version
Display the version information and exit.
.TP
.BR \-h ", " \-\-help
Display the usage information and exit.
.SH PREVIOUS OPTIONS
Prior versions of \fBwatchfrr\fR supported some additional options that no
longer exist:
.IP
.BR \-a ,\  \-A ,\  \-e ,\  \-R ,\  \-z
.PP
The \fB-a\fR, \fB-A\fR and \fB-R\fR options were used to select alternate
monitoring modes that offered different patterns of restarting daemons.  The
"correct" mode (phased restart) is now the default. The \fB-e\fR and \fB-z\fR
options used to disable some monitoring aspects, watchfrr now always has all
monitoring features enabled.
.PP
Removing these options should result in correct operation, if it does not
please file a bug report.
.SH SEE ALSO
.BR zebra (8),
.BR bgpd (8),
.BR isisd (8),
.BR ospfd (8),
.BR ospf6d (8),
.BR ripd (8),
.BR ripngd (8)
.PP
See the project homepage at <@PACKAGE_URL@>.
.SH AUTHORS
Copyright 2004 Andrew J. Schorr
