/**IS-ISRout(e)ingprotocol-isis_adjacency.h*IS-ISadjacencyhandling**Copyright(C)
2001,2002SampoSaaristo*TampereUniversityofTechnology*InstituteofCommunicationsEn
gineering***Thisprogramisfreesoftware;youcanredistributeitand/ormodifyit*underth
etermsoftheGNUGeneralPublicLicenseaspublishedbytheFree*SoftwareFoundation;either
version2oftheLicense,or(atyouroption)*anylaterversion.**Thisprogramisdistributed
inthehopethatitwillbeuseful,butWITHOUT*ANYWARRANTY;withouteventheimpliedwarranty
ofMERCHANTABILITYor*FITNESSFORAPARTICULARPURPOSE.SeetheGNUGeneralPublicLicensefo
r*moredetails.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*with
thisprogram;seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51Fra
nklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifndef_ZEBRA_ISIS_ADJACENCY_H#define
_ZEBRA_ISIS_ADJACENCY_H#include"isisd/isis_tlvs.h"enumisis_adj_usage{ISIS_ADJ_NO
NE,ISIS_ADJ_LEVEL1,ISIS_ADJ_LEVEL2,ISIS_ADJ_LEVEL1AND2};enumisis_system_type{ISI
S_SYSTYPE_UNKNOWN,ISIS_SYSTYPE_ES,ISIS_SYSTYPE_IS,ISIS_SYSTYPE_L1_IS,ISIS_SYSTYP
E_L2_IS};enumisis_adj_state{ISIS_ADJ_UNKNOWN,ISIS_ADJ_INITIALIZING,ISIS_ADJ_UP,I
SIS_ADJ_DOWN};/**weusethefollowingcodestogiveanindication_why_*aspecificadjacenc
yisupordown*/enumisis_adj_updown_reason{ISIS_ADJ_REASON_SEENSELF,ISIS_ADJ_REASON
_AREA_MISMATCH,ISIS_ADJ_REASON_HOLDTIMER_EXPIRED,ISIS_ADJ_REASON_AUTH_FAILED,ISI
S_ADJ_REASON_CHECKSUM_FAILED};#defineDIS_RECORDS8/*keepthelast8DISstatechangeson
record*/structisis_dis_record{intdis;/*isourneighbortheDIS?*/time_tlast_dis_chan
ge;/*timestampforlastdischange*/};structisis_adjacency{uint8_tsnpa[ETH_ALEN];/*N
eighbourSNPAAddress*/uint8_tsysid[ISIS_SYS_ID_LEN];/*neighbourSystemIdentifier*/
uint8_tlanid[ISIS_SYS_ID_LEN+1];/*LANidonbcastcircuits*/intdischanges[ISIS_LEVEL
S];/*howmanyDISchanges?*//*anarrayofNlevelsforMrecords*/structisis_dis_recorddis
_record[DIS_RECORDS*ISIS_LEVELS];enumisis_adj_stateadj_state;/*adjacencyState*/e
numisis_adj_usageadj_usage;/*adjacencyUsage*/structarea_addr*area_addresses;/*ar
eaAdressesOfNeighbour*/unsignedintarea_address_count;structnlpidsnlpids;/*protoc
olsspoken...*/structin_addr*ipv4_addresses;unsignedintipv4_address_count;structi
n_addrrouter_address;structin6_addr*ipv6_addresses;unsignedintipv6_address_count
;structin6_addrrouter_address6;uint8_tprio[ISIS_LEVELS];/*priorityOfNeighbourfor
DIS*/intcircuit_t;/*fromhelloPDUhdr*/intlevel;/*level(1or2)*/enumisis_system_typ
esys_type;/*neighbourSystemType*/uint16_thold_time;/*entryRemainingTime*/uint32_
tlast_upd;uint32_tlast_flap;/*lasttimetheadjflapped*/enumisis_threeway_statethre
eway_state;uint32_text_circuit_id;intflaps;/*numberofadjacencyflaps*/structthrea
d*t_expire;/*expireafterhold_time*/structisis_circuit*circuit;/*backpointer*/uin
t16_t*mt_set;/*Topologiesthisadjacencyisvalidfor*/unsignedintmt_count;/*Numberof
entriesinmt_set*/};structisis_threeway_adj;structisis_adjacency*isis_adj_lookup(
constuint8_t*sysid,structlist*adjdb);structisis_adjacency*isis_adj_lookup_snpa(c
onstuint8_t*ssnpa,structlist*adjdb);structisis_adjacency*isis_new_adj(constuint8
_t*id,constuint8_t*snpa,intlevel,structisis_circuit*circuit);voidisis_delete_adj
(void*adj);voidisis_adj_process_threeway(structisis_adjacency*adj,structisis_thr
eeway_adj*tw_adj,enumisis_adj_usageadj_usage);voidisis_adj_state_change(structis
is_adjacency*adj,enumisis_adj_statestate,constchar*reason);voidisis_adj_print(st
ructisis_adjacency*adj);intisis_adj_expire(structthread*thread);voidisis_adj_pri
nt_vty(structisis_adjacency*adj,structvty*vty,chardetail);voidisis_adj_build_nei
gh_list(structlist*adjdb,structlist*list);voidisis_adj_build_up_list(structlist*
adjdb,structlist*list);intisis_adj_usage2levels(enumisis_adj_usageusage);#endif/
*ISIS_ADJACENCY_H*/