/**IS-ISRout(e)ingprotocol-isis_pdu.h*PDUprocessing**Copyright(C)2001,2002SampoS
aaristo*TampereUniversityofTechnology*InstituteofCommunicationsEngineering**This
programisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGe
neralPublicLicenseaspublishedbytheFree*SoftwareFoundation;eitherversion2oftheLic
ense,or(atyouroption)*anylaterversion.**Thisprogramisdistributedinthehopethatitw
illbeuseful,butWITHOUT*ANYWARRANTY;withouteventheimpliedwarrantyofMERCHANTABILIT
Yor*FITNESSFORAPARTICULARPURPOSE.SeetheGNUGeneralPublicLicensefor*moredetails.**
YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seet
hefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFlo
or,Boston,MA02110-1301USA*/#ifndef_ZEBRA_ISIS_PDU_H#define_ZEBRA_ISIS_PDU_H#ifde
f__SUNPRO_C#pragmapack(1)#endif/**ISO9542-7.5,7.6**EStoISFixedHeader*+-------+--
-----+-------+-------+-------+-------+-------+-------+*|IntradomainRouteingProto
colDiscriminator|*+-------+-------+-------+-------+-------+-------+-------+-----
--+*|LengthIndicator|*+-------+-------+-------+-------+-------+-------+-------+-
------+*|Version/ProtocolIDextension|*+-------+-------+-------+-------+-------+-
------+-------+-------+*|Reserved=0|*+-------+-------+-------+-------+-------+--
-----+-------+-------+*|0|0|0|PDUType|*+-------+-------+-------+-------+-------+
-------+-------+-------+*|HoldingTime|2*+-------+-------+-------+-------+-------
+-------+-------+-------+*|Checksum|2*+-------+-------+-------+-------+-------+-
------+-------+-------+*/structesis_fixed_hdr{uint8_tidrp;uint8_tlength;uint8_tv
ersion;uint8_tid_len;uint8_tpdu_type;uint16_tholdtime;uint16_tchecksum;}__attrib
ute__((packed));#defineESIS_FIXED_HDR_LEN9#defineESH_PDU2#defineISH_PDU4#defineR
D_PDU5#defineISIS_FIXED_HDR_LEN8/**IS-ISPDUtypes.*/#defineL1_LAN_HELLO15#defineL
2_LAN_HELLO16/**L1andL2LANIStoISHelloPDUheader*+-------+-------+-------+-------+
-------+-------+-------+-------+*|Reserved|CircuitType|1*+-------+-------+------
-+-------+-------+-------+-------+-------+*+SourceID+id_len*+-------+-------+---
----+-------+-------+-------+-------+-------+*|HoldingTime|2*+-------+-------+--
-----+-------+-------+-------+-------+-------+*|PDULength|2*+-------+-------+---
----+-------+-------+-------+-------+-------+*|R|Priority|1*+-------+-------+---
----+-------+-------+-------+-------+-------+*|LANID|id_len+1*+-------+-------+-
------+-------+-------+-------+-------+-------+*/structisis_lan_hello_hdr{uint8_
tcircuit_t;uint8_tsource_id[ISIS_SYS_ID_LEN];uint16_thold_time;uint16_tpdu_len;u
int8_tprio;uint8_tlan_id[ISIS_SYS_ID_LEN+1];}__attribute__((packed));#defineISIS
_LANHELLO_HDRLEN19#defineP2P_HELLO17/**Point-to-pointIStoIShelloPDUheader*+-----
--+-------+-------+-------+-------+-------+-------+-------+*|Reserved|CircuitTyp
e|1*+-------+-------+-------+-------+-------+-------+-------+-------+*+SourceID+
id_len*+-------+-------+-------+-------+-------+-------+-------+-------+*+Holdin
gTime+2*+-------+-------+-------+-------+-------+-------+-------+-------+*+PDULe
ngth+2*+-------+-------+-------+-------+-------+-------+-------+-------+*|LocalC
ircuitID|1*+-------+-------+-------+-------+-------+-------+-------+-------+*/st
ructisis_p2p_hello_hdr{uint8_tcircuit_t;uint8_tsource_id[ISIS_SYS_ID_LEN];uint16
_thold_time;uint16_tpdu_len;uint8_tlocal_id;}__attribute__((packed));#defineISIS
_P2PHELLO_HDRLEN12#defineL1_LINK_STATE18#defineL2_LINK_STATE20structisis_lsp_hdr
{uint16_tpdu_len;uint16_trem_lifetime;uint8_tlsp_id[ISIS_SYS_ID_LEN+2];uint32_ts
eqno;uint16_tchecksum;uint8_tlsp_bits;};#defineISIS_LSP_HDR_LEN19/**Sincetheleng
thfieldofLSPEntriesTLVisonebytelong,andeachLSP*entryisLSP_ENTRIES_LEN(16)byteslo
ng,themaximumnumberofLSPentries*canbeaccomodatedinaTLVis*255/16=15.**Therefore,t
hemaximumlengthoftheLSPEntriesTLVis*16*15+2(header)=242bytes.*/#defineMAX_LSP_EN
TRIES_TLV_SIZE242#defineL1_COMPLETE_SEQ_NUM24#defineL2_COMPLETE_SEQ_NUM25/**L1an
dL2IStoIScompletesequencenumbersPDUheader*+-------+-------+-------+-------+-----
--+-------+-------+-------+*+PDULength+2*+-------+-------+-------+-------+------
-+-------+-------+-------+*+SourceID+id_len+1*+-------+-------+-------+-------+-
------+-------+-------+-------+*+StartLSPID+id_len+2*+-------+-------+-------+--
-----+-------+-------+-------+-------+*+EndLSPID+id_len+2*+-------+-------+-----
--+-------+-------+-------+-------+-------+*/structisis_complete_seqnum_hdr{uint
16_tpdu_len;uint8_tsource_id[ISIS_SYS_ID_LEN+1];uint8_tstart_lsp_id[ISIS_SYS_ID_
LEN+2];uint8_tstop_lsp_id[ISIS_SYS_ID_LEN+2];};#defineISIS_CSNP_HDRLEN25#defineL
1_PARTIAL_SEQ_NUM26#defineL2_PARTIAL_SEQ_NUM27/**L1andL2IStoISpartialsequencenum
bersPDUheader*+-------+-------+-------+-------+-------+-------+-------+-------+*
+PDULength+2*+-------+-------+-------+-------+-------+-------+-------+-------+*+
SourceID+id_len+1*+-------------------------------------------------------------
--+*/structisis_partial_seqnum_hdr{uint16_tpdu_len;uint8_tsource_id[ISIS_SYS_ID_
LEN+1];};#defineISIS_PSNP_HDRLEN9#ifdef__SUNPRO_C#pragmapack()#endif/**Functionf
orreceivingIS-ISPDUs*/intisis_receive(structthread*thread);/**callingargumentsfo
rsnp_process()*/#defineISIS_SNP_PSNP_FLAG0#defineISIS_SNP_CSNP_FLAG1#defineISIS_
AUTH_MD5_SIZE16U/**Sendingfunctions*/intsend_lan_l1_hello(structthread*thread);i
ntsend_lan_l2_hello(structthread*thread);intsend_p2p_hello(structthread*thread);
intsend_csnp(structisis_circuit*circuit,intlevel);intsend_l1_csnp(structthread*t
hread);intsend_l2_csnp(structthread*thread);intsend_l1_psnp(structthread*thread)
;intsend_l2_psnp(structthread*thread);intsend_lsp(structthread*thread);voidfill_
fixed_hdr(uint8_tpdu_type,structstream*stream);intsend_hello(structisis_circuit*
circuit,intlevel);intisis_handle_pdu(structisis_circuit*circuit,uint8_t*ssnpa);#
endif/*_ZEBRA_ISIS_PDU_H*/