/**IS-ISRout(e)ingprotocol-isis_main.c**Copyright(C)2001,2002SampoSaaristo*Tampe
reUniversityofTechnology*InstituteofCommunicationsEngineering**Thisprogramisfree
software;youcanredistributeitand/ormodifyit*underthetermsoftheGNUGeneralPublicLi
censeaspublishedbytheFree*SoftwareFoundation;eitherversion2oftheLicense,or(atyou
roption)*anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,b
utWITHOUT*ANYWARRANTY;withouteventheimpliedwarrantyofMERCHANTABILITYor*FITNESSFO
RAPARTICULARPURPOSE.SeetheGNUGeneralPublicLicensefor*moredetails.**Youshouldhave
receivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING
;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA0
2110-1301USA*/#include<zebra.h>#include"getopt.h"#include"thread.h"#include"log.
h"#include<lib/version.h>#include"command.h"#include"vty.h"#include"memory.h"#in
clude"memory_vty.h"#include"stream.h"#include"if.h"#include"privs.h"#include"sig
event.h"#include"filter.h"#include"plist.h"#include"zclient.h"#include"vrf.h"#in
clude"qobj.h"#include"libfrr.h"#include"isisd/dict.h"#include"isisd/isis_constan
ts.h"#include"isisd/isis_common.h"#include"isisd/isis_flags.h"#include"isisd/isi
s_circuit.h"#include"isisd/isisd.h"#include"isisd/isis_dynhn.h"#include"isisd/is
is_spf.h"#include"isisd/isis_route.h"#include"isisd/isis_routemap.h"#include"isi
sd/isis_zebra.h"#include"isisd/isis_te.h"/*Defaultconfigurationfilename*/#define
ISISD_DEFAULT_CONFIG"isisd.conf"/*Defaultvtyport*/#defineISISD_VTY_PORT2608/*isi
sdprivileges*/zebra_capabilities_t_caps_p[]={ZCAP_NET_RAW,ZCAP_BIND};structzebra
_privs_tisisd_privs={#ifdefined(FRR_USER).user=FRR_USER,#endif#ifdefinedFRR_GROU
P.group=FRR_GROUP,#endif#ifdefVTY_GROUP.vty_group=VTY_GROUP,#endif.caps_p=_caps_
p,.cap_num_p=sizeof(_caps_p)/sizeof(*_caps_p),.cap_num_i=0};/*isisdoptions*/stru
ctoptionlongopts[]={{0}};/*Masterofthreads.*/structthread_master*master;/**Proto
types.*/voidsighup(void);voidsigint(void);voidsigterm(void);voidsigusr1(void);st
atic__attribute__((__noreturn__))voidterminate(inti){isis_zebra_stop();exit(i);}
/**Signalhandlers*/voidsighup(void){zlog_err("SIGHUP/reloadisnotimplementedforis
isd");return;}__attribute__((__noreturn__))voidsigint(void){zlog_notice("Termina
tingonsignalSIGINT");terminate(0);}__attribute__((__noreturn__))voidsigterm(void
){zlog_notice("TerminatingonsignalSIGTERM");terminate(0);}voidsigusr1(void){zlog
_debug("SIGUSR1received");zlog_rotate();}structquagga_signal_tisisd_signals[]={{
.signal=SIGHUP,.handler=&sighup,},{.signal=SIGUSR1,.handler=&sigusr1,},{.signal=
SIGINT,.handler=&sigint,},{.signal=SIGTERM,.handler=&sigterm,},};FRR_DAEMON_INFO
(isisd,ISIS,.vty_port=ISISD_VTY_PORT,.proghelp="ImplementationoftheIS-ISroutingp
rotocol.",.copyright="Copyright(c)2001-2002SampoSaaristo,""OferWaldandHannesGred
ler",.signals=isisd_signals,.n_signals=array_size(isisd_signals),.privs=&isisd_p
rivs,)/**Mainroutineofisisd.ParseargumentsandhandleIS-ISstatemachine.*/intmain(i
ntargc,char**argv,char**envp){intopt;frr_preinit(&isisd_di,argc,argv);frr_opt_ad
d("",longopts,"");/*Commandlineargumenttreatment.*/while(1){opt=frr_getopt(argc,
argv,NULL);if(opt==EOF)break;switch(opt){case0:break;default:frr_help_exit(1);br
eak;}}vty_config_lockless();/*threadmaster*/master=frr_init();/**initializations
*/access_list_init();vrf_init(NULL,NULL,NULL,NULL);prefix_list_init();isis_init(
);isis_circuit_init();isis_spf_cmds_init();isis_redist_init();isis_route_map_ini
t();isis_mpls_te_init();/*createtheglobal'isis'instance*/isis_new(1);isis_zebra_
init(master);frr_config_fork();frr_run(master);/*Notreached.*/exit(0);}