/**SHARP-maincode*Copyright(C)CumulusNetworks,Inc.*DonaldSharp**Thisfileispartof
FRR.**FRRisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheGNU
GeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(at
youroption)any*laterversion.**FRRisdistributedinthehopethatitwillbeuseful,but*WI
THOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPAR
TICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhaverecei
vedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifno
t,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-
1301USA*/#include<zebra.h>#include<lib/version.h>#include"getopt.h"#include"thre
ad.h"#include"prefix.h"#include"linklist.h"#include"if.h"#include"vector.h"#incl
ude"vty.h"#include"command.h"#include"filter.h"#include"plist.h"#include"stream.
h"#include"log.h"#include"memory.h"#include"privs.h"#include"sigevent.h"#include
"zclient.h"#include"keychain.h"#include"distribute.h"#include"libfrr.h"#include"
routemap.h"#include"sharp_zebra.h"#include"sharp_vty.h"uint32_ttotal_routes=0;ui
nt32_tinstalled_routes=0;uint32_tremoved_routes=0;zebra_capabilities_t_caps_p[]=
{ZCAP_NET_RAW,ZCAP_BIND,ZCAP_NET_ADMIN,};structzebra_privs_tsharp_privs={#ifdefi
ned(FRR_USER)&&defined(FRR_GROUP).user=FRR_USER,.group=FRR_GROUP,#endif#ifdefine
d(VTY_GROUP).vty_group=VTY_GROUP,#endif.caps_p=_caps_p,.cap_num_p=array_size(_ca
ps_p),.cap_num_i=0};structoptionlongopts[]={{0}};/*Masterofthreads.*/structthrea
d_master*master;/*SIGHUPhandler.*/staticvoidsighup(void){zlog_info("SIGHUPreceiv
ed");}/*SIGINT/SIGTERMhandler.*/staticvoidsigint(void){zlog_notice("Terminatingo
nsignal");exit(0);}/*SIGUSR1handler.*/staticvoidsigusr1(void){zlog_rotate();}str
uctquagga_signal_tsharp_signals[]={{.signal=SIGHUP,.handler=&sighup,},{.signal=S
IGUSR1,.handler=&sigusr1,},{.signal=SIGINT,.handler=&sigint,},{.signal=SIGTERM,.
handler=&sigint,},};#defineSHARP_VTY_PORT2614FRR_DAEMON_INFO(sharpd,SHARP,.vty_p
ort=SHARP_VTY_PORT,.proghelp="ImplementationofaSharpofroutesdaemon.",.signals=sh
arp_signals,.n_signals=array_size(sharp_signals),.privs=&sharp_privs,)externvoid
sharp_vty_init(void);intmain(intargc,char**argv,char**envp){frr_preinit(&sharpd_
di,argc,argv);frr_opt_add("",longopts,"");while(1){intopt;opt=frr_getopt(argc,ar
gv,NULL);if(opt==EOF)break;switch(opt){case0:break;default:frr_help_exit(1);brea
k;}}master=frr_init();vrf_init(NULL,NULL,NULL,NULL);sharp_zebra_init();/*Getconf
igurationfile.*/sharp_vty_init();frr_config_fork();frr_run(master);/*Notreached.
*/return0;}