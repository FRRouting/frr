/**Zebraloggingfuncions.*Copyright(C)1997,1998,1999KunihiroIshiguro**Thisfileisp
artofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*undert
hetermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eithe
rversion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopethati
twillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABI
LITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.
**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;se
ethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthF
loor,Boston,MA02110-1301USA*/#ifndef_ZEBRA_LOG_H#define_ZEBRA_LOG_H#include<sysl
og.h>#include<stdint.h>#include<stdbool.h>#include<stdio.h>/*Hereissomeguidanceo
nlogginglevelstouse:**LOG_DEBUG-Forallmessagesthatareenabledbyoptionaldebugging*
features,typicallyprecededby"if(IS...DEBUG...)"*LOG_INFO-Informationthatmaybeofi
nterest,buteverythingseems*tobeworkingproperly.*LOG_NOTICE-Onlyformessagepertain
ingtodaemonstartuporshutdown.*LOG_WARNING-Warningconditions:unexpectedevents,but
thedaemonbelieves*itcancontinuetooperatecorrectly.*LOG_ERR-Errorsituationsindica
tingmalfunctions.Probablyrequire*attention.**Note:LOG_CRIT,LOG_ALERT,andLOG_EMER
Garecurrentlynotusedanywhere,*pleaseuseLOG_ERRinstead.*//*IfmaxlvlissettoZLOG_DI
SABLED,thennomessageswillbesenttothatloggingdestination.*/#defineZLOG_DISABLED(L
OG_EMERG-1)typedefenum{ZLOG_DEST_SYSLOG=0,ZLOG_DEST_STDOUT,ZLOG_DEST_MONITOR,ZLO
G_DEST_FILE}zlog_dest_t;#defineZLOG_NUM_DESTS(ZLOG_DEST_FILE+1)externboolzlog_st
artup_stderr;/*Messagestructure.*/structmessage{intkey;constchar*str;};/*Openzlo
gfunction*/externvoidopenzlog(constchar*progname,constchar*protoname,uint16_tins
tance,intsyslog_options,intsyslog_facility);/*Closezlogfunction.*/externvoidclos
ezlog(void);/*GCChaveprintftypeattributecheck.*/#ifdef__GNUC__#definePRINTF_ATTR
IBUTE(a,b)__attribute__((__format__(__printf__,a,b)))#else#definePRINTF_ATTRIBUT
E(a,b)#endif/*__GNUC__*//*Handyzlogfunctions.*/externvoidzlog_err(constchar*form
at,...)PRINTF_ATTRIBUTE(1,2);externvoidzlog_warn(constchar*format,...)PRINTF_ATT
RIBUTE(1,2);externvoidzlog_info(constchar*format,...)PRINTF_ATTRIBUTE(1,2);exter
nvoidzlog_notice(constchar*format,...)PRINTF_ATTRIBUTE(1,2);externvoidzlog_debug
(constchar*format,...)PRINTF_ATTRIBUTE(1,2);externvoidzlog_thread_info(intlog_le
vel);/*Setlogginglevelforthegivendestination.Ifthelog_levelargumentisZLOG_DISABL
ED,thenthedestinationisdisabled.Thisfunctionshouldnotbeusedforfilelogging(usezlo
g_set_fileorzlog_reset_fileinstead).*/externvoidzlog_set_level(zlog_dest_t,intlo
g_level);/*Setloggingtothegivenfilenameatthespecifiedlevel.*/externintzlog_set_f
ile(constchar*filename,intlog_level);/*Disablefilelogging.*/externintzlog_reset_
file(void);/*Rotatelog.*/externintzlog_rotate(void);constchar*lookup_msg(constst
ructmessage*mz,intkz,constchar*nf);/*Safeversionofstrerror--neverreturnsNULL.*/e
xternconstchar*safe_strerror(interrnum);/*Tobecalledwhenafatalsignaliscaught.*/e
xternvoidzlog_signal(intsigno,constchar*action#ifdefSA_SIGINFO,siginfo_t*siginfo
,void*program_counter#endif);/*Logabacktrace.*/externvoidzlog_backtrace(intprior
ity);/*Logabacktrace,butinanasync-signal-safeway.Shouldnotbecalledunlesstheprogr
amisabouttoexitorabort,sinceitmessesupthestateofzlogfilepointers.Ifprogram_count
erisnon-NULL,thatisloggedinadditiontothecurrentbacktrace.*/externvoidzlog_backtr
ace_sigsafe(intpriority,void*program_counter);/*Putsacurrenttimestampinbufandret
urnsthenumberofcharacterswritten(notincludingtheterminatingNUL).Thepurposeofthis
functionistoavoidcallstolocaltimeappearingalloverthecode.Itcachesthemostrecentlo
caltimeresultandcanthereforeavoidmultiplecallswithinthesamesecond.Ifbuflenistoos
mall,*bufwillbesetto'\0',and0willbereturned.*/#defineQUAGGA_TIMESTAMP_LEN40exter
nsize_tquagga_timestamp(inttimestamp_precision/*#subseconddigits*/,char*buf,size
_tbuflen);externvoidzlog_hexdump(constvoid*mem,unsignedintlen);externconstchar*z
log_sanitize(char*buf,size_tbufsz,constvoid*in,size_tinlen);externintvzlog_test(
intpriority);/*structureusefulforavoidingrepeatedrenderingofthesametimestamp*/st
ructtimestamp_control{size_tlen;/*lengthofrenderedtimestamp*/intprecision;/*conf
igurationparameter*/intalready_rendered;/*shouldbeinitializedto0*/charbuf[QUAGGA
_TIMESTAMP_LEN];/*willcontaintherenderedtimestamp*/};/*Definesforuseincommandcon
struction:*/#defineLOG_LEVEL_DESC\"Systemisunusable\n"\"Immediateactionneeded\n"
\"Criticalconditions\n"\"Errorconditions\n"\"Warningconditions\n"\"Normalbutsign
ificantconditions\n"\"Informationalmessages\n"\"Debuggingmessages\n"#defineLOG_F
ACILITY_DESC\"Kernel\n"\"Userprocess\n"\"Mailsystem\n"\"Systemdaemons\n"\"Author
izationsystem\n"\"Syslogitself\n"\"Lineprintersystem\n"\"USENETnews\n"\"Unix-to-
Unixcopysystem\n"\"Cron/atfacility\n"\"Localuse\n"\"Localuse\n"\"Localuse\n"\"Lo
caluse\n"\"Localuse\n"\"Localuse\n"\"Localuse\n"\"Localuse\n"#endif/*_ZEBRA_LOG_
H*/