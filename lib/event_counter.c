/**Copyright(C)2016ChristianFranke**ThisfileispartofQuagga.**Permissionisherebyg
ranted,freeofcharge,toanypersonobtaininga*copyofthissoftwareandassociateddocumen
tationfiles(the"Software"),*todealintheSoftwarewithoutrestriction,includingwitho
utlimitation*therightstouse,copy,modify,merge,publish,distribute,sublicense,*and
/orsellcopiesoftheSoftware,andtopermitpersonstowhomthe*Softwareisfurnishedtodoso
,subjecttothefollowingconditions:**Theabovecopyrightnoticeandthispermissionnotic
e(includingthenext*paragraph)shallbeincludedinallcopiesorsubstantialportionsofth
e*Software.**THESOFTWAREISPROVIDED"ASIS",WITHOUTWARRANTYOFANYKIND,EXPRESSOR*IMPL
IED,INCLUDINGBUTNOTLIMITEDTOTHEWARRANTIESOFMERCHANTABILITY,*FITNESSFORAPARTICULA
RPURPOSEANDNONINFRINGEMENT.INNOEVENTSHALL*THEAUTHORSORCOPYRIGHTHOLDERSBELIABLEFO
RANYCLAIM,DAMAGESOROTHER*LIABILITY,WHETHERINANACTIONOFCONTRACT,TORTOROTHERWISE,A
RISING*FROM,OUTOFORINCONNECTIONWITHTHESOFTWAREORTHEUSEOROTHER*DEALINGSINTHESOFTW
ARE.**Alternatively,youcanuse,redistributeand/ormodifyitunderthe*followingterms:
**Quaggaisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheGNUG
eneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(aty
ouroption)any*laterversion.**Quaggaisdistributedinthehopethatitwillbeuseful,but*
WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAP
ARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhaverec
eivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;if
not,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA0211
0-1301USA*/#include<zebra.h>#include"event_counter.h"voidevent_counter_inc(struc
tevent_counter*counter){counter->count++;counter->last=time(NULL);}constchar*eve
nt_counter_format(conststructevent_counter*counter){structtmlast_change_store;st
ructtm*last_change;chartimebuf[sizeof("Thu,01Jan197000:00:00+0000")];staticcharr
v[20+sizeof("last:")+sizeof(timebuf)];last_change=localtime_r(&counter->last,&la
st_change_store);if(!last_change||strftime(timebuf,sizeof(timebuf),"%a,%d%b%Y%T%
z",last_change)==0){strncpy(timebuf,"???",sizeof(timebuf));}snprintf(rv,sizeof(r
v),"%5llulast:%s",counter->count,counter->last?timebuf:"(never)");returnrv;}