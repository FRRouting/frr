/**InputmatchingroutinesforCLIbackend.**--*Copyright(C)2016CumulusNetworks,Inc.*
*ThisfileispartofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormod
ifyit*underthetermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoun
dation;eitherversion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedin
thehopethatitwillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof
*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicensefor
moredetails.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withth
isprogram;seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51Frank
linSt,FifthFloor,Boston,MA02110-1301USA*/#ifndef_ZEBRA_COMMAND_MATCH_H#define_ZE
BRA_COMMAND_MATCH_H#include"graph.h"#include"linklist.h"#include"command.h"/*The
sedefinitionsexistincommand.cinthecurrentenginebutshouldbe*relocatedhereinthenew
engine*/enumfilter_type{FILTER_RELAXED,FILTER_STRICT};/*matcherresultvalue*/enum
matcher_rv{MATCHER_NO_MATCH,MATCHER_INCOMPLETE,MATCHER_AMBIGUOUS,MATCHER_OK,};/*
completionmatchtypes*/enummatch_type{trivial_match,//theinputisnullno_match,//th
einputdoesnotmatchpartly_match,//theinputmatchesbutisincompleteexact_match//thei
nputmatchesandiscomplete};/*Defineswhichmatcher_rvvaluesconstituteanerror.Should
beusedwith*matcher_rvreturnvaluestodobasicerrorchecking.*/#defineMATCHER_ERROR(m
atcher_rv)\((matcher_rv)==MATCHER_INCOMPLETE\||(matcher_rv)==MATCHER_NO_MATCH\||
(matcher_rv)==MATCHER_AMBIGUOUS)/***Attempttofindanexactcommandmatchforalineofus
erinput.**@param[in]cmdgraphcommandgraphtomatchagainst*@param[in]vlinevectorized
inputstring*@param[out]argvpointertoargumentlistifsuccessfulmatch,NULL*otherwise
.Theelementsofthislistarepointerstostructcmd_token*andrepresentthesequenceoftoke
nsmatchedbytheinpu.The->arg*fieldofeachtokenpointstoacopyoftheinputmatchedonit.T
hese*maybesafelydeletedormodified.*@param[out]elementpointertomatchedcmd_element
ifsuccessfulmatch,*orNULLwhenMATCHER_ERROR(rv)istrue.Thecmd_elementmay*not*be*sa
felydeletedormodified;itistheinstanceinitializedonstartup.*@returnmatcherstatus*
/enummatcher_rvcommand_match(structgraph*cmdgraph,vectorvline,structlist**argv,c
onststructcmd_element**element);/***Compilespossiblecompletionsforagivenlineofus
erinput.**@param[in]startthestartnodeoftheDFAtomatchagainst*@param[in]vlinevecto
rizedinputstring*@param[out]completionspointertolistofcmd_tokenrepresenting*acce
ptablenextinputs,orNULLwhenMATCHER_ERROR(rv)istrue.*Theelementsofthislistarepoin
terstostructcmd_tokenandtakeona*varietyofformsdependingonthepassedvline.Ifthelas
telementinvline*isNULL,allpreviouselementsareconsideredtobecompletewords(thecase
*whenaspaceisthelasttokenoftheline)andcompletionsaregenerated*basedonwhatcouldfo
llowthatinput.Ifthelastelementinvlineisnot*NULLandeachsequentialelementmatchesth
ecorrespondingtokensofoneor*morecommandsexactly(e.g.'encapv4'andnot'en')thesamer
esultis*generated.IfthelastelementisnotNULLandthebestpossiblematchisa*partialmat
ch,thentheresultgeneratedwillbeallpossiblecontinuations*ofthatelement(e.g.'encap
v4','encapv6',etcforinput'en').*@returnmatcherstatus*/enummatcher_rvcommand_comp
lete(structgraph*cmdgraph,vectorvline,structlist**completions);#endif/*_ZEBRA_CO
MMAND_MATCH_H*/