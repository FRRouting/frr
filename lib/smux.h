/*SNMPsupport*Copyright(C)1999KunihiroIshiguro<kunihiro@zebra.org>**Thisfileispa
rtofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*underth
etermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;either
version2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopethatit
willbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABIL
ITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.*
*YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;see
thefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFl
oor,Boston,MA02110-1301USA*/#ifndef_ZEBRA_SNMP_H#define_ZEBRA_SNMP_H#include<net
-snmp/agent/net-snmp-agent-includes.h>#include<net-snmp/agent/snmp_vars.h>#inclu
de"thread.h"/*StructuresherearemostlycompatiblewithUCDSNMP4.1.1*/#defineMATCH_FA
ILED(-1)#defineMATCH_SUCCEEDED0/*SYNTAXTruthValuefromSNMPv2-TC.*/#defineSNMP_TRU
E1#defineSNMP_FALSE2/*SYNTAXRowStatusfromSNMPv2-TC.*/#defineSNMP_VALID1#defineSN
MP_INVALID2#defineIN_ADDR_SIZEsizeof(structin_addr)#undefREGISTER_MIB#defineREGI
STER_MIB(descr,var,vartype,theoid)\smux_register_mib(descr,(structvariable*)var,
\sizeof(structvartype),\sizeof(var)/sizeof(structvartype),theoid,\sizeof(theoid)
/sizeof(oid))structtrap_object{intnamelen;/*Negativeiftheobjectisnotindexed*/oid
name[MAX_OID_LEN];};/*DeclareSMUXreturnvalue.*/#defineSNMP_LOCAL_VARIABLES\stati
clongsnmp_int_val__attribute__((unused));\staticstructin_addrsnmp_in_addr_val__a
ttribute__((unused));#defineSNMP_INTEGER(V)\(*var_len=sizeof(snmp_int_val),snmp_
int_val=V,\(uint8_t*)&snmp_int_val)#defineSNMP_IPADDRESS(V)\(*var_len=sizeof(str
uctin_addr),snmp_in_addr_val=V,\(uint8_t*)&snmp_in_addr_val)externvoidsmux_init(
structthread_master*tm);externvoidsmux_register_mib(constchar*,structvariable*,s
ize_t,int,oid[],size_t);externintsmux_header_generic(structvariable*,oid[],size_
t*,int,size_t*,WriteMethod**);externintsmux_header_table(structvariable*,oid*,si
ze_t*,int,size_t*,WriteMethod**);/*Fortraps,threeOIDareprovided:1.TheenterpriseO
IDtouse(thelastargumentwillbeappendedtoittoformtheSNMPtrapOID)2.ThebaseOIDforobj
ectstobesentintraps.3.TheindexOIDforobjectstobesentintraps.Thisindexisusedtodesi
gnateaparticularinstanceofacolumn.Theprovidedtrapobjectcontainsthebindingstobese
ntwiththetrap.ThebaseOIDwillbeprefixedtotheprovidedOIDand,ifthelengthispositive,
therequestedOIDisassumedtobeacolumnarobjectandtheindexOIDwillbeappended.Thetwofi
rstargumentsaretheMIBregistryusedtolocatethetrapobjects.Theuseoftheargumentsmayd
ifferdependingontheimplementationused.*/externintsmux_trap(structvariable*,size_
t,constoid*,size_t,constoid*,size_t,constoid*,size_t,conststructtrap_object*,siz
e_t,uint8_t);externintoid_compare(constoid*,int,constoid*,int);externvoidoid2in_
addr(oid[],int,structin_addr*);externvoid*oid_copy(void*,constvoid*,size_t);exte
rnvoidoid_copy_addr(oid[],structin_addr*,int);#endif/*_ZEBRA_SNMP_H*/