/*Routeradvertisement*Copyright(C)1999KunihiroIshiguro**ThisfileispartofGNUZebra
.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*underthetermsoftheG
NUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eitherversion2,or(
atyouroption)any*laterversion.**GNUZebraisdistributedinthehopethatitwillbeuseful
,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESS
FORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldha
vereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYI
NG;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,M
A02110-1301USA*/#ifndef_ZEBRA_SOCKOPT_H#define_ZEBRA_SOCKOPT_H#include"sockunion
.h"externvoidsetsockopt_so_recvbuf(intsock,intsize);externvoidsetsockopt_so_send
buf(constintsock,intsize);externintgetsockopt_so_sendbuf(constintsock);externint
setsockopt_ipv6_pktinfo(int,int);externintsetsockopt_ipv6_checksum(int,int);exte
rnintsetsockopt_ipv6_multicast_hops(int,int);externintsetsockopt_ipv6_unicast_ho
ps(int,int);externintsetsockopt_ipv6_hoplimit(int,int);externintsetsockopt_ipv6_
multicast_loop(int,int);externintsetsockopt_ipv6_tclass(int,int);#defineSOPT_SIZ
E_CMSG_PKTINFO_IPV6()(sizeof(structin6_pktinfo));/**Sizedefinesforcontrolmessage
susedtogetifindex.Wedefine*valuesforeachmethod,anddefineamacrothatcanbeusedbycod
e*thatisunawareofwhichmethodisinuse.*Thesevaluesarewithoutanyalignmentneeded(see
CMSG_SPACEinRFC3542).*/#ifdefined(IP_PKTINFO)/*Linuxin_pktinfo.*/#defineSOPT_SIZ
E_CMSG_PKTINFO_IPV4()(CMSG_SPACE(sizeof(structin_pktinfo)))/*XXXThisshouldperhap
sbedefinedevenifIP_PKTINFOisnot.*/#defineSOPT_SIZE_CMSG_PKTINFO(af)\((af==AF_INE
T)?SOPT_SIZE_CMSG_PKTINFO_IPV4()\:SOPT_SIZE_CMSG_PKTINFO_IPV6()#endif/*IP_PKTINF
O*/#ifdefined(IP_RECVIF)/*BSD/Solaris*/#ifdefined(SUNOS_5)#defineSOPT_SIZE_CMSG_
RECVIF_IPV4()(sizeof(uint_t))#else#defineSOPT_SIZE_CMSG_RECVIF_IPV4()(sizeof(str
uctsockaddr_dl))#endif/*SUNOS_5*/#endif/*IP_RECVIF*//*SOPT_SIZE_CMSG_IFINDEX_IPV
4-portabletype*/#ifdefined(SOPT_SIZE_CMSG_PKTINFO)#defineSOPT_SIZE_CMSG_IFINDEX_
IPV4()SOPT_SIZE_CMSG_PKTINFO_IPV4()#elifdefined(SOPT_SIZE_CMSG_RECVIF_IPV4)#defi
neSOPT_SIZE_CMSG_IFINDEX_IPV4()SOPT_SIZE_CMSG_RECVIF_IPV4()#else/*Nothingavailab
le*/#defineSOPT_SIZE_CMSG_IFINDEX_IPV4()(sizeof(char*))#endif/*SOPT_SIZE_CMSG_IF
INDEX_IPV4*/#defineSOPT_SIZE_CMSG_IFINDEX(af)\(((af)==AF_INET):SOPT_SIZE_CMSG_IF
INDEX_IPV4()\?SOPT_SIZE_CMSG_PKTINFO_IPV6())externintsetsockopt_ipv4_multicast_i
f(intsock,structin_addrif_addr,ifindex_tifindex);externintsetsockopt_ipv4_multic
ast(intsock,intoptname,structin_addrif_addr,unsignedintmcast_addr,ifindex_tifind
ex);externintsetsockopt_ipv4_multicast_loop(intsock,uint8_tval);externintsetsock
opt_ipv4_tos(intsock,inttos);/*Askfor,andget,ifindex,bywhatevermethodissupported
.*/externintsetsockopt_ifindex(int,int,ifindex_t);externifindex_tgetsockopt_ifin
dex(int,structmsghdr*);/*swabthefieldsiniphbetweenthehostorderandsystemorderexpe
cted*forIP_HDRINCL.*/externvoidsockopt_iphdrincl_swab_htosys(structip*iph);exter
nvoidsockopt_iphdrincl_swab_systoh(structip*iph);externintsockopt_tcp_rtt(int);e
xternintsockopt_tcp_signature(intsock,unionsockunion*su,constchar*password);#end
if/*_ZEBRA_SOCKOPT_H*/