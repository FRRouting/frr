/**Copyright(c)2017DavidLamparter,forNetDEF,Inc.**Permissiontouse,copy,modify,an
ddistributethissoftwareforany*purposewithorwithoutfeeisherebygranted,providedtha
ttheabove*copyrightnoticeandthispermissionnoticeappearinallcopies.**THESOFTWAREI
SPROVIDED"ASIS"ANDTHEAUTHORDISCLAIMSALLWARRANTIES*WITHREGARDTOTHISSOFTWAREINCLUD
INGALLIMPLIEDWARRANTIESOF*MERCHANTABILITYANDFITNESS.INNOEVENTSHALLTHEAUTHORBELIA
BLEFOR*ANYSPECIAL,DIRECT,INDIRECT,ORCONSEQUENTIALDAMAGESORANYDAMAGES*WHATSOEVERR
ESULTINGFROMLOSSOFUSE,DATAORPROFITS,WHETHERINAN*ACTIONOFCONTRACT,NEGLIGENCEOROTH
ERTORTIOUSACTION,ARISINGOUTOF*ORINCONNECTIONWITHTHEUSEORPERFORMANCEOFTHISSOFTWAR
E.*/#ifndef_FRR_MONOTIME_H#define_FRR_MONOTIME_H#include<stdint.h>#include<time.
h>#include<sys/time.h>#ifndefTIMESPEC_TO_TIMEVAL/*shouldbeinsys/time.honBSD&Linu
xlibcs*/#defineTIMESPEC_TO_TIMEVAL(tv,ts)\do{\(tv)->tv_sec=(ts)->tv_sec;\(tv)->t
v_usec=(ts)->tv_nsec/1000;\}while(0)#endif#ifndefTIMEVAL_TO_TIMESPEC/*shouldbein
sys/time.honBSD&Linuxlibcs*/#defineTIMEVAL_TO_TIMESPEC(tv,ts)\do{\(ts)->tv_sec=(
tv)->tv_sec;\(ts)->tv_nsec=(tv)->tv_usec*1000;\}while(0)#endifstaticinlinetime_t
monotime(structtimeval*tvo){structtimespects;clock_gettime(CLOCK_MONOTONIC,&ts);
if(tvo){TIMESPEC_TO_TIMEVAL(tvo,&ts);}returnts.tv_sec;}#defineONE_DAY_SECOND60*6
0*24#defineONE_WEEK_SECONDONE_DAY_SECOND*7#defineONE_YEAR_SECONDONE_DAY_SECOND*3
65/*thefollowingtworeturnmicroseconds,nottime_t!**also,they'renegativeformsofeac
hother,buthavingbothmakesthe*codemorereadable*/staticinlineint64_tmonotime_since
(conststructtimeval*ref,structtimeval*out){structtimevaltv;monotime(&tv);timersu
b(&tv,ref,&tv);if(out)*out=tv;return(int64_t)tv.tv_sec*1000000LL+tv.tv_usec;}sta
ticinlineint64_tmonotime_until(conststructtimeval*ref,structtimeval*out){structt
imevaltv;monotime(&tv);timersub(ref,&tv,&tv);if(out)*out=tv;return(int64_t)tv.tv
_sec*1000000LL+tv.tv_usec;}#endif/*_FRR_MONOTIME_H*/