/**CLIgraphhandling**--*Copyright(C)2016CumulusNetworks,Inc.*Copyright(C)1997,98
,99KunihiroIshiguro*Copyright(C)2013byOpenSourceRouting.*Copyright(C)2013byInter
netSystemsConsortium,Inc.("ISC")**Thisprogramisfreesoftware;youcanredistributeit
and/ormodifyit*underthetermsoftheGNUGeneralPublicLicenseaspublishedbytheFree*Sof
twareFoundation;eitherversion2oftheLicense,or(atyouroption)*anylaterversion.**Th
isprogramisdistributedinthehopethatitwillbeuseful,butWITHOUT*ANYWARRANTY;without
eventheimpliedwarrantyofMERCHANTABILITYor*FITNESSFORAPARTICULARPURPOSE.SeetheGNU
GeneralPublicLicensefor*moredetails.**YoushouldhavereceivedacopyoftheGNUGeneralP
ublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,writetotheFreeSoftware
*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-1301USA*/#ifndef_FRR_COM
MAND_GRAPH_H#define_FRR_COMMAND_GRAPH_H#include<stdbool.h>#include<stdint.h>#inc
lude"memory.h"#include"vector.h"#include"graph.h"DECLARE_MTYPE(CMD_ARG)structvty
;/***Typesfortokens.**Thetypedetermineswhatkindofdatathetokencanmatch(inthe*matc
hingusecase)orhold(intheargvusecase).*//*clang-formatoff*/enumcmd_token_type{WOR
D_TKN,//wordsVARIABLE_TKN,//almostanythingRANGE_TKN,//integerrangeIPV4_TKN,//IPV
4addressesIPV4_PREFIX_TKN,//IPV4networkprefixesIPV6_TKN,//IPV6prefixesIPV6_PREFI
X_TKN,//IPV6networkprefixesMAC_TKN,//EthernetaddressMAC_PREFIX_TKN,//Ethernetadd
ressw/CIDRmask/*plumbingtypes*/FORK_TKN,//markssubgraphbeginningJOIN_TKN,//marks
subgraphendSTART_TKN,//firsttokeninlineEND_TKN,//lasttokeninlineSPECIAL_TKN=FORK
_TKN,};/*clang-formaton*/#defineIS_VARYING_TOKEN(x)((x)>=VARIABLE_TKN&&(x)<FORK_
TKN)/*Commandattributes*/enum{CMD_ATTR_NORMAL,CMD_ATTR_DEPRECATED,CMD_ATTR_HIDDE
N,};/*Comamandtokenstruct.*/structcmd_token{enumcmd_token_typetype;//tokentypeui
nt8_tattr;//tokenattributesboolallowrepeat;//matcherallowedtomatchtokenrepetivel
y?uint32_trefcnt;char*text;//tokentextchar*desc;//tokendescriptionlonglongmin,ma
x;//forrangeschar*arg;//userinputthatmatchesthistokenchar*varname;structgraph_no
de*forkjoin;//pairedFORK/JOINforJOIN/FORK};/*Structureofcommandelement.*/structc
md_element{constchar*string;/*Commandspecificationbystring.*/constchar*doc;/*Doc
umentationofthiscommand.*/intdaemon;/*Daemontowhichthiscommandbelong.*/uint8_tat
tr;/*Commandattributes*//*handlerfunctionforcommand*/int(*func)(conststructcmd_e
lement*,structvty*,int,structcmd_token*[]);constchar*name;/*symbolnamefordebuggi
ng*/};/*textfor<cr>command*/#defineCMD_CR_TEXT"<cr>"/*memorymanagementforcmd_tok
en*/externstructcmd_token*cmd_token_new(enumcmd_token_type,uint8_tattr,constchar
*text,constchar*desc);externstructcmd_token*cmd_token_dup(structcmd_token*);exte
rnvoidcmd_token_del(structcmd_token*);externvoidcmd_token_varname_set(structcmd_
token*token,constchar*varname);externvoidcmd_graph_parse(structgraph*graph,struc
tcmd_element*cmd);externvoidcmd_graph_names(structgraph*graph);externvoidcmd_gra
ph_merge(structgraph*old,structgraph*new,intdirection);#endif/*_FRR_COMMAND_GRAP
H_H*/