/*ICMPRouterDiscoveryMessages*Copyright(C)1997,2000KunihiroIshiguro**Thisfileisp
artofGNUZebra.**GNUZebraisfreesoftware;youcanredistributeitand/ormodifyit*undert
hetermsoftheGNUGeneralPublicLicenseaspublishedbythe*FreeSoftwareFoundation;eithe
rversion2,or(atyouroption)any*laterversion.**GNUZebraisdistributedinthehopethati
twillbeuseful,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABI
LITYorFITNESSFORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.
**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;se
ethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthF
loor,Boston,MA02110-1301USA*//**ThisfileismodifiedandcompletedfortheZebraIRDPimp
lementation*byRobertOlsson,SwedishUniversityofAgriculturalSciences*/#ifndef_IRDP
_H#define_IRDP_H#include"lib/vty.h"#defineTRUE1#defineFALSE0/*ICMPMessages*/#ifn
defICMP_ROUTERADVERT#defineICMP_ROUTERADVERT9#endif/*ICMP_ROUTERADVERT*/#ifndefI
CMP_ROUTERSOLICIT#defineICMP_ROUTERSOLICIT10#endif/*ICMP_ROUTERSOLICT*//*Multica
stgroups*/#ifndefINADDR_ALLHOSTS_GROUP#defineINADDR_ALLHOSTS_GROUP0xe0000001U/*2
24.0.0.1*/#endif/*INADDR_ALLHOSTS_GROUP*/#ifndefINADDR_ALLRTRS_GROUP#defineINADD
R_ALLRTRS_GROUP0xe0000002U/*224.0.0.2*/#endif/*INADDR_ALLRTRS_GROUP*//*Defaultir
dppacketinterval*/#defineIRDP_DEFAULT_INTERVAL300/*RouterconstantsfromRFC1256*/#
defineMAX_INITIAL_ADVERT_INTERVAL16#defineMAX_INITIAL_ADVERTISEMENTS3#defineMAX_
RESPONSE_DELAY2#defineIRDP_MAXADVERTINTERVAL600#defineIRDP_MINADVERTINTERVAL450/
*0.75*600*/#defineIRDP_LIFETIME1350/*3*450*/#defineIRDP_PREFERENCE0#defineICMP_M
INLEN8#defineIRDP_LAST_ADVERT_MESSAGES2/*ThelastadvertswithHoldtime0*/#defineIRD
P_RX_BUF1500/*CommentscomesfromRFC1256ICMPRouterDiscoveryMessages.TheIPdestinati
onaddresstobeusedformulticastRouterAdvertisementssentfromtheinterface.Theonlyper
missiblevaluesaretheall-systemsmulticastaddress,224.0.0.1,orthelimited-broadcast
address,255.255.255.255.(Theall-systemsaddressispreferredwhereverpossible,i.e.,o
nanylinkwherealllisteninghostssupportIPmulticast.)Default:224.0.0.1iftheroutersu
pportsIPmulticastontheinterface,else255.255.255.255Themaximumtimeallowedbetweens
endingmulticastRouterAdvertisementsfromtheinterface,inseconds.Mustbenolessthan4s
econdsandnogreaterthan1800seconds.Default:600secondsTheminimumtimeallowedbetween
sendingunsolicitedmulticastRouterAdvertisementsfromtheinterface,inseconds.Mustbe
nolessthan3secondsandnogreaterthanMaxAdvertisementInterval.Default:0.75*MaxAdver
tisementIntervalThevaluetobeplacedintheLifetimefieldofRouterAdvertisementssentfr
omtheinterface,inseconds.MustbenolessthanMaxAdvertisementIntervalandnogreatertha
n9000seconds.Default:3*MaxAdvertisementIntervalThepreferabilityoftheaddressasade
faultrouteraddress,relativetootherrouteraddressesonthesamesubnet.A32-bit,signed,
twos-complementinteger,withhighervaluesmeaningmorepreferable.Theminimumvalue(hex
80000000)isusedtoindicatethattheaddress,eventhoughitmaybeadvertised,isnottobeuse
dbyneighboringhostsasadefaultrouteraddress.Default:0*/structirdp_interface{bools
tarted;unsignedlongMaxAdvertInterval;unsignedlongMinAdvertInterval;unsignedlongP
reference;uint32_tflags;#defineIF_ACTIVE(1<<0)/*ICMPActive*/#defineIF_BROADCAST(
1<<1)/*255.255.255.255*/#defineIF_SOLICIT(1<<2)/*Solicitactive*/#defineIF_DEBUG_
MESSAGES(1<<3)#defineIF_DEBUG_PACKET(1<<4)#defineIF_DEBUG_MISC(1<<5)#defineIF_SH
UTDOWN(1<<6)structinterface*ifp;structthread*t_advertise;unsignedlongirdp_sent;u
int16_tLifetime;structlist*AdvPrefList;};structAdv{structin_addrip;intpref;};ext
ernvoidirdp_if_init(void);externintirdp_sock_init(void);externintirdp_config_wri
te(structvty*,structinterface*);externintirdp_send_thread(structthread*t_advert)
;externvoidirdp_advert_off(structinterface*ifp);externvoidprocess_solicit(struct
interface*ifp);externintirdp_read_raw(structthread*r);externvoidsend_packet(stru
ctinterface*ifp,structstream*s,uint32_tdst,structprefix*p,uint32_tttl);#endif/*_
IRDP_H*/