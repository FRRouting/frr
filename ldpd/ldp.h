/*$OpenBSD$*//**Copyright(c)2013,2016RenatoWestphal<renato@openbsd.org>*Copyrigh
t(c)2009MicheleMarchetto<michele@openbsd.org>*Copyright(c)2004,2005,2008EsbenNor
by<norby@openbsd.org>**Permissiontouse,copy,modify,anddistributethissoftwarefora
ny*purposewithorwithoutfeeisherebygranted,providedthattheabove*copyrightnoticean
dthispermissionnoticeappearinallcopies.**THESOFTWAREISPROVIDED"ASIS"ANDTHEAUTHOR
DISCLAIMSALLWARRANTIES*WITHREGARDTOTHISSOFTWAREINCLUDINGALLIMPLIEDWARRANTIESOF*M
ERCHANTABILITYANDFITNESS.INNOEVENTSHALLTHEAUTHORBELIABLEFOR*ANYSPECIAL,DIRECT,IN
DIRECT,ORCONSEQUENTIALDAMAGESORANYDAMAGES*WHATSOEVERRESULTINGFROMLOSSOFUSE,DATAO
RPROFITS,WHETHERINAN*ACTIONOFCONTRACT,NEGLIGENCEOROTHERTORTIOUSACTION,ARISINGOUT
OF*ORINCONNECTIONWITHTHEUSEORPERFORMANCEOFTHISSOFTWARE.*//*LDPprotocoldefinition
s*/#ifndef_LDP_H_#define_LDP_H_/*misc*/#defineLDP_VERSION1#defineLDP_PORT646#def
ineLDP_MAX_LEN4096/*AllRoutersonthisSubnetgroupmulticastaddresses*/#defineAllRou
ters_v4"224.0.0.2"#defineAllRouters_v6"ff02::2"#defineLINK_DFLT_HOLDTIME15#defin
eTARGETED_DFLT_HOLDTIME45#defineMIN_HOLDTIME3#defineMAX_HOLDTIME0xffff#defineINF
INITE_HOLDTIME0xffff#defineDEFAULT_KEEPALIVE180#defineMIN_KEEPALIVE3#defineMAX_K
EEPALIVE0xffff#defineKEEPALIVE_PER_PERIOD3#defineINIT_FSM_TIMEOUT15#defineDEFAUL
T_HELLO_INTERVAL5#defineMIN_HELLO_INTERVAL1#defineMAX_HELLO_INTERVAL0xffff#defin
eINIT_DELAY_TMR15#defineMAX_DELAY_TMR120#defineMIN_PWID_ID1#defineMAX_PWID_ID0xf
fffffff#defineDEFAULT_L2VPN_MTU1500#defineMIN_L2VPN_MTU512#defineMAX_L2VPN_MTU0x
ffff/*LDPmessagetypes*/#defineMSG_TYPE_NOTIFICATION0x0001#defineMSG_TYPE_HELLO0x
0100#defineMSG_TYPE_INIT0x0200#defineMSG_TYPE_KEEPALIVE0x0201#defineMSG_TYPE_CAP
ABILITY0x0202/*RFC5561*/#defineMSG_TYPE_ADDR0x0300#defineMSG_TYPE_ADDRWITHDRAW0x
0301#defineMSG_TYPE_LABELMAPPING0x0400#defineMSG_TYPE_LABELREQUEST0x0401#defineM
SG_TYPE_LABELWITHDRAW0x0402#defineMSG_TYPE_LABELRELEASE0x0403#defineMSG_TYPE_LAB
ELABORTREQ0x0404/*LDPTLVtypes*/#defineTLV_TYPE_FEC0x0100#defineTLV_TYPE_ADDRLIST
0x0101#defineTLV_TYPE_HOPCOUNT0x0103#defineTLV_TYPE_PATHVECTOR0x0104#defineTLV_T
YPE_GENERICLABEL0x0200#defineTLV_TYPE_ATMLABEL0x0201#defineTLV_TYPE_FRLABEL0x020
2#defineTLV_TYPE_STATUS0x0300#defineTLV_TYPE_EXTSTATUS0x0301#defineTLV_TYPE_RETU
RNEDPDU0x0302#defineTLV_TYPE_RETURNEDMSG0x0303#defineTLV_TYPE_COMMONHELLO0x0400#
defineTLV_TYPE_IPV4TRANSADDR0x0401#defineTLV_TYPE_CONFIG0x0402#defineTLV_TYPE_IP
V6TRANSADDR0x0403#defineTLV_TYPE_COMMONSESSION0x0500#defineTLV_TYPE_ATMSESSIONPA
R0x0501#defineTLV_TYPE_FRSESSION0x0502#defineTLV_TYPE_LABELREQUEST0x0600/*RFC444
7*/#defineTLV_TYPE_MAC_LIST0x8404#defineTLV_TYPE_PW_STATUS0x896A#defineTLV_TYPE_
PW_IF_PARAM0x096B#defineTLV_TYPE_PW_GROUP_ID0x096C/*RFC5561*/#defineTLV_TYPE_RET
URNED_TLVS0x8304#defineTLV_TYPE_DYNAMIC_CAP0x8506/*RFC5918*/#defineTLV_TYPE_TWCA
RD_CAP0x850B/*RFC5919*/#defineTLV_TYPE_UNOTIF_CAP0x8603/*RFC7552*/#defineTLV_TYP
E_DUALSTACK0x8701/*LDPheader*/structldp_hdr{uint16_tversion;uint16_tlength;uint3
2_tlsr_id;uint16_tlspace_id;}__attribute__((packed));#defineLDP_HDR_SIZE10/*actu
alsizeoftheLDPheader*/#defineLDP_HDR_PDU_LEN6/*minimum"PDULength"*/#defineLDP_HD
R_DEAD_LEN4/*TLVrecord*/structtlv{uint16_ttype;uint16_tlength;};#defineTLV_HDR_S
IZE4structldp_msg{uint16_ttype;uint16_tlength;uint32_tid;/*MandatoryParameters*/
/*OptionalParameters*/}__attribute__((packed));#defineLDP_MSG_SIZE8/*minimumsize
ofLDPmessage*/#defineLDP_MSG_LEN4/*minimum"MessageLength"*/#defineLDP_MSG_DEAD_L
EN4#defineUNKNOWN_FLAG0x8000#defineFORWARD_FLAG0xc000structhello_prms_tlv{uint16
_ttype;uint16_tlength;uint16_tholdtime;uint16_tflags;};#defineF_HELLO_TARGETED0x
8000#defineF_HELLO_REQ_TARG0x4000#defineF_HELLO_GTSM0x2000structhello_prms_opt4_
tlv{uint16_ttype;uint16_tlength;uint32_tvalue;};structhello_prms_opt16_tlv{uint1
6_ttype;uint16_tlength;uint8_tvalue[16];};#defineDUAL_STACK_LDPOV44#defineDUAL_S
TACK_LDPOV66#defineF_HELLO_TLV_RCVD_ADDR0x01#defineF_HELLO_TLV_RCVD_CONF0x02#def
ineF_HELLO_TLV_RCVD_DS0x04#defineS_SUCCESS0x00000000#defineS_BAD_LDP_ID0x8000000
1#defineS_BAD_PROTO_VER0x80000002#defineS_BAD_PDU_LEN0x80000003#defineS_UNKNOWN_
MSG0x00000004#defineS_BAD_MSG_LEN0x80000005#defineS_UNKNOWN_TLV0x00000006#define
S_BAD_TLV_LEN0x80000007#defineS_BAD_TLV_VAL0x80000008#defineS_HOLDTIME_EXP0x8000
0009#defineS_SHUTDOWN0x8000000A#defineS_LOOP_DETECTED0x0000000B#defineS_UNKNOWN_
FEC0x0000000C#defineS_NO_ROUTE0x0000000D#defineS_NO_LABEL_RES0x0000000E#defineS_
AVAILABLE0x0000000F#defineS_NO_HELLO0x80000010#defineS_PARM_ADV_MODE0x80000011#d
efineS_MAX_PDU_LEN0x80000012#defineS_PARM_L_RANGE0x80000013#defineS_KEEPALIVE_TM
R0x80000014#defineS_LAB_REQ_ABRT0x00000015#defineS_MISS_MSG0x00000016#defineS_UN
SUP_ADDR0x00000017#defineS_KEEPALIVE_BAD0x80000018#defineS_INTERN_ERR0x80000019/
*RFC4447*/#defineS_ILLEGAL_CBIT0x00000024#defineS_WRONG_CBIT0x00000025#defineS_I
NCPT_BITRATE0x00000026#defineS_CEP_MISCONF0x00000027#defineS_PW_STATUS0x00000028
#defineS_UNASSIGN_TAI0x00000029#defineS_MISCONF_ERR0x0000002A#defineS_WITHDRAW_M
THD0x0000002B/*RFC5561*/#defineS_UNSSUPORTDCAP0x0000002E/*RFC5919*/#defineS_ENDO
FLIB0x0000002F/*RFC7552*/#defineS_TRANS_MISMTCH0x80000032#defineS_DS_NONCMPLNCE0
x80000033structsess_prms_tlv{uint16_ttype;uint16_tlength;uint16_tproto_version;u
int16_tkeepalive_time;uint8_treserved;uint8_tpvlim;uint16_tmax_pdu_len;uint32_tl
sr_id;uint16_tlspace_id;}__attribute__((packed));#defineSESS_PRMS_SIZE18#defineS
ESS_PRMS_LEN14structstatus_tlv{uint16_ttype;uint16_tlength;uint32_tstatus_code;u
int32_tmsg_id;uint16_tmsg_type;}__attribute__((packed));#defineSTATUS_SIZE14#def
ineSTATUS_TLV_LEN10#defineSTATUS_FATAL0x80000000structcapability_tlv{uint16_ttyp
e;uint16_tlength;uint8_treserved;};#defineSTATE_BIT0x80#defineF_CAP_TLV_RCVD_DYN
AMIC0x01#defineF_CAP_TLV_RCVD_TWCARD0x02#defineF_CAP_TLV_RCVD_UNOTIF0x04#defineC
AP_TLV_DYNAMIC_SIZE5#defineCAP_TLV_DYNAMIC_LEN1#defineCAP_TLV_TWCARD_SIZE5#defin
eCAP_TLV_TWCARD_LEN1#defineCAP_TLV_UNOTIF_SIZE5#defineCAP_TLV_UNOTIF_LEN1#define
AF_IPV40x1#defineAF_IPV60x2structaddress_list_tlv{uint16_ttype;uint16_tlength;ui
nt16_tfamily;/*addressentries*/}__attribute__((packed));#defineADDR_LIST_SIZE6#d
efineFEC_ELM_WCARD_LEN1#defineFEC_ELM_PREFIX_MIN_LEN4#defineFEC_PWID_ELM_MIN_LEN
8#defineFEC_PWID_SIZE4#defineFEC_ELM_TWCARD_MIN_LEN3#defineMAP_TYPE_WILDCARD0x01
#defineMAP_TYPE_PREFIX0x02#defineMAP_TYPE_TYPED_WCARD0x05#defineMAP_TYPE_PWID0x8
0#defineMAP_TYPE_GENPWID0x81#defineCONTROL_WORD_FLAG0x8000#defineDEFAULT_PW_TYPE
PW_TYPE_ETHERNET#definePW_TWCARD_RESERVED_BIT0x8000/*RFC4447Sub-TLVrecord*/struc
tsubtlv{uint8_ttype;uint8_tlength;};#defineSUBTLV_HDR_SIZE2#defineSUBTLV_IFMTU0x
01#defineSUBTLV_VLANID0x06#defineFEC_SUBTLV_IFMTU_SIZE4#defineFEC_SUBTLV_VLANID_
SIZE4structlabel_tlv{uint16_ttype;uint16_tlength;uint32_tlabel;};#defineLABEL_TL
V_SIZE8#defineLABEL_TLV_LEN4structreqid_tlv{uint16_ttype;uint16_tlength;uint32_t
reqid;};#defineREQID_TLV_SIZE8#defineREQID_TLV_LEN4structpw_status_tlv{uint16_tt
ype;uint16_tlength;uint32_tvalue;};#definePW_STATUS_TLV_SIZE8#definePW_STATUS_TL
V_LEN4#definePW_FORWARDING0#definePW_NOT_FORWARDING(1<<0)#definePW_LOCAL_RX_FAUL
T(1<<1)#definePW_LOCAL_TX_FAULT(1<<2)#definePW_PSN_RX_FAULT(1<<3)#definePW_PSN_T
X_FAULT(1<<4)#defineNO_LABELUINT32_MAX#endif/*!_LDP_H_*/