/**Copyright(C)2016byOpenSourceRouting.**Thisprogramisfreesoftware;youcanredistr
ibuteitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseaspublishedby*the
FreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption)anylaterversi
on.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHOUTANYWARRANTY;
withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTICULARPURPOSE.Se
etheGNU*GeneralPublicLicenseformoredetails.**YoushouldhavereceivedacopyoftheGNUG
eneralPublicLicense*alongwiththisprogram;seethefileCOPYING;ifnot,writetothe*Free
SoftwareFoundation,Inc.,51FranklinSt,FifthFloor,Boston,*MA02110-1301USA*/#includ
e<zebra.h>#include"command.h"#include"vty.h"#include"ldpd.h"#include"ldp_debug.h
"#include"ldp_vty.h"structldp_debugconf_ldp_debug;structldp_debugldp_debug;/*Deb
ugnode.*/structcmd_nodeldp_debug_node={DEBUG_NODE,"",1};intldp_vty_debug(structv
ty*vty,constchar*negate,constchar*type_str,constchar*dir_str,constchar*all){if(s
trcmp(type_str,"discovery")==0){if(dir_str==NULL)return(CMD_WARNING_CONFIG_FAILE
D);if(dir_str[0]=='r'){if(negate)DEBUG_OFF(hello,LDP_DEBUG_HELLO_RECV);elseDEBUG
_ON(hello,LDP_DEBUG_HELLO_RECV);}else{if(negate)DEBUG_OFF(hello,LDP_DEBUG_HELLO_
SEND);elseDEBUG_ON(hello,LDP_DEBUG_HELLO_SEND);}}elseif(strcmp(type_str,"errors"
)==0){if(negate)DEBUG_OFF(errors,LDP_DEBUG_ERRORS);elseDEBUG_ON(errors,LDP_DEBUG
_ERRORS);}elseif(strcmp(type_str,"event")==0){if(negate)DEBUG_OFF(event,LDP_DEBU
G_EVENT);elseDEBUG_ON(event,LDP_DEBUG_EVENT);}elseif(strcmp(type_str,"labels")==
0){if(negate)DEBUG_OFF(labels,LDP_DEBUG_LABELS);elseDEBUG_ON(labels,LDP_DEBUG_LA
BELS);}elseif(strcmp(type_str,"messages")==0){if(dir_str==NULL)return(CMD_WARNIN
G_CONFIG_FAILED);if(dir_str[0]=='r'){if(negate){DEBUG_OFF(msg,LDP_DEBUG_MSG_RECV
);DEBUG_OFF(msg,LDP_DEBUG_MSG_RECV_ALL);}else{DEBUG_ON(msg,LDP_DEBUG_MSG_RECV);i
f(all)DEBUG_ON(msg,LDP_DEBUG_MSG_RECV_ALL);}}else{if(negate){DEBUG_OFF(msg,LDP_D
EBUG_MSG_SEND);DEBUG_OFF(msg,LDP_DEBUG_MSG_SEND_ALL);}else{DEBUG_ON(msg,LDP_DEBU
G_MSG_SEND);if(all)DEBUG_ON(msg,LDP_DEBUG_MSG_SEND_ALL);}}}elseif(strcmp(type_st
r,"zebra")==0){if(negate)DEBUG_OFF(zebra,LDP_DEBUG_ZEBRA);elseDEBUG_ON(zebra,LDP
_DEBUG_ZEBRA);}main_imsg_compose_both(IMSG_DEBUG_UPDATE,&ldp_debug,sizeof(ldp_de
bug));return(CMD_SUCCESS);}intldp_vty_show_debugging(structvty*vty){vty_out(vty,
"LDPdebuggingstatus:\n");if(LDP_DEBUG(hello,LDP_DEBUG_HELLO_RECV))vty_out(vty,"L
DPdiscoverydebuggingison(inbound)\n");if(LDP_DEBUG(hello,LDP_DEBUG_HELLO_SEND))v
ty_out(vty,"LDPdiscoverydebuggingison(outbound)\n");if(LDP_DEBUG(errors,LDP_DEBU
G_ERRORS))vty_out(vty,"LDPerrorsdebuggingison\n");if(LDP_DEBUG(event,LDP_DEBUG_E
VENT))vty_out(vty,"LDPeventsdebuggingison\n");if(LDP_DEBUG(labels,LDP_DEBUG_LABE
LS))vty_out(vty,"LDPlabelsdebuggingison\n");if(LDP_DEBUG(msg,LDP_DEBUG_MSG_RECV_
ALL))vty_out(vty,"LDPdetailedmessagesdebuggingison(inbound)\n");elseif(LDP_DEBUG
(msg,LDP_DEBUG_MSG_RECV))vty_out(vty,"LDPmessagesdebuggingison(inbound)\n");if(L
DP_DEBUG(msg,LDP_DEBUG_MSG_SEND_ALL))vty_out(vty,"LDPdetailedmessagesdebuggingis
on(outbound)\n");elseif(LDP_DEBUG(msg,LDP_DEBUG_MSG_SEND))vty_out(vty,"LDPmessag
esdebuggingison(outbound)\n");if(LDP_DEBUG(zebra,LDP_DEBUG_ZEBRA))vty_out(vty,"L
DPzebradebuggingison\n");vty_out(vty,"\n");return(CMD_SUCCESS);}intldp_debug_con
fig_write(structvty*vty){intwrite=0;if(CONF_LDP_DEBUG(hello,LDP_DEBUG_HELLO_RECV
)){vty_out(vty,"debugmplsldpdiscoveryhellorecv\n");write=1;}if(CONF_LDP_DEBUG(he
llo,LDP_DEBUG_HELLO_SEND)){vty_out(vty,"debugmplsldpdiscoveryhellosent\n");write
=1;}if(CONF_LDP_DEBUG(errors,LDP_DEBUG_ERRORS)){vty_out(vty,"debugmplsldperrors\
n");write=1;}if(CONF_LDP_DEBUG(event,LDP_DEBUG_EVENT)){vty_out(vty,"debugmplsldp
event\n");write=1;}if(CONF_LDP_DEBUG(labels,LDP_DEBUG_LABELS)){vty_out(vty,"debu
gmplsldplabels\n");write=1;}if(CONF_LDP_DEBUG(msg,LDP_DEBUG_MSG_RECV_ALL)){vty_o
ut(vty,"debugmplsldpmessagesrecvall\n");write=1;}elseif(CONF_LDP_DEBUG(msg,LDP_D
EBUG_MSG_RECV)){vty_out(vty,"debugmplsldpmessagesrecv\n");write=1;}if(CONF_LDP_D
EBUG(msg,LDP_DEBUG_MSG_SEND_ALL)){vty_out(vty,"debugmplsldpmessagessentall\n");w
rite=1;}elseif(CONF_LDP_DEBUG(msg,LDP_DEBUG_MSG_SEND)){vty_out(vty,"debugmplsldp
messagessent\n");write=1;}if(CONF_LDP_DEBUG(zebra,LDP_DEBUG_ZEBRA)){vty_out(vty,
"debugmplsldpzebra\n");write=1;}return(write);}