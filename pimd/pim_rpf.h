/**PIMforQuagga*Copyright(C)2008EvertondaSilvaMarques**Thisprogramisfreesoftware
;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseasp
ublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption
)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHO
UTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTIC
ULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceived
acopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,w
ritetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-130
1USA*/#ifndefPIM_RPF_H#definePIM_RPF_H#include<zebra.h>#include"pim_upstream.h"#
include"pim_neighbor.h"/*RFC4601:MetricPreferencePreferencevalueassignedtotheuni
castroutingprotocolthatprovidedtheroutetothemulticastsourceorRendezvous-Point.Me
tricTheunicastroutingtablemetricassociatedwiththerouteusedtoreachthemulticastsou
rceorRendezvous-Point.Themetricisinunitsapplicabletotheunicastroutingprotocoluse
d.*/structpim_nexthop{structin_addrlast_lookup;longlonglast_lookup_time;structin
terface*interface;/*RPF_interface(S)*/structprefixmrib_nexthop_addr;/*MRIB.next_
hop(S)*/uint32_tmrib_metric_preference;/*MRIB.pref(S)*/uint32_tmrib_route_metric
;/*MRIB.metric(S)*/structpim_neighbor*nbr;};structpim_rpf{structpim_nexthopsourc
e_nexthop;structprefixrpf_addr;/*RPF'(S,G)*/};enumpim_rpf_result{PIM_RPF_OK=0,PI
M_RPF_CHANGED,PIM_RPF_FAILURE};structpim_upstream;unsignedintpim_rpf_hash_key(vo
id*arg);intpim_rpf_equal(constvoid*arg1,constvoid*arg2);intpim_nexthop_lookup(st
ructpim_instance*pim,structpim_nexthop*nexthop,structin_addraddr,intneighbor_nee
ded);enumpim_rpf_resultpim_rpf_update(structpim_instance*pim,structpim_upstream*
up,structpim_rpf*old,uint8_tis_new);intpim_rpf_addr_is_inaddr_none(structpim_rpf
*rpf);intpim_rpf_addr_is_inaddr_any(structpim_rpf*rpf);intpim_rpf_is_same(struct
pim_rpf*rpf1,structpim_rpf*rpf2);voidpim_rpf_set_refresh_time(structpim_instance
*pim);#endif/*PIM_RPF_H*/