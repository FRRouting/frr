/**PIMforQuagga*Copyright(C)2008EvertondaSilvaMarques**Thisprogramisfreesoftware
;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseasp
ublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption
)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHO
UTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTIC
ULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceived
acopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,w
ritetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-130
1USA*/#ifndefPIM_SOCK_H#definePIM_SOCK_H#include<netinet/in.h>#definePIM_SOCK_ER
R_NONE(0)/*Noerror*/#definePIM_SOCK_ERR_SOCKET(-1)/*socket()*/#definePIM_SOCK_ER
R_RA(-2)/*RouterAlertoption*/#definePIM_SOCK_ERR_REUSE(-3)/*Reuseoption*/#define
PIM_SOCK_ERR_TTL(-4)/*TTLoption*/#definePIM_SOCK_ERR_LOOP(-5)/*Loopbackoption*/#
definePIM_SOCK_ERR_IFACE(-6)/*Outgoinginterfaceoption*/#definePIM_SOCK_ERR_DSTAD
DR(-7)/*Outgoinginterfaceoption*/#definePIM_SOCK_ERR_NONBLOCK_GETFL(-8)/*GetO_NO
NBLOCK*/#definePIM_SOCK_ERR_NONBLOCK_SETFL(-9)/*SetO_NONBLOCK*/#definePIM_SOCK_E
RR_NAME(-10)/*Socketname(getsockname)*/#definePIM_SOCK_ERR_BIND(-11)/*Can'tbindt
ointerface*/intpim_socket_bind(intfd,structinterface*ifp);voidpim_socket_ip_hdr(
intfd);intpim_socket_raw(intprotocol);intpim_socket_mcast(intprotocol,structin_a
ddrifaddr,structinterface*ifp,uint8_tloop);intpim_socket_join(intfd,structin_add
rgroup,structin_addrifaddr,ifindex_tifindex);intpim_socket_join_source(intfd,ifi
ndex_tifindex,structin_addrgroup_addr,structin_addrsource_addr,constchar*ifname)
;intpim_socket_recvfromto(intfd,uint8_t*buf,size_tlen,structsockaddr_in*from,soc
klen_t*fromlen,structsockaddr_in*to,socklen_t*tolen,ifindex_t*ifindex);intpim_so
cket_mcastloop_get(intfd);intpim_socket_getsockname(intfd,structsockaddr*name,so
cklen_t*namelen);#endif/*PIM_SOCK_H*/