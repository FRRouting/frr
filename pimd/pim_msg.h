/**PIMforQuagga*Copyright(C)2008EvertondaSilvaMarques**Thisprogramisfreesoftware
;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseasp
ublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption
)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHO
UTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTIC
ULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceived
acopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,w
ritetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-130
1USA*/#ifndefPIM_MSG_H#definePIM_MSG_H#include<netinet/in.h>#include"pim_jp_agg.
h"/*NumberDescription----------------------------0Reserved1IP(IPversion4)2IP6(IP
version6)From:http://www.iana.org/assignments/address-family-numbers*/enumpim_ms
g_address_family{PIM_MSG_ADDRESS_FAMILY_RESERVED,PIM_MSG_ADDRESS_FAMILY_IPV4,PIM
_MSG_ADDRESS_FAMILY_IPV6,};/**NetworkOrderpim_msg_hdr*/structpim_msg_header{uint
8_ttype:4;uint8_tver:4;uint8_treserved;uint16_tchecksum;}__attribute__((packed))
;structpim_encoded_ipv4_unicast{uint8_tfamily;uint8_treserved;structin_addraddr;
}__attribute__((packed));structpim_encoded_group_ipv4{uint8_tne;uint8_tfamily;ui
nt8_treserved;uint8_tmask;structin_addraddr;}__attribute__((packed));structpim_e
ncoded_source_ipv4{uint8_tne;uint8_tfamily;uint8_tbits;uint8_tmask;structin_addr
addr;}__attribute__((packed));structpim_jp_groups{structpim_encoded_group_ipv4g;
uint16_tjoins;uint16_tprunes;structpim_encoded_source_ipv4s[1];}__attribute__((p
acked));structpim_jp{structpim_msg_headerheader;structpim_encoded_ipv4_unicastad
dr;uint8_treserved;uint8_tnum_groups;uint16_tholdtime;structpim_jp_groupsgroups[
1];}__attribute__((packed));voidpim_msg_build_header(uint8_t*pim_msg,size_tpim_m
sg_size,uint8_tpim_msg_type);uint8_t*pim_msg_addr_encode_ipv4_ucast(uint8_t*buf,
structin_addraddr);uint8_t*pim_msg_addr_encode_ipv4_group(uint8_t*buf,structin_a
ddraddr);#definePIM_ENCODE_SPARSE_BIT0x04#definePIM_ENCODE_WC_BIT0x02#definePIM_
ENCODE_RPT_BIT0x01uint8_t*pim_msg_addr_encode_ipv4_source(uint8_t*buf,structin_a
ddraddr,uint8_tbits);size_tpim_msg_get_jp_group_size(structlist*sources);size_tp
im_msg_build_jp_groups(structpim_jp_groups*grp,structpim_jp_agg_group*sgs,size_t
size);#endif/*PIM_MSG_H*/