/**PIMforQuagga*Copyright(C)2008EvertondaSilvaMarques**Thisprogramisfreesoftware
;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseasp
ublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption
)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHO
UTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTIC
ULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceived
acopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,w
ritetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-130
1USA*/#ifndefPIM_IGMPV3_H#definePIM_IGMPV3_H#include<zebra.h>#include"if.h"#defi
neIGMP_V3_CHECKSUM_OFFSET(2)#defineIGMP_V3_REPORT_NUMGROUPS_OFFSET(6)#defineIGMP
_V3_REPORT_GROUPPRECORD_OFFSET(8)#defineIGMP_V3_NUMSOURCES_OFFSET(10)#defineIGMP
_V3_SOURCES_OFFSET(12)#defineIGMP_GRP_REC_TYPE_MODE_IS_INCLUDE(1)#defineIGMP_GRP
_REC_TYPE_MODE_IS_EXCLUDE(2)#defineIGMP_GRP_REC_TYPE_CHANGE_TO_INCLUDE_MODE(3)#d
efineIGMP_GRP_REC_TYPE_CHANGE_TO_EXCLUDE_MODE(4)#defineIGMP_GRP_REC_TYPE_ALLOW_N
EW_SOURCES(5)#defineIGMP_GRP_REC_TYPE_BLOCK_OLD_SOURCES(6)/*GMI:GroupMembershipI
nterval*/#definePIM_IGMP_GMI_MSEC(qrv,qqi,qri_dsec)((qrv)*(1000*(qqi))+100*(qri_
dsec))/*OQPI:OtherQuerierPresentInterval*/#definePIM_IGMP_OQPI_MSEC(qrv,qqi,qri_
dsec)((qrv)*(1000*(qqi))+100*((qri_dsec)>>1))/*SQI:StartupQueryInterval*/#define
PIM_IGMP_SQI(qi)(((qi)<4)?1:((qi)>>2))/*LMQT:LastMemberQueryTime*/#definePIM_IGM
P_LMQT_MSEC(lmqi_dsec,lmqc)((lmqc)*(100*(lmqi_dsec)))/*OHPI:OlderHostPresentInte
rval*/#definePIM_IGMP_OHPI_DSEC(qrv,qqi,qri_dsec)((qrv)*(10*(qqi))+(qri_dsec))vo
idigmp_group_reset_gmi(structigmp_group*group);voidigmp_source_reset_gmi(structi
gmp_sock*igmp,structigmp_group*group,structigmp_source*source);voidigmp_source_f
ree(structigmp_source*source);voidigmp_source_delete(structigmp_source*source);v
oidigmp_source_delete_expired(structlist*source_list);voidigmpv3_report_isin(str
uctigmp_sock*igmp,structin_addrfrom,structin_addrgroup_addr,intnum_sources,struc
tin_addr*sources);voidigmpv3_report_isex(structigmp_sock*igmp,structin_addrfrom,
structin_addrgroup_addr,intnum_sources,structin_addr*sources,intfrom_igmp_v2_rep
ort);voidigmpv3_report_toin(structigmp_sock*igmp,structin_addrfrom,structin_addr
group_addr,intnum_sources,structin_addr*sources);voidigmpv3_report_toex(structig
mp_sock*igmp,structin_addrfrom,structin_addrgroup_addr,intnum_sources,structin_a
ddr*sources);voidigmpv3_report_allow(structigmp_sock*igmp,structin_addrfrom,stru
ctin_addrgroup_addr,intnum_sources,structin_addr*sources);voidigmpv3_report_bloc
k(structigmp_sock*igmp,structin_addrfrom,structin_addrgroup_addr,intnum_sources,
structin_addr*sources);voidigmp_group_timer_lower_to_lmqt(structigmp_group*group
);voidigmp_source_timer_lower_to_lmqt(structigmp_source*source);structigmp_sourc
e*igmp_find_source_by_addr(structigmp_group*group,structin_addrsrc_addr);voidigm
p_v3_send_query(structigmp_group*group,intfd,constchar*ifname,char*query_buf,int
query_buf_size,intnum_sources,structin_addrdst_addr,structin_addrgroup_addr,intq
uery_max_response_time_dsec,uint8_ts_flag,uint8_tquerier_robustness_variable,uin
t16_tquerier_query_interval);voidigmp_v3_recv_query(structigmp_sock*igmp,constch
ar*from_str,char*igmp_msg);intigmp_v3_recv_report(structigmp_sock*igmp,structin_
addrfrom,constchar*from_str,char*igmp_msg,intigmp_msg_len);#endif/*PIM_IGMPV3_H*
/