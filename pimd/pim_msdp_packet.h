/**IPMSDPpackethelpers*Copyright(C)2016CumulusNetworks,Inc.**Thisprogramisfreeso
ftware;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLice
nseaspublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyour
option)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but
*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORA
PARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavere
ceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;i
fnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA021
10-1301USA*/#ifndefPIM_MSDP_PACKET_H#definePIM_MSDP_PACKET_H/*typeandlengthofasi
ngletlvcanbeconsiderpacketheader*/#definePIM_MSDP_HEADER_SIZE3/*KeepaliveTLV0123
01234567890123456789012345678901+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
+-+-+-+-+-+-+-+-+|4|3|+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+*/#define
PIM_MSDP_KA_TLV_MAX_SIZEPIM_MSDP_HEADER_SIZE/*Source-ActiveTLV(x=8,y=12xEntryCou
nt)012301234567890123456789012345678901+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-+-+-+-+-+-+-+-+-+-+-+-+|1|x+y|EntryCount|+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
+-+-+-+-+-+-+-+-+-+-+-+-+-+|RPAddress|+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
+-+-+-+-+-+-+-+-+-+-+-+|Reserved|SprefixLen|\+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\|GroupAddress|)z+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/|SourceAddress|/+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+*/#definePIM_MSDP_SA_TLV_MAX_SIZE9192#definePI
M_MSDP_SA_X_SIZE8#definePIM_MSDP_SA_ONE_ENTRY_SIZE12#definePIM_MSDP_SA_Y_SIZE(en
try_cnt)(PIM_MSDP_SA_ONE_ENTRY_SIZE*entry_cnt)#definePIM_MSDP_SA_ENTRY_CNT2SIZE(
entry_cnt)\(PIM_MSDP_SA_X_SIZE+PIM_MSDP_SA_Y_SIZE(entry_cnt))/*SATLVhastohaveatl
eastonlyoneentryinitsox=8+y=12*/#definePIM_MSDP_SA_TLV_MIN_SIZEPIM_MSDP_SA_ENTRY
_CNT2SIZE(1)/*XXX:theoreticallywecanfixamaxof255butthatmayresultinpacket*fragmen
tation*/#definePIM_MSDP_SA_MAX_ENTRY_CNT120#definePIM_MSDP_MAX_PACKET_SIZEmax(PI
M_MSDP_SA_TLV_MAX_SIZE,PIM_MSDP_KA_TLV_MAX_SIZE)#definePIM_MSDP_PKT_TYPE_STRLEN1
6voidpim_msdp_pkt_ka_tx(structpim_msdp_peer*mp);intpim_msdp_read(structthread*th
read);voidpim_msdp_pkt_sa_tx(structpim_instance*pim);voidpim_msdp_pkt_sa_tx_one(
structpim_msdp_sa*sa);voidpim_msdp_pkt_sa_tx_to_one_peer(structpim_msdp_peer*mp)
;#endif