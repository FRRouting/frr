/**PIMforQuagga*Copyright(C)2008EvertondaSilvaMarques**Thisprogramisfreesoftware
;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublicLicenseasp
ublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(atyouroption
)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful,but*WITHO
UTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESSFORAPARTIC
ULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldhavereceived
acopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYING;ifnot,w
ritetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,MA02110-130
1USA*/#ifndefPIM_OIL_H#definePIM_OIL_H#include"pim_mroute.h"/**Wheredidwegetthis
(S,G)from?**IGMP-LearnedfromIGMP*PIM-LearnedfromPIM*SOURCE-LearnedfromSourcemult
icastpacketreceived*STAR-Inherited*/#definePIM_OIF_FLAG_PROTO_IGMP(1<<0)#defineP
IM_OIF_FLAG_PROTO_PIM(1<<1)#definePIM_OIF_FLAG_PROTO_SOURCE(1<<2)#definePIM_OIF_
FLAG_PROTO_STAR(1<<3)#definePIM_OIF_FLAG_PROTO_ANY\(PIM_OIF_FLAG_PROTO_IGMP|PIM_
OIF_FLAG_PROTO_PIM\|PIM_OIF_FLAG_PROTO_SOURCE|PIM_OIF_FLAG_PROTO_STAR)/**Weneeda
pimregvifidfromthekernel.*Sinceifindex==vifidformostcasesandthenumber*ofexpected
interfacesisatmost100,usingMAXVIFS-1*isprobablyok.*Don'tcomerunningtomeifthisass
umptionisbad,*fixit.*/#definePIM_OIF_PIM_REGISTER_VIF0#definePIM_MAX_USABLE_VIFS
(MAXVIFS-1)structchannel_counts{unsignedlonglonglastused;unsignedlongpktcnt;unsi
gnedlongoldpktcnt;unsignedlongbytecnt;unsignedlongoldbytecnt;unsignedlongwrong_i
f;unsignedlongoldwrong_if;};/*qpim_channel_oil_listholdsalistofstructchannel_oil
.Eachchannel_oil.oilisusedtocontrolan(S,G)entryintheKernelMulticastForwardingCac
he.*/structchannel_oil{structpim_instance*pim;structmfcctloil;intinstalled;intoi
l_inherited_rescan;intoil_size;intoil_ref_count;time_toif_creation[MAXVIFS];uint
32_toif_flags[MAXVIFS];structchannel_countscc;structpim_upstream*up;};externstru
ctlist*pim_channel_oil_list;voidpim_oil_init(structpim_instance*pim);voidpim_oil
_terminate(structpim_instance*pim);voidpim_channel_oil_free(structchannel_oil*c_
oil);structchannel_oil*pim_find_channel_oil(structpim_instance*pim,structprefix_
sg*sg);structchannel_oil*pim_channel_oil_add(structpim_instance*pim,structprefix
_sg*sg,intinput_vif_index);voidpim_channel_oil_del(structchannel_oil*c_oil);intp
im_channel_add_oif(structchannel_oil*c_oil,structinterface*oif,uint32_tproto_mas
k);intpim_channel_del_oif(structchannel_oil*c_oil,structinterface*oif,uint32_tpr
oto_mask);intpim_channel_oil_empty(structchannel_oil*c_oil);char*pim_channel_oil
_dump(structchannel_oil*c_oil,char*buf,size_tsize);#endif/*PIM_OIL_H*/