/**PIMforQuagga*Copyright(C)2017CumulusNetworks,Inc.*ChiragShah**Thisprogramisfr
eesoftware;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublic
Licenseaspublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(at
youroption)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful
,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESS
FORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldha
vereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYI
NG;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,M
A02110-1301USA*/#ifndefPIM_NHT_H#definePIM_NHT_H#include"prefix.h"#include<zebra
.h>#include"zclient.h"#include"vrf.h"#include"pimd.h"#include"pim_rp.h"#include"
pim_rpf.h"/*PIMnexthopcachevaluestructure.*/structpim_nexthop_cache{structpim_rp
frpf;/*IGProute'smetric.*/uint32_tmetric;uint32_tdistance;/*Nexthopnumberandnext
hoplinkedlist.*/uint8_tnexthop_num;structnexthop*nexthop;int64_tlast_update;uint
16_tflags;#definePIM_NEXTHOP_VALID(1<<0)structlist*rp_list;structhash*upstream_h
ash;};intpim_parse_nexthop_update(intcommand,structzclient*zclient,zebra_size_tl
ength,vrf_id_tvrf_id);intpim_find_or_track_nexthop(structpim_instance*pim,struct
prefix*addr,structpim_upstream*up,structrp_info*rp,structpim_nexthop_cache*out_p
nc);voidpim_delete_tracked_nexthop(structpim_instance*pim,structprefix*addr,stru
ctpim_upstream*up,structrp_info*rp);structpim_nexthop_cache*pim_nexthop_cache_fi
nd(structpim_instance*pim,structpim_rpf*rpf);uint32_tpim_compute_ecmp_hash(struc
tprefix*src,structprefix*grp);intpim_ecmp_nexthop_search(structpim_instance*pim,
structpim_nexthop_cache*pnc,structpim_nexthop*nexthop,structprefix*src,structpre
fix*grp,intneighbor_needed);intpim_ecmp_nexthop_lookup(structpim_instance*pim,st
ructpim_nexthop*nexthop,structin_addraddr,structprefix*src,structprefix*grp,intn
eighbor_needed);voidpim_sendmsg_zebra_rnh(structpim_instance*pim,structzclient*z
client,structpim_nexthop_cache*pnc,intcommand);voidpim_resolve_upstream_nh(struc
tpim_instance*pim,structprefix*nht_p);intpim_ecmp_fib_lookup_if_vif_index(struct
pim_instance*pim,structin_addraddr,structprefix*src,structprefix*grp);#endif