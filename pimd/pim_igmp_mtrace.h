/**MulticasttracerouteforFRRouting*Copyright(C)2017MladenSablic**Thisprogramisfr
eesoftware;youcanredistributeitand/ormodify*itunderthetermsoftheGNUGeneralPublic
Licenseaspublishedby*theFreeSoftwareFoundation;eitherversion2oftheLicense,or*(at
youroption)anylaterversion.**Thisprogramisdistributedinthehopethatitwillbeuseful
,but*WITHOUTANYWARRANTY;withouteventheimpliedwarrantyof*MERCHANTABILITYorFITNESS
FORAPARTICULARPURPOSE.SeetheGNU*GeneralPublicLicenseformoredetails.**Youshouldha
vereceivedacopyoftheGNUGeneralPublicLicensealong*withthisprogram;seethefileCOPYI
NG;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt,FifthFloor,Boston,M
A02110-1301USA*/#ifndefPIM_IGMP_MTRACE_H#definePIM_IGMP_MTRACE_H#include<zebra.h
>#include"pim_igmp.h"#defineMTRACE_MAX_HOPS(255)#defineMTRACE_UNKNOWN_COUNT(0xff
ffffff)enummtrace_fwd_code{MTRACE_FWD_CODE_NO_ERROR=0x00,MTRACE_FWD_CODE_WRONG_I
F=0x01,MTRACE_FWD_CODE_PRUNE_SENT=0x02,MTRACE_FWD_CODE_PRUNE_RCVD=0x03,MTRACE_FW
D_CODE_SCOPED=0x04,MTRACE_FWD_CODE_NO_ROUTE=0x05,MTRACE_FWD_CODE_WRONG_LAST_HOP=
0x06,MTRACE_FWD_CODE_NOT_FORWARDING=0x07,MTRACE_FWD_CODE_REACHED_RP=0x08,MTRACE_
FWD_CODE_RPF_IF=0x09,MTRACE_FWD_CODE_NO_MULTICAST=0x0A,MTRACE_FWD_CODE_INFO_HIDD
EN=0x0B,MTRACE_FWD_CODE_NO_SPACE=0x81,MTRACE_FWD_CODE_OLD_ROUTER=0x82,MTRACE_FWD
_CODE_ADMIN_PROHIB=0x83};enummtrace_rtg_proto{MTRACE_RTG_PROTO_DVMRP=1,MTRACE_RT
G_PROTO_MOSPF=2,MTRACE_RTG_PROTO_PIM=3,MTRACE_RTG_PROTO_CBT=4,MTRACE_RTG_PROTO_P
IM_SPECIAL=5,MTRACE_RTG_PROTO_PIM_STATIC=6,MTRACE_RTG_PROTO_DVMRP_STATIC=7,MTRAC
E_RTG_PROTO_PIM_MBGP=8,MTRACE_RTG_PROTO_CBT_SPECIAL=9,MTRACE_RTG_PROTO_CBT_STATI
C=10,MTRACE_RTG_PROTO_PIM_ASSERT=11,};structigmp_mtrace_rsp{uint32_tarrival;stru
ctin_addrincoming;structin_addroutgoing;structin_addrprev_hop;uint32_tin_count;u
int32_tout_count;uint32_ttotal;uint32_trtg_proto:8;uint32_tfwd_ttl:8;/*littleend
ianorderfornextthreefields*/uint32_tsrc_mask:6;uint32_ts:1;uint32_tmbz:1;uint32_
tfwd_code:8;}__attribute__((packed));structigmp_mtrace{uint8_ttype;uint8_thops;u
int16_tchecksum;structin_addrgrp_addr;structin_addrsrc_addr;structin_addrdst_add
r;structin_addrrsp_addr;uint32_trsp_ttl:8;uint32_tqry_id:24;structigmp_mtrace_rs
prsp[0];}__attribute__((packed));#defineMTRACE_HDR_SIZE(sizeof(structigmp_mtrace
))#defineMTRACE_RSP_SIZE(sizeof(structigmp_mtrace_rsp))intigmp_mtrace_recv_qry_r
eq(structigmp_sock*igmp,structip*ip_hdr,structin_addrfrom,constchar*from_str,cha
r*igmp_msg,intigmp_msg_len);intigmp_mtrace_recv_response(structigmp_sock*igmp,st
ructip*ip_hdr,structin_addrfrom,constchar*from_str,char*igmp_msg,intigmp_msg_len
);#endif/*PIM_IGMP_MTRACE_H*/