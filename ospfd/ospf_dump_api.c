/**OSPFddumproutine(partsusedbyospfclient).*Copyright(C)1999,2000ToshiakiTakada*
*ThisfileispartofFRRouting(FRR).**FRRisfreesoftware;youcanredistributeitand/ormo
difyitunderthe*termsoftheGNUGeneralPublicLicenseaspublishedbytheFreeSoftware*Fou
ndation;eitherversion2,or(atyouroption)anylaterversion.**FRRisdistributedintheho
pethatitwillbeuseful,butWITHOUTANY*WARRANTY;withouteventheimpliedwarrantyofMERCH
ANTABILITYorFITNESS*FORAPARTICULARPURPOSE.SeetheGNUGeneralPublicLicenseformore*d
etails.**YoushouldhavereceivedacopyoftheGNUGeneralPublicLicensealong*withthispro
gram;seethefileCOPYING;ifnot,writetotheFreeSoftware*Foundation,Inc.,51FranklinSt
,FifthFloor,Boston,MA02110-1301USA*/#include<zebra.h>#include"log.h"#include"pre
fix.h"#include"ospf_dump_api.h"#include"ospfd.h"#include"ospf_asbr.h"#include"os
pf_lsa.h"#include"ospf_nsm.h"#include"ospf_ism.h"conststructmessageospf_ism_stat
e_msg[]={{ISM_DependUpon,"DependUpon"},{ISM_Down,"Down"},{ISM_Loopback,"Loopback
"},{ISM_Waiting,"Waiting"},{ISM_PointToPoint,"Point-To-Point"},{ISM_DROther,"DRO
ther"},{ISM_Backup,"Backup"},{ISM_DR,"DR"},{0}};conststructmessageospf_nsm_state
_msg[]={{NSM_DependUpon,"DependUpon"},{NSM_Deleted,"Deleted"},{NSM_Down,"Down"},
{NSM_Attempt,"Attempt"},{NSM_Init,"Init"},{NSM_TwoWay,"2-Way"},{NSM_ExStart,"ExS
tart"},{NSM_Exchange,"Exchange"},{NSM_Loading,"Loading"},{NSM_Full,"Full"},{0}};
conststructmessageospf_lsa_type_msg[]={{OSPF_UNKNOWN_LSA,"unknown"},{OSPF_ROUTER
_LSA,"router-LSA"},{OSPF_NETWORK_LSA,"network-LSA"},{OSPF_SUMMARY_LSA,"summary-L
SA"},{OSPF_ASBR_SUMMARY_LSA,"summary-LSA"},{OSPF_AS_EXTERNAL_LSA,"AS-external-LS
A"},{OSPF_GROUP_MEMBER_LSA,"GROUPMEMBERLSA"},{OSPF_AS_NSSA_LSA,"NSSA-LSA"},{8,"T
ype-8LSA"},{OSPF_OPAQUE_LINK_LSA,"Link-LocalOpaque-LSA"},{OSPF_OPAQUE_AREA_LSA,"
Area-LocalOpaque-LSA"},{OSPF_OPAQUE_AS_LSA,"AS-externalOpaque-LSA"},{0}};constst
ructmessageospf_link_state_id_type_msg[]={{OSPF_UNKNOWN_LSA,"(unknown)"},{OSPF_R
OUTER_LSA,""},{OSPF_NETWORK_LSA,"(addressofDesignatedRouter)"},{OSPF_SUMMARY_LSA
,"(summaryNetworkNumber)"},{OSPF_ASBR_SUMMARY_LSA,"(ASBoundaryRouteraddress)"},{
OSPF_AS_EXTERNAL_LSA,"(ExternalNetworkNumber)"},{OSPF_GROUP_MEMBER_LSA,"(Groupme
mbershipinformation)"},{OSPF_AS_NSSA_LSA,"(ExternalNetworkNumberforNSSA)"},{8,"(
Type-8LSID)"},{OSPF_OPAQUE_LINK_LSA,"(Link-LocalOpaque-Type/ID)"},{OSPF_OPAQUE_A
REA_LSA,"(Area-LocalOpaque-Type/ID)"},{OSPF_OPAQUE_AS_LSA,"(AS-externalOpaque-Ty
pe/ID)"},{0}};conststructmessageospf_network_type_msg[]={{OSPF_IFTYPE_NONE,"NONE
"},{OSPF_IFTYPE_POINTOPOINT,"Point-to-Point"},{OSPF_IFTYPE_BROADCAST,"Broadcast"
},{OSPF_IFTYPE_NBMA,"NBMA"},{OSPF_IFTYPE_POINTOMULTIPOINT,"Point-to-MultiPoint"}
,{OSPF_IFTYPE_VIRTUALLINK,"Virtual-Link"},{0}};/*AuType*/conststructmessageospf_
auth_type_str[]={{OSPF_AUTH_NULL,"Null"},{OSPF_AUTH_SIMPLE,"Simple"},{OSPF_AUTH_
CRYPTOGRAPHIC,"Cryptographic"},{0}};#defineOSPF_OPTION_STR_MAXLEN24char*ospf_opt
ions_dump(uint8_toptions){staticcharbuf[OSPF_OPTION_STR_MAXLEN];snprintf(buf,OSP
F_OPTION_STR_MAXLEN,"*|%s|%s|%s|%s|%s|%s|%s",(options&OSPF_OPTION_O)?"O":"-",(op
tions&OSPF_OPTION_DC)?"DC":"-",(options&OSPF_OPTION_EA)?"EA":"-",(options&OSPF_O
PTION_NP)?"N/P":"-",(options&OSPF_OPTION_MC)?"MC":"-",(options&OSPF_OPTION_E)?"E
":"-",(options&OSPF_OPTION_MT)?"M/T":"-");returnbuf;}voidospf_lsa_header_dump(st
ructlsa_header*lsah){constchar*lsah_type=lookup_msg(ospf_lsa_type_msg,lsah->type
,NULL);zlog_debug("LSAHeader");zlog_debug("LSage%d",ntohs(lsah->ls_age));zlog_de
bug("Options%d(%s)",lsah->options,ospf_options_dump(lsah->options));zlog_debug("
LStype%d(%s)",lsah->type,(lsah->type?lsah_type:"unknowntype"));zlog_debug("LinkS
tateID%s",inet_ntoa(lsah->id));zlog_debug("AdvertisingRouter%s",inet_ntoa(lsah->
adv_router));zlog_debug("LSsequencenumber0x%lx",(unsignedlong)ntohl(lsah->ls_seq
num));zlog_debug("LSchecksum0x%x",ntohs(lsah->checksum));zlog_debug("length%d",n
tohs(lsah->length));}